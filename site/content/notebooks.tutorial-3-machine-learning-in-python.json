{"version":3,"kind":"Notebook","sha256":"39cba3599b49be20bf576817bd1a2c266c8813a835aa6b993dc4d4d761e0096d","slug":"notebooks.tutorial-3-machine-learning-in-python","location":"/notebooks/Tutorial 3 - Machine Learning in Python.ipynb","dependencies":[],"frontmatter":{"title":"Machine Learning in Python","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"github":"https://github.com/ml-course/master","copyright":"2025. CC0 Licensed - Use as you like. Appropriate credit is very welcome","numbering":{"title":{"offset":1}},"source_url":"https://github.com/ml-course/master/blob/master/notebooks/Tutorial 3 - Machine Learning in Python.ipynb","edit_url":"https://github.com/ml-course/master/edit/master/notebooks/Tutorial 3 - Machine Learning in Python.ipynb","thumbnail":"/994d7ace0cc932129ca32d245a55a8fc.jpeg","thumbnailOptimized":"/994d7ace0cc932129ca32d245a55a8fc.webp","exports":[{"format":"ipynb","filename":"Tutorial 3 - Machine Learning in Python.ipynb","url":"/Tutorial 3 - Machine-6cd1e9ec3948078ff2c9a27e48d4b18c.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"hide_input":false,"slideshow":{"slide_type":"skip"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# General imports\n%matplotlib inline\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt","key":"YeykNsnA3d"},{"type":"outputs","id":"WuISLqjW2eb4leJzRqXb2","children":[],"key":"oclIeyUCje"}],"key":"qC5YRAfGYs"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Machine Learning in Python","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iwPp8Edf80"}],"identifier":"machine-learning-in-python","label":"Machine Learning in Python","html_id":"machine-learning-in-python","implicit":true,"key":"OWmFZtNjvH"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Joaquin Vanschoren, Eindhoven University of Technology","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ZBps6p5AfC"}],"key":"G2X4ckd8Lv"}],"key":"auMmQuphXr"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Why Python?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aUgzTND0a2"}],"identifier":"why-python","label":"Why Python?","html_id":"why-python","implicit":true,"key":"RDJHe71foG"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Many data-heavy applications are now developed in Python","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"aYnF8ikDn6"}],"key":"XMkzcbUbZC"}],"key":"bzU3J6jPMT"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Highly readable, less complexity, fast prototyping","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"f0tUYQ1u3l"}],"key":"xdD7j4Xdxn"}],"key":"w10ApgdBDn"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Easy to offload number crunching to underlying C/Fortran/...","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"QnPjsr437y"}],"key":"L1tlmkk7zF"}],"key":"E7Edsl2j9B"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Easy to install and import many rich libraries","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"pJEEMVGiZm"}],"key":"fEmC4Kyhca"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"numpy: efficient data structures","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"glcMLEDgmA"}],"key":"HEfnknuzyh"}],"key":"kOlKVEAKha"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"scipy: fast numerical recipes","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"tmbbUDKR0v"}],"key":"wt06AMSnng"}],"key":"NMa6C6iiqb"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"matplotlib: high-quality graphs","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"AkIrPNEYY6"}],"key":"MUO470TQa7"}],"key":"voQ7hSWx93"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"scikit-learn: machine learning algorithms","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"MIBIzMDwfo"}],"key":"wKEiLCIwvU"}],"key":"Qui1OCC1eW"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"tensorflow: neural networks","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"OPXEtYkDtU"}],"key":"I1khPn1XWu"}],"key":"j7pwag90RM"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"...","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"KlPu5GAyCi"}],"key":"pGX0QB26CE"}],"key":"BkaJLU7Gg9"}],"key":"RbRzWvBpgj"}],"key":"mr29b7fgss"}],"key":"zLwis8SPTe"}],"key":"p3xkooj0FL"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"image","style":{"width":"1000px"},"url":"/994d7ace0cc932129ca32d245a55a8fc.jpeg","alt":"ml","key":"pZ04bXzD5W","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/tut_ecosystem.jpg","urlOptimized":"/994d7ace0cc932129ca32d245a55a8fc.webp"}],"key":"l5QzgOcmcD"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Numpy, Scipy, Matplotlib","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WYicGUkxug"}],"identifier":"numpy-scipy-matplotlib","label":"Numpy, Scipy, Matplotlib","html_id":"numpy-scipy-matplotlib","implicit":true,"key":"p1JtRoQceE"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We’ll illustrate these with a practical example","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"gtfiyI1dxZ"}],"key":"ixwPmIDdP1"}],"key":"l3PuzBVDna"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Many good tutorials online","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lYZKahzN4F"}],"key":"ZFHqpWfDui"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://github.com/jakevdp/PythonDataScienceHandbook","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Jake VanderPlas’ book and notebooks","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"CmtI3GsEaq"}],"urlSource":"https://github.com/jakevdp/PythonDataScienceHandbook","error":true,"key":"VyjtD1H1Ve"}],"key":"giGnWJtoEP"}],"key":"VmEJcx6ON5"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://github.com/jrjohansson/scientific-python-lectures","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"J.R. Johansson’s notebooks","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"iOUshcXpLV"}],"urlSource":"https://github.com/jrjohansson/scientific-python-lectures","error":true,"key":"j4HWXuN7i4"}],"key":"YOhKkcHtaW"}],"key":"ajTdtECNqN"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://www.datacamp.com","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"DataCamp","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"MCn6PxP4CZ"}],"urlSource":"https://www.datacamp.com","key":"Hxaotnf7us"}],"key":"TBCjobkkuf"}],"key":"wGZNuusHIQ"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"...","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"xCb2tQFRHq"}],"key":"ghBlATogSl"}],"key":"TSjQDM0O5G"}],"key":"MX1BEAuHew"}],"key":"E8zFOHhf7B"}],"key":"PxGZYHdn3x"}],"key":"abyQB6VoZP"},{"type":"block","kind":"notebook-code","data":{"slideshow":{"slide_type":"skip"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.stats import gamma\nnp.random.seed(3)  # to reproduce the data\n\ndef gen_web_traffic_data():\n    '''\n    This function generates some fake data that first shows a weekly pattern \n    for a couple weeks before it grows exponentially.\n    '''\n    # 31 days, 24 hours\n    x = np.arange(1, 31*24)\n    \n    # Sine wave with weekly rhythm + noise + exponential increase\n    y = np.array(200*(np.sin(2*np.pi*x/(7*24))), dtype=np.float32)\n    y += gamma.rvs(15, loc=0, scale=100, size=len(x))\n    y += 2 * np.exp(x/100.0)\n    y = np.ma.array(y, mask=[y<0])\n\n    return x, y\n\ndef plot_web_traffic(x, y, models=None, mx=None, ymax=None):\n    '''\n    Plot the web traffic (y) over time (x). \n    \n    If models is given, it is expected to be a list fitted models,\n    which will be plotted as well (used later).\n    '''\n    plt.figure(figsize=(12,6), dpi=300) # width and height of the plot in inches\n    plt.scatter(x, y, s=10)\n    plt.xlabel(\"Time\")\n    plt.ylabel(\"Hits/hour\")\n    plt.xticks([w*7*24 for w in range(20)], \n               ['week %i' %w for w in range(20)])\n    \n    if models: \n        colors = ['g', 'r', 'm', 'b', 'k']\n        linestyles = ['-', '-.', '--', ':', '-']\n\n        if mx is None:\n            mx = np.linspace(0, x[-1], 1000)\n        for model, style, color in zip(models, linestyles, colors):\n            plt.plot(mx, model(mx), linestyle=style, linewidth=2, c=color)\n\n        plt.legend([\"d=%i\" % m.order for m in models], loc=\"upper left\")\n        \n    plt.autoscale()\n    if ymax:\n        plt.ylim(ymax=ymax)\n\n    plt.grid()\n    plt.ylim(ymin=0)","key":"JGoLjexo1o"},{"type":"outputs","id":"nkk8UIFbnwUcsRomEZY5y","children":[],"key":"ZiGYe68wMI"}],"key":"bSqr0H10UY"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example: Modelling web traffic","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"K5oHQV8hEM"}],"identifier":"example-modelling-web-traffic","label":"Example: Modelling web traffic","html_id":"example-modelling-web-traffic","implicit":true,"key":"tpqEerq8B4"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We generate some artificial data to mimic web traffic data","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"VecOnKkD1d"}],"key":"hchgyDvMBc"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"E.g. website visits, tweets with certain hashtag,...","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FtyPjr7UUu"}],"key":"hX5rVjABjy"}],"key":"fy2E8gmQgF"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Weekly rhythm + noise + exponential increase","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"FHZTQPxohA"}],"key":"jlauuxUe4v"}],"key":"UuWuQgvXH4"}],"key":"lXB3bCRU7L"}],"key":"GEXtLfO5pY"}],"key":"T8Zl0Ejomp"}],"key":"Z859o9y322"},{"type":"block","kind":"notebook-code","data":{"hide_input":true},"children":[{"type":"code","lang":"python","executable":true,"value":"x, y = gen_web_traffic_data()\nplot_web_traffic(x, y)","key":"kdZPjkuP66"},{"type":"outputs","id":"mm1UijNj_taKwSMPomsJ4","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{"needs_background":"light"},"data":{"image/png":{"content_type":"image/png","hash":"0861c924d7e2ececa8c3182eec7a3054","path":"/0861c924d7e2ececa8c3182eec7a3054.png"},"text/plain":{"content":"<Figure size 3600x1800 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"vcrGkypS80"}],"key":"fRqbvsmhZm"}],"key":"EW1R41FFZ7"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Use numpy to fit some polynomial lines","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qr7SBwh5Er"}],"identifier":"use-numpy-to-fit-some-polynomial-lines","label":"Use numpy to fit some polynomial lines","html_id":"use-numpy-to-fit-some-polynomial-lines","implicit":true,"key":"eFx9TrVfBy"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"polyfit","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"yOLixBDCJ0"},{"type":"text","value":" fits a polynomial of degree d","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"nwA3HqxV3b"}],"key":"MTeOhXsJrq"}],"key":"RZZIDAgLHn"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"poly1d","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XesvMY3Rho"},{"type":"text","value":" evaluates the function using the learned coefficients","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cdrMQNsEe9"}],"key":"Oo0fDzealt"}],"key":"ZNCY3kbvbP"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Plot with matplotlib","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"PsEC56UdaI"}],"key":"MmsbwaXdFl"}],"key":"VNRTB9e9bE"}],"key":"KQppiJYf3x"},{"type":"code","lang":"python","value":"f2 = np.poly1d(np.polyfit(x, y, 2))\nf10 = np.poly1d(np.polyfit(x, y, 10))\nf50 = np.poly1d(np.polyfit(x, y, 50))\n\nmx = np.linspace(0, x[-1], 1000)\nplt.plot(mx, f2(mx))","position":{"start":{"line":6,"column":1},"end":{"line":13,"column":1}},"key":"fc3Uh0wTi6"}],"key":"gQcCdVEdSs"},{"type":"block","kind":"notebook-code","data":{"hide_input":true,"slideshow":{"slide_type":"subslide"}},"children":[{"type":"code","lang":"python","executable":true,"value":"f2 = np.poly1d(np.polyfit(x, y, 2))\nf10 = np.poly1d(np.polyfit(x, y, 10))\nf50 = np.poly1d(np.polyfit(x, y, 50))\nplot_web_traffic(x, y, [f2,f10,f50])","key":"aLC24MS9s1"},{"type":"outputs","id":"RCf6AI3YlG5-aGG4ttzWO","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/Users/jvanscho/miniforge3/lib/python3.9/site-packages/IPython/core/interactiveshell.py:3457: RankWarning: Polyfit may be poorly conditioned\n  exec(code_obj, self.user_global_ns, self.user_ns)\n"},"children":[],"key":"uf7eNhyv2f"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{"needs_background":"light"},"data":{"image/png":{"content_type":"image/png","hash":"c14f505b6e16c143efb15d1c21fecf1c","path":"/c14f505b6e16c143efb15d1c21fecf1c.png"},"text/plain":{"content":"<Figure size 3600x1800 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"ShQ5UNVlTR"}],"key":"zjM33TwiHm"}],"key":"dAUe9HXNf2"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Evaluate","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FCk2hmb5KR"}],"identifier":"evaluate","label":"Evaluate","html_id":"evaluate","implicit":true,"key":"HC0iafANkd"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Using root mean squared error: ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"y5n8yDMAwi"},{"type":"inlineMath","value":"\\sqrt{\\sum_i (f(x_i) - y_i)^2}","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msqrt><mrow><msub><mo>∑</mo><mi>i</mi></msub><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding=\"application/x-tex\">\\sqrt{\\sum_i (f(x_i) - y_i)^2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.24em;vertical-align:-0.3299em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9101em;\"><span class=\"svg-align\" style=\"top:-3.2em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-2.8701em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:1.28em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\nc340,-704.7,510.7,-1060.3,512,-1067\nl0 -0\nc4.7,-7.3,11,-11,19,-11\nH40000v40H1012.3\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\nM1001 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3299em;\"><span></span></span></span></span></span></span></span></span>","key":"ZRD4iChxXN"}],"key":"qcosy0v6M8"}],"key":"SBjxSJaGiy"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The degree of the polynomial needs to be tuned to the data","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Rf6YxP2JKe"}],"key":"t97K1OW4Of"}],"key":"cZV05tezLY"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Predictions don’t look great. We need more sophisticated methods.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"uwevV2oosB"}],"key":"W7oDDEEaV4"}],"key":"LnMwBtKGJm"}],"key":"C7DDgy3KnT"}],"key":"mv1DcYC7Sv"},{"type":"block","kind":"notebook-code","data":{"hide_input":true},"children":[{"type":"code","lang":"python","executable":true,"value":"import ipywidgets as widgets\nfrom ipywidgets import interact, interact_manual\n\nmx=np.linspace(0, 6 * 7 * 24, 100)\n\ndef error(f, x, y):\n    return np.sqrt(np.sum((f(x)-y)**2))\n\n@interact\ndef play_with_degree(degree=(1,30,2)):\n    f = np.poly1d(np.polyfit(x, y, degree))\n    plot_web_traffic(x, y, [f], mx=mx, ymax=10000)\n    print(\"Training error for d=%i: %f\" % (f.order, error(f, x, y)))","key":"stEkcCrqXQ"},{"type":"outputs","id":"M1UEUV_K-hBcFo0FrUUvs","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"application/vnd.jupyter.widget-view+json":{"content":"{\"model_id\":\"d670fff938d0438bb06b3fa07661bdf2\",\"version_major\":2,\"version_minor\":0}","content_type":"application/vnd.jupyter.widget-view+json"},"text/plain":{"content":"interactive(children=(IntSlider(value=15, description='degree', max=30, min=1, step=2), Output()), _dom_classe…","content_type":"text/plain"}}},"children":[],"key":"d51Kha5UEk"}],"key":"w3dj79i7xp"}],"key":"C0jTgvo9hD"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"scikit-learn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kWbF3j1djl"}],"identifier":"scikit-learn","label":"scikit-learn","html_id":"scikit-learn","implicit":true,"key":"LsAkdRjv6D"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"One of the most prominent Python libraries for machine learning:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ZCUyMh6pFk"}],"key":"mTFborRQPs"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Contains many state-of-the-art machine learning algorithms","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"x46SKKzyIr"}],"key":"DbGYqzz5e5"}],"key":"RO8N9bJ4QD"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Builds on numpy (fast), implements advanced techniques","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"MyH0pFSw3B"}],"key":"uY20rvzJ9k"}],"key":"U9jGu4pRVE"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Wide range of evaluation measures and techniques","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"M6qVgA4fgL"}],"key":"GskgpI2YHg"}],"key":"S1iH5s7jbM"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Offers ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"YArro68jsp"},{"type":"link","url":"http://scikit-learn.org/stable/documentation","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"comprehensive documentation","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"i7xAzTOCxB"}],"urlSource":"http://scikit-learn.org/stable/documentation","key":"N4jLqFJnOW"},{"type":"text","value":" about each algorithm","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"bFB6EDvXPE"}],"key":"dD6YEq31Ji"}],"key":"VBMkwYqYlR"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Widely used, and a wealth of ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Wi9pkuMmLw"},{"type":"link","url":"http://scikit-learn.org/stable/user_guide.html","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"tutorials","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"HpxmtsUtP1"}],"urlSource":"http://scikit-learn.org/stable/user_guide.html","key":"dPBtWLrWKN"},{"type":"text","value":" and code snippets are available","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"RwirBu5al3"}],"key":"K00nfWHuan"}],"key":"e3nDtjmwND"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Works well with numpy, scipy, pandas, matplotlib,...","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"WOGmjpszFu"}],"key":"GWvveppS7U"}],"key":"Y1HtlKrwVa"}],"key":"LGFDu03ZD2"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Note","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"CVZtW0bWe8"}],"key":"ZZkVWiGkcb"},{"type":"text","value":": We’ll repeat most of the material below in the lectures and labs on model selection and data preprocessing, but it’s still very useful to study it beforehand.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"KURHCOb9pT"}],"key":"MpiRFyMQId"}],"key":"L66cZqO0x3"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Algorithms","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dHYqLJ7NaH"}],"identifier":"algorithms","label":"Algorithms","html_id":"algorithms","implicit":true,"key":"N43Sl5HsDt"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"See the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"KoejeHXXIp"},{"type":"link","url":"http://scikit-learn.org/dev/modules/classes.html","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Reference","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"BfQxCHXkPm"}],"urlSource":"http://scikit-learn.org/dev/modules/classes.html","key":"OMaK5QlbLZ"}],"key":"NVVWkAa7ok"}],"key":"A2ovtI08ji"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"fragment"}},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Supervised learning:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DsS7tcyCYz"}],"key":"Wk7noyiDgo"}],"key":"OR2Bd7LGrR"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Linear models (Ridge, Lasso, Elastic Net, ...)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZIGVkkprAN"}],"key":"CeHgoNkAP4"}],"key":"hQg5TTCuYv"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Support Vector Machines","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"PhhjVVvBJ6"}],"key":"rdN5okK4bI"}],"key":"SJCBA8wr6g"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Tree-based methods (Classification/Regression Trees, Random Forests,...)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"IfOu1cyjbG"}],"key":"y43MG5XiDQ"}],"key":"MgwAR0GrMA"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Nearest neighbors","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"mMKTxat5Gc"}],"key":"R56k6wsEgb"}],"key":"XJ7l8Poq86"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Neural networks","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"f6LfapAKtu"}],"key":"dvYeconXtY"}],"key":"dSuV0FiOGT"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Gaussian Processes","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"CGB1qwGVXe"}],"key":"GWbfFvMw75"}],"key":"Xos1b9z9au"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Feature selection","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"nkMfnnuOo3"}],"key":"Lo2KNOj1Pm"}],"key":"TVOLxWzk14"}],"key":"rXHZbRm7m7"}],"key":"XTUJpp3suL"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Unsupervised learning:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CMYgf5qwf5"}],"key":"iHy0hQJqfO"}],"key":"bdFtXbz3i4"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Clustering (KMeans, ...)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EnzhzEPAey"}],"key":"tAaCDe7cSx"}],"key":"UHBtbcKh5d"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Matrix Decomposition (PCA, ...)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"xlAF21QFCq"}],"key":"cvXNNcXrQ9"}],"key":"KoFpLtxpUf"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Manifold Learning (Embeddings)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ZGQ35vgwmx"}],"key":"eBoGqVPwLH"}],"key":"kH17ewWwkg"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Density estimation","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"EzxurmUS3s"}],"key":"fO3SXAh524"}],"key":"MKXOa34vxD"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Outlier detection","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"jTsOy8h2xk"}],"key":"smsauYr3tW"}],"key":"NeiiVRc1VH"}],"key":"Lco8chKuvT"}],"key":"Nv6lzHXefo"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"fragment"}},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Model selection and evaluation:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wDuUIsl5Kc"}],"key":"YnoxekKVcW"}],"key":"xPtLQNX3Fg"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Cross-validation","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QHF1QbUHsN"}],"key":"Vu2mLqvyq2"}],"key":"agFnvztG94"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Grid-search","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"NlssFXKHld"}],"key":"LWksoRZI8e"}],"key":"NRtb8uOjqW"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Lots of metrics","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mv7od9YK5l"}],"key":"JUHDWyJx95"}],"key":"bOWhEecwSe"}],"key":"EqCkBdn8Rv"}],"key":"ftQUQvUL0c"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Data import","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NDZJu5aMnR"}],"identifier":"data-import","label":"Data import","html_id":"data-import","implicit":true,"key":"ZrvrgR7kCc"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Multiple options:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"W5omiFAJcl"}],"key":"kAHlldqMRV"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"A few toy datasets are included in ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"RwSoBHhiuD"},{"type":"inlineCode","value":"sklearn.datasets","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Hgzvzcy8i0"}],"key":"QO37RMRN9Q"}],"key":"PFdNwE9fHb"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Import 1000s of datasets via ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"QgacAqbM9A"},{"type":"inlineCode","value":"sklearn.datasets.fetch_openml","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ULBRDTt3dY"}],"key":"Xfwaja7WZl"}],"key":"zr4hgKAlrI"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"You can import data files (CSV) with ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"dRQaO1JqpY"},{"type":"inlineCode","value":"pandas","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"LxkcL5xtHT"},{"type":"text","value":" or ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"PZB69zgOUL"},{"type":"inlineCode","value":"numpy","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"h6oSkHtw57"}],"key":"kFtIWtMDvB"}],"key":"Kx9DBTvYQ1"}],"key":"a0RmtATj9Q"},{"type":"code","lang":"python","value":"from sklearn.datasets import load_iris, fetch_openml\niris_data = load_iris()\ndating_data = fetch_openml(name=\"SpeedDating\")","position":{"start":{"line":8,"column":1},"end":{"line":12,"column":1}},"key":"Qcn12DpyNq"}],"key":"Oc1SDzxebO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from sklearn.datasets import load_iris, fetch_openml\niris_data = load_iris()\ndating_data = fetch_openml(\"SpeedDating\", version=1)","key":"sDXFpTpMpf"},{"type":"outputs","id":"gwd16hCz5WeGrjWAf9Erb","children":[],"key":"WdhzKdC9k2"}],"key":"tzpEXPUO55"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"These will return a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gFrxqSLxTA"},{"type":"inlineCode","value":"Bunch","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jHhndp0EAi"},{"type":"text","value":" object (similar to a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DevTC2ee76"},{"type":"inlineCode","value":"dict","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Z8wfGKQqtC"},{"type":"text","value":")","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gawWN19bSm"}],"key":"JWGbTJLvzX"},{"type":"code","lang":"python","value":"print(\"Keys of iris_dataset: {}\".format(iris_dataset.keys()))\nprint(iris_dataset['DESCR'][:193] + \"\\n...\")","position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"key":"ukEESTbW1Q"}],"key":"Be48TB4V3w"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(\"Keys of iris_dataset: {}\".format(iris_data.keys()))\nprint(iris_data['DESCR'][:193] + \"\\n...\")","key":"siFN7DTOKC"},{"type":"outputs","id":"zsNhl1aosJw-2EgHdK5c5","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Keys of iris_dataset: dict_keys(['data', 'target', 'frame', 'target_names', 'DESCR', 'feature_names', 'filename', 'data_module'])\n.. _iris_dataset:\n\nIris plants dataset\n--------------------\n\n**Data Set Characteristics:**\n\n    :Number of Instances: 150 (50 in each of three classes)\n    :Number of Attributes: 4 numeric, pre\n...\n"},"children":[],"key":"CPjuGQe3uf"}],"key":"eXpOhHrXRH"}],"key":"cWzn4pBnIJ"},{"type":"block","kind":"notebook-content","children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Targets (classes) and features are lists of strings","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"STgHBG7U8e"}],"key":"IwIB9NGN67"}],"key":"KSExXNjR4f"},{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Data and target values are always numeric (ndarrays)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"EuJ1ZJgayK"}],"key":"FfCnUHCA34"}],"key":"Y0K7jCVuoy"}],"key":"GxQH6vUZLK"},{"type":"code","lang":"python","value":"print(\"Targets: {}\".format(iris_data['target_names']))\nprint(\"Features: {}\".format(iris_data['feature_names']))\nprint(\"Shape of data: {}\".format(iris_data['data'].shape))\nprint(\"First 5 rows:\\n{}\".format(iris_data['data'][:5]))\nprint(\"Targets:\\n{}\".format(iris_data['target']))","position":{"start":{"line":4,"column":1},"end":{"line":10,"column":1}},"key":"OKYz5bNu0n"}],"key":"LfLeltGuJe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(\"Targets: {}\".format(iris_data['target_names']))\nprint(\"Features: {}\".format(iris_data['feature_names']))\nprint(\"Shape of data: {}\".format(iris_data['data'].shape))\nprint(\"First 5 rows:\\n{}\".format(iris_data['data'][:5]))\nprint(\"Targets:\\n{}\".format(iris_data['target']))","key":"Jr8lxnE8v5"},{"type":"outputs","id":"2iWDS3mL1uSnJZ53X6jyz","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Targets: ['setosa' 'versicolor' 'virginica']\nFeatures: ['sepal length (cm)', 'sepal width (cm)', 'petal length (cm)', 'petal width (cm)']\nShape of data: (150, 4)\nFirst 5 rows:\n[[5.1 3.5 1.4 0.2]\n [4.9 3.  1.4 0.2]\n [4.7 3.2 1.3 0.2]\n [4.6 3.1 1.5 0.2]\n [5.  3.6 1.4 0.2]]\nTargets:\n[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2\n 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n 2 2]\n"},"children":[],"key":"SDTgZgaQOS"}],"key":"KACfTxbi5p"}],"key":"FKffwyXHct"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Building models","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PIwo2lIHFj"}],"identifier":"building-models","label":"Building models","html_id":"building-models","implicit":true,"key":"eSHAFycL6U"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"All scikitlearn ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"SraQd4gB2D"},{"type":"emphasis","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"estimators","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"SrPqcyavHD"}],"key":"KY57UTHrUW"},{"type":"text","value":" follow the same interface","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Xd3zkKAD3L"}],"key":"Ftz2K77bf7"}],"key":"NX1USU6mPv"},{"type":"block","kind":"notebook-content","children":[{"type":"code","lang":"python","value":"class SupervisedEstimator(...):\n    def __init__(self, hyperparam, ...):\n\n    def fit(self, X, y):   # Fit/model the training data\n        ...                # given data X and targets y\n        return self\n     \n    def predict(self, X):  # Make predictions\n        ...                # on unseen data X  \n        return y_pred\n    \n    def score(self, X, y): # Predict and compare to true\n        ...                # labels y                \n        return score","position":{"start":{"line":1,"column":1},"end":{"line":16,"column":1}},"key":"ySC9XjE3iX"}],"key":"uhWtaIxuRc"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Training and testing data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KXq9PFGUUB"}],"identifier":"training-and-testing-data","label":"Training and testing data","html_id":"training-and-testing-data","implicit":true,"key":"gu7Mnk4p7q"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"To evaluate our classifier, we need to test it on unseen data.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"TEj9k73PIe"},{"type":"break","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"GwzHCCnJLE"},{"type":"inlineCode","value":"train_test_split","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"mmAECFvhiL"},{"type":"text","value":": splits data randomly in 75% training and 25% test data.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"m2LCb81q6u"}],"key":"kVVyLYvhM7"},{"type":"code","lang":"python","value":"X_train, X_test, y_train, y_test = train_test_split(\n    iris_data['data'], iris_data['target'], random_state=0)","position":{"start":{"line":5,"column":1},"end":{"line":8,"column":1}},"key":"dpnesQtui6"}],"key":"bVa7Q9jgiD"},{"type":"block","kind":"notebook-code","data":{"hide_input":false},"children":[{"type":"code","lang":"python","executable":true,"value":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(\n    iris_data['data'], iris_data['target'], \n    random_state=0)\nprint(\"X_train shape: {}\".format(X_train.shape))\nprint(\"y_train shape: {}\".format(y_train.shape))\nprint(\"X_test shape: {}\".format(X_test.shape))\nprint(\"y_test shape: {}\".format(y_test.shape))","key":"WgYBJXCVMA"},{"type":"outputs","id":"dv19cocrkLhuDh2ClxgiC","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"X_train shape: (112, 4)\ny_train shape: (112,)\nX_test shape: (38, 4)\ny_test shape: (38,)\n"},"children":[],"key":"xTrHuBtzDI"}],"key":"UdLwlQdkz5"}],"key":"mgUe2lwrxU"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Fitting a model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xzUldPDyjN"}],"identifier":"fitting-a-model","label":"Fitting a model","html_id":"fitting-a-model","implicit":true,"key":"yMrWjSll1g"}],"key":"r7bKlk2Eik"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"The first model we’ll build is a k-Nearest Neighbor classifier.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"szUuqLpuER"},{"type":"break","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T5XFgYS1Ss"},{"type":"text","value":"kNN is included in ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EGUzOA7wJ0"},{"type":"inlineCode","value":"sklearn.neighbors","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oU08qIstf0"},{"type":"text","value":", so let’s build our first model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MeB54zkgFw"}],"key":"UwF6ixKcMS"},{"type":"code","lang":"python","value":"knn = KNeighborsClassifier(n_neighbors=1)\nknn.fit(X_train, y_train)","position":{"start":{"line":4,"column":1},"end":{"line":7,"column":1}},"key":"VC0FUrqdJo"}],"key":"V310wIShLw"},{"type":"block","kind":"notebook-code","data":{"hide_input":false},"children":[{"type":"code","lang":"python","executable":true,"value":"from sklearn.neighbors import KNeighborsClassifier\nknn = KNeighborsClassifier(n_neighbors=1)\nknn.fit(X_train, y_train)","key":"jkkVkzoXlX"},{"type":"outputs","id":"PwiTqZq32HSsNEKDv7j0X","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"KNeighborsClassifier(n_neighbors=1)","content_type":"text/plain"}}},"children":[],"key":"u5k10gnkr4"}],"key":"MaZlx1hu5K"}],"key":"qkrMiqHzwc"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Making predictions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mZf6VuHLYY"}],"identifier":"making-predictions","label":"Making predictions","html_id":"making-predictions","implicit":true,"key":"F7xsYXb5eq"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Let’s create a new example and ask the kNN model to classify it","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Quzm55Wbuf"}],"key":"mHZoP0tWTI"},{"type":"code","lang":"python","value":"X_new = np.array([[5, 2.9, 1, 0.2]])\nprediction = knn.predict(X_new)\nclass_name = iris_data['target_names'][prediction]","position":{"start":{"line":4,"column":1},"end":{"line":8,"column":1}},"key":"HzjjY5SXzr"}],"key":"Cf3jvNl2gC"},{"type":"block","kind":"notebook-code","data":{"hide_input":false},"children":[{"type":"code","lang":"python","executable":true,"value":"X_new = np.array([[5, 2.9, 1, 0.2]])\nprediction = knn.predict(X_new)\nprint(\"Prediction: {}\".format(prediction))\nprint(\"Predicted target name: {}\".format(\n       iris_data['target_names'][prediction]))","key":"yOpZ3hBmnC"},{"type":"outputs","id":"ClEQiSgf3n5gyzym_5lUK","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Prediction: [0]\nPredicted target name: ['setosa']\n"},"children":[],"key":"zxFWi5BVzB"}],"key":"t2tRSwz1cW"}],"key":"ftB7XyT5TS"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Evaluating the model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TP7rrnkn8F"}],"identifier":"evaluating-the-model","label":"Evaluating the model","html_id":"evaluating-the-model","implicit":true,"key":"Gq0vguWn6h"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Feeding all test examples to the model yields all predictions","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"jT6fqmJjBi"}],"key":"lvlaQ5K4eP"},{"type":"code","lang":"python","value":"y_pred = knn.predict(X_test)","position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"key":"PjYmRmtpyl"}],"key":"zAfbGNMCqa"},{"type":"block","kind":"notebook-code","data":{"hide_input":true,"scrolled":true},"children":[{"type":"code","lang":"python","executable":true,"value":"y_pred = knn.predict(X_test)\nprint(\"Test set predictions:\\n {}\".format(y_pred))","key":"jcsC7Hrb14"},{"type":"outputs","id":"TDcFCVlqoNL-dAKx_nLUb","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Test set predictions:\n [2 1 0 2 0 2 0 1 1 1 2 1 1 1 1 0 1 1 0 0 2 1 0 0 2 0 0 1 1 0 2 1 0 2 2 1 0\n 2]\n"},"children":[],"key":"RRviq97cw0"}],"key":"NtvvGlj4p4"}],"key":"qBrFeFKMgc"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Navu7Y4cPk"},{"type":"inlineCode","value":"score","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wtrCh6kglp"},{"type":"text","value":" function computes the percentage of correct predictions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"se7BMmU3hx"}],"key":"bJHH5MrgSq"},{"type":"code","lang":"python","value":"knn.score(X_test, y_test)","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"key":"d4RjbPxzLP"}],"key":"QfrdzM2PvR"},{"type":"block","kind":"notebook-code","data":{"hide_input":true},"children":[{"type":"code","lang":"python","executable":true,"value":"print(\"Score: {:.2f}\".format(knn.score(X_test, y_test) ))","key":"bBzJ4xmDEM"},{"type":"outputs","id":"y9Q1nOZ949saQaxiV6OHs","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Score: 0.97\n"},"children":[],"key":"o0WcnfLvXF"}],"key":"u1BfWRBJTO"}],"key":"PoVFyDK2fM"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Cross-validation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PVb1xOAChY"}],"identifier":"cross-validation","label":"Cross-validation","html_id":"cross-validation","implicit":true,"key":"lwJg3C6fur"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"More stable, thorough way to estimate generalization performance","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zEMvEtqc6U"}],"key":"LUhjwd653n"}],"key":"Un7kbFwlhJ"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"emphasis","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"k-fold cross-validation","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"XQD351HrNB"}],"key":"wyeSVEgyL7"},{"type":"text","value":" (CV): split (randomized) data into ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"EKWt8RTuFv"},{"type":"emphasis","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"k","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"gVYDX4EUwn"}],"key":"j5oeqh0Qut"},{"type":"text","value":" equal-sized parts, called ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"q3g2ZZudXi"},{"type":"emphasis","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"folds","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"iTZ3Y3X7PJ"}],"key":"bBOOvVFfeN"}],"key":"fV7ncl5web"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"First, fold 1 is the test set, and folds 2-5 comprise the training set","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"gSzrDhVoic"}],"key":"HMy5t0qnOz"}],"key":"e2LLdhbi94"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Then, fold 2 is the test set, folds 1,3,4,5 comprise the training set","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"gwqSjD4sCb"}],"key":"L9XQD1eHwI"}],"key":"Ri95Ngodf0"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Compute ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"k5c0CKRi60"},{"type":"emphasis","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"k","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ggV3q1GjV0"}],"key":"hof7zgBcLg"},{"type":"text","value":" evaluation scores, aggregate afterwards (e.g. take the mean)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"naoRpn5iud"}],"key":"pRaLshiHFR"}],"key":"zOzj9Wtxcy"}],"key":"fHW8fzEY4i"}],"key":"wHnbG1G4On"}],"key":"pzk59wxYIG"}],"key":"e6UJtDdwKD"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Cross-validation in scikit-learn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xataZQb0cs"}],"identifier":"cross-validation-in-scikit-learn","label":"Cross-validation in scikit-learn","html_id":"cross-validation-in-scikit-learn","implicit":true,"key":"nZVw9a5wJV"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"cross_val_score","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"t7xFzPXNEW"},{"type":"text","value":" function with learner, training data, labels","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NeeRh75lca"}],"key":"y4eCiqN9b6"}],"key":"N8h8l1vKdz"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Returns list of all scores","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"AkmBNnC443"}],"key":"IIQhPEQWId"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Does 3-fold CV by default, can be changed via ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ef8m23CV3n"},{"type":"inlineCode","value":"cv","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mKF5UlB2Ab"},{"type":"text","value":" hyperparameter","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"atx6B8Y6Ff"}],"key":"GqzsAsa4L6"}],"key":"pG5FUv1fhR"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Default scoring measures are accuracy (classification) or ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"QqNrKljacj"},{"type":"inlineMath","value":"R^2","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>R</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">R^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"DJfK0zZ0pD"},{"type":"text","value":" (regression)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"u8zS5IVlVm"}],"key":"Nd7TRXDHBV"}],"key":"FmUY2Plvwm"}],"key":"VtfVuwJIt2"}],"key":"rdeXgSGSrr"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Even though models are built internally, they are not returned","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"vJCkyXOISz"}],"key":"fPloYU7iV6"}],"key":"Uvl1An5PuC"}],"key":"gFuXNzLQLr"},{"type":"code","lang":"python","value":"knn = KNeighborsClassifier(n_neighbors=1)\nscores = cross_val_score(knn, iris.data, iris.target, cv=5)\nprint(\"Cross-validation scores: {}\".format(scores))\nprint(\"Average cross-validation score: {:.2f}\".format(scores.mean()))\nprint(\"Variance in cross-validation score: {:.4f}\".format(np.var(scores)))","position":{"start":{"line":9,"column":1},"end":{"line":15,"column":1}},"key":"RyR6UVMoi3"}],"key":"zY9BOUZqA0"},{"type":"block","kind":"notebook-code","data":{"hide_input":true},"children":[{"type":"code","lang":"python","executable":true,"value":"from sklearn.model_selection import cross_val_score\nfrom sklearn.datasets import load_iris\n\niris = load_iris()\nknn = KNeighborsClassifier(n_neighbors=1)\n\nscores = cross_val_score(knn, iris.data, iris.target)\nprint(\"Cross-validation scores: {}\".format(scores))\nprint(\"Average cross-validation score: {:.2f}\".format(scores.mean()))\nprint(\"Variance in cross-validation score: {:.4f}\".format(np.var(scores)))","key":"nKq7cM2bLz"},{"type":"outputs","id":"yD5UJVCZl2eOdCQG4RLK4","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Cross-validation scores: [0.96666667 0.96666667 0.93333333 0.93333333 1.        ]\nAverage cross-validation score: 0.96\nVariance in cross-validation score: 0.0006\n"},"children":[],"key":"VaIlmkkKDM"}],"key":"ihkGbSJntE"}],"key":"jTRT6NVVIg"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"More variants","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"K3AG7Axxmo"}],"identifier":"more-variants","label":"More variants","html_id":"more-variants","implicit":true,"key":"PrSTF3kxf3"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Stratified cross-validation: for inbalanced datasets","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"aZb0F2iSlq"}],"key":"MT3M49OqFs"}],"key":"dEiPmysfjK"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Leave-one-out cross-validation: for very small datasets","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tmYFBdF9xy"}],"key":"O8huFEDP0W"}],"key":"s1UaU0IqHf"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Shuffle-Split cross-validation: whenever you need to shuffle the data first","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"YkdtjaAk61"}],"key":"e5JGxDvhBf"}],"key":"hDwN35W3xV"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Repeated cross-validation: more trustworthy, but more expensive","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"GiYSCgrfWe"}],"key":"GRkIUzRi7J"}],"key":"qI5h5lP3bt"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Cross-validation with groups: Whenever your data contains non-independent datapoints, e.g. data points from the same patient","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Ao69SkAf9s"}],"key":"H1wDeJu0JO"}],"key":"QmhZOgxQYe"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Bootstrapping: sampling with replacement, for extracting statistical properties","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"OBK6evWTdd"}],"key":"dkMxFtirM3"}],"key":"RrLBeBomI7"}],"key":"UfFgK4WpGv"}],"key":"iUpy4A4IRi"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Avoid data leakage","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bCgNmH8gyJ"}],"identifier":"avoid-data-leakage","label":"Avoid data leakage","html_id":"avoid-data-leakage","implicit":true,"key":"OebLwDHTqD"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Simply taking the best performing model based on cross-validation performance yields optimistic results","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"AsGBkxLN4Q"}],"key":"shNw05475c"}],"key":"TwtcN8C7Ye"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We’ve already used the test data to evaluate each model!","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MXGZFWKto9"}],"key":"AAJHrQONQQ"}],"key":"N5XjwFao7E"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Hence, we don’t have an independent test set to evaluate these hyperparameter settings","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"D3vYfumMVY"}],"key":"xACkWkWnY2"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Information ‘leaks’ from test set into the final model","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"hRWh5QmBke"}],"key":"SIWenULAe3"}],"key":"bDbKVOsTgn"}],"key":"RTGZ9h38KA"}],"key":"S6KZfvtrEL"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Solution: Set aside part of the training data to evaluate the hyperparameter settings","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Qrr9g3wDkS"}],"key":"lFvsvxxlJ3"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Select best model on validation set","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"fzs1R1WpnM"}],"key":"tY47mJAjPf"}],"key":"bUZvS2U06s"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Rebuild the model on the training+validation set","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Cbdi200eYc"}],"key":"y0am8AqYBc"}],"key":"Ca1KVdQyup"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Evaluate optimal model on the test set","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"sY3Psm8Vvg"}],"key":"z5UK4mrfOh"}],"key":"vLck5P7Ehe"}],"key":"KLFOf2W5Bl"}],"key":"uGLn2iSH4T"}],"key":"Rm4ljCQSiq"}],"key":"P1zUfJDOKz"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Pipelines","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LSScFq1Vb8"}],"identifier":"pipelines","label":"Pipelines","html_id":"pipelines","implicit":true,"key":"BRtFavH0YF"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Many learning algorithms are greatly affected by ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"LBT7epwe47"},{"type":"emphasis","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"how","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ctIz4N6E8F"}],"key":"hz6XLaEd2h"},{"type":"text","value":" you represent the training data","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"lZaXI4Q4iY"}],"key":"w7pFFsFP5h"}],"key":"Sxuay4Ex9U"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Examples: Scaling, numeric/categorical values, missing values, feature selection/construction","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EN9Cyc1bMQ"}],"key":"qi6xjGVbWZ"}],"key":"HTRwO9yaOq"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We typically need chain together different algorithms","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"zMXwkyWG0u"}],"key":"lrWxwQu7Pb"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Many ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"i3nDkQ6CBP"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"preprocessing","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"eC4KoAF7Cr"}],"key":"n0C0NpRbNH"},{"type":"text","value":" steps","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"cpHtv3EPuf"}],"key":"UtfsRqYVTY"}],"key":"DGRmopdbF3"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Possibly many models","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"JdAmsP8edH"}],"key":"pTtcJ1vHeN"}],"key":"KNdrCrFySi"}],"key":"U3RiaAJnBt"}],"key":"NyBA3ObIRf"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"This is called a ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"DV3u9j2xzu"},{"type":"emphasis","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"pipeline","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Rppi5HcJ2P"}],"key":"TsbDRWHjEY"},{"type":"text","value":" (or ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"OkyKeZOff5"},{"type":"emphasis","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"workflow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"fZPDmHQzW6"}],"key":"kHD0GZuuZo"},{"type":"text","value":")","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"mIaa4jOXVc"}],"key":"O1gHxgsjxI"}],"key":"E663PhbU1Z"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The best way to represent data depends not only on the semantics of the data, but also on the kind of model you are using.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"ZF7gk6y3b5"}],"key":"ZjkIxjkhwx"}],"key":"LyjDvCfOIs"}],"key":"s17TDaNPsM"}],"key":"lQyhvURsII"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example: Speed dating data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wkyPxAMSTH"}],"identifier":"example-speed-dating-data","label":"Example: Speed dating data","html_id":"example-speed-dating-data","implicit":true,"key":"fFGL9b19dB"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Data collected from speed dating events","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"dNIjMz5iuc"}],"key":"HjJYUq2t2a"}],"key":"c5znPC2kDh"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"See ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SyrNfAVtVF"},{"type":"link","url":"https://www.openml.org/d/40536","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"https://​www​.openml​.org​/d​/40536","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vSpRcCGWXp"}],"urlSource":"https://www.openml.org/d/40536","key":"fKXYAIAPnx"}],"key":"B3ek5fIOLT"}],"key":"xuP05h4Oie"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Could also be collected from dating website or app","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"up2KXibLi4"}],"key":"bkk6Ge4y0s"}],"key":"Hge0hqPhFM"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Real-world data:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"hfQCC7Ee4u"}],"key":"duQk0jDi1w"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Different numeric scales","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ADMq7x84A8"}],"key":"z6KXRXd9fc"}],"key":"oIb41vWhwi"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Missing values","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ji7IwdGUY8"}],"key":"PIgQJ6WwMg"}],"key":"sD7IEQveW4"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Likely irrelevant features","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"UZc5PHadQB"}],"key":"DBG5rUpiiL"}],"key":"xfLHbNeBrI"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Different types: Numeric, categorical,...","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"fTwRLakeT2"}],"key":"fXkpC03Ori"}],"key":"OZ6F67BnbS"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Input errors (e.g. ‘lawyer’ vs ‘Lawyer’)","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"n2plNIA9If"}],"key":"rriF02nB0m"}],"key":"CTMTNe2c58"}],"key":"sRbpHq0p5w"}],"key":"gkppTb8xDK"}],"key":"gTwUKVIDjU"},{"type":"code","lang":"","value":"dating_data = fetch_openml(\"SpeedDating\")","position":{"start":{"line":12,"column":1},"end":{"line":14,"column":1}},"key":"Fz915Sd1Ik"}],"key":"VLqptwxuCa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dating_data = fetch_openml(\"SpeedDating\", version=1)","key":"hJgh0WvIh3"},{"type":"outputs","id":"DJoB4hRfShvR_InMgMMOs","children":[],"key":"VXzz1GEEfk"}],"key":"qGEkdCDb7Y"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Scaling","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ViRkEc4ZP0"}],"identifier":"scaling","label":"Scaling","html_id":"scaling","implicit":true,"key":"F5B2bvNqEG"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"When the features have different scales (their values range between very different minimum and maximum values), one feature will overpower the others. Several scaling techniques are available to solve this:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UCWHxNXXBv"}],"key":"clJ92cfitr"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"StandardScaler","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"xc3UUCCrq8"},{"type":"text","value":" rescales all features to mean=0 and variance=1","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"CFJVM7zeH2"}],"key":"hcCHUx2wG5"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Does not ensure and min/max value","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"cnAAKGwlMM"}],"key":"WWqiAvdJv8"}],"key":"V6cl9qqdIi"}],"key":"ps9JVtoukU"}],"key":"Y7mj49Zk8S"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"RobustScaler","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"U8yzlYLCC5"},{"type":"text","value":" uses the median and quartiles","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"OX1ZSrzt9X"}],"key":"asRKgzrDxu"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Median m: half of the values < m, half > m","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"LzL4bFZbzH"}],"key":"zsX1uRyVgF"}],"key":"uZEuVSGjOf"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Lower Quartile lq: 1/4 of values < lq","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"g7Mpo0a8qY"}],"key":"r3NPYqjGdX"}],"key":"lKjnLp2Zy1"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Upper Quartile uq: 1/4 of values > uq","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"uqoo12FK2N"}],"key":"ucVb6K9GfV"}],"key":"bcFSOe86jW"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Ignores ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Hnub6QqGrM"},{"type":"emphasis","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"outliers","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"gt0cyHdbfH"}],"key":"C6saI9AjTd"},{"type":"text","value":", brings all features to same scale","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"t7MXlhqXo2"}],"key":"sywzWMYwS5"}],"key":"kbebrgKHOl"}],"key":"ajlRV0uzqO"}],"key":"lk5qtMg4IO"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"MinMaxScaler","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"RyWXmIufUF"},{"type":"text","value":" brings all feature values between 0 and 1","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Sra8N98vo0"}],"key":"TrEftueCwS"}],"key":"UNS0t6PTFl"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"Normalizer","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"IqcEiZS4sA"},{"type":"text","value":" scales data such that the feature vector has Euclidean length 1","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"mEUpFnddQg"}],"key":"a61W5lrwn9"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Projects data to the unit circle","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"YIdoYPMfz5"}],"key":"N9moehjhXC"}],"key":"VuFaL4yirf"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Used when only the direction/angle of the data matters","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"Hhfgf0S2gc"}],"key":"fcWi172bgc"}],"key":"HwfVoksclz"}],"key":"l6cjwD2J52"}],"key":"o0YsnKyHBa"}],"key":"rJ9PauUrQp"}],"key":"E6MHgR7O0h"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Applying scaling transformations","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kMZY8KyZej"}],"identifier":"applying-scaling-transformations","label":"Applying scaling transformations","html_id":"applying-scaling-transformations","implicit":true,"key":"xJijNVx7Fq"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Lets apply a scaling transformation ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"UYHNj2L4Im"},{"type":"emphasis","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"manually","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"m8NLD09Ln3"}],"key":"oHA1NiO1B7"},{"type":"text","value":", then use it to train a learning algorithm","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"axwOLF1Obf"}],"key":"jzTNWxy3hF"}],"key":"w9ZewMMplz"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"First, split the data in training and test set","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IqFZ5CdaOB"}],"key":"ujijg6chOm"}],"key":"rYF1Oot1yD"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Next, we ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"u01qhy6hts"},{"type":"inlineCode","value":"fit","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"qMHdLGDqpn"},{"type":"text","value":" the preprocessor on the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ss8ztSQ7Nt"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"training data","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ianVr0USAZ"}],"key":"PBpiE6RwZ6"}],"key":"CszlHBHW0D"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"This computes the necessary transformation parameters","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"TRO0M2vgf4"}],"key":"R44rftRYXQ"}],"key":"nlXYbXvKiQ"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"For ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"oVEDmemBeZ"},{"type":"inlineCode","value":"MinMaxScaler","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"cqU2XpHHza"},{"type":"text","value":", these are the min/max values for every feature","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"G7OsJBi7fL"}],"key":"zhVPiV9VPA"}],"key":"ySJKLTLcDx"}],"key":"uelkejHIGV"}],"key":"hTZDPkSVg4"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"After fitting, we can ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"bRRjb6iBHg"},{"type":"inlineCode","value":"transform","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"GIZkrUcvge"},{"type":"text","value":" the training and test data","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"jetRUZ3kAI"}],"key":"WG3JgmX2r7"}],"key":"NWL0IZBAkv"}],"key":"TypfqTdw4g"},{"type":"code","lang":"python","value":"scaler = MinMaxScaler()\nscaler.fit(X_train)\nX_train_scaled = scaler.transform(X_train)\nX_test_scaled = scaler.transform(X_test)","position":{"start":{"line":9,"column":1},"end":{"line":14,"column":1}},"key":"n9900b5dDM"}],"key":"C8B3nCo1aZ"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Missing value imputation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BdECPCDWMv"}],"identifier":"missing-value-imputation","label":"Missing value imputation","html_id":"missing-value-imputation","implicit":true,"key":"ziflLmuGBs"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Many sci-kit learn algorithms cannot handle missing value","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Nz9JRBK0xL"}],"key":"d8HZzlQhsM"}],"key":"pMGYfnFC0h"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"Imputer","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sYNTV60ZyS"},{"type":"text","value":" replaces specific values","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vG9QC8IVnc"}],"key":"Pg1rmqqRDU"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"missing_values","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"KYuzbakCte"},{"type":"text","value":" (default ‘NaN’) placeholder for the missing value","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"uXwvdRvsiE"}],"key":"tq2xSl8P8u"}],"key":"yyAQbLYYQR"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"strategy","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ueM44B7G7I"},{"type":"text","value":":","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"py4t8JTu7x"}],"key":"TpiJ86wzt5"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"mean","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"a3FFf931MD"},{"type":"text","value":", replace using the mean along the axis","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"kz915rJWop"}],"key":"ysWeLCnh8F"}],"key":"FeMT4oY4RA"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"median","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ewTwsRvRIK"},{"type":"text","value":", replace using the median along the axis","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"cYSPc6k8r8"}],"key":"fYIW0fYnAN"}],"key":"vWhZK4fipN"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"most_frequent","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"agUsNJSVkY"},{"type":"text","value":", replace using the most frequent value","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"qwfXlNoeBq"}],"key":"RlNzaTB3ot"}],"key":"Fd2cuquskX"}],"key":"qvZ6INi4YL"}],"key":"SQxxlUBNji"}],"key":"l98aoIOCUr"}],"key":"xCgevJ8pUG"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Many more advanced techniques exist, but not yet in scikit-learn","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"NXb6iMge1f"}],"key":"AHv2Wfqa8C"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"e.g. low rank approximations (uses matrix factorization)","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Lg9B2IdQDy"}],"key":"VkmKpxvBGd"}],"key":"HUpW5ca8Nm"}],"key":"Sh87nufB7t"}],"key":"eM6Nhy4uDb"}],"key":"DO8yUb8TnV"}],"key":"MjejRiTBgS"},{"type":"block","kind":"notebook-content","children":[{"type":"code","lang":"python","value":"imp = Imputer(missing_values='NaN', strategy='mean', axis=0)\nimp.fit_transform(X1_train)","position":{"start":{"line":1,"column":1},"end":{"line":4,"column":1}},"key":"F2KStH03Is"}],"key":"CwtJfJHJCG"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Feature encoding","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yGPfKefr9N"}],"identifier":"feature-encoding","label":"Feature encoding","html_id":"feature-encoding","implicit":true,"key":"lK9CuBr34s"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"scikit-learn classifiers only handle numeric data. If your features are categorical, you need to encode them first","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"gHPuT1ZHfF"}],"key":"AKmMiNWsCt"}],"key":"N58iLwUOhj"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"LabelEncoder","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ed1p901oZu"},{"type":"text","value":" simply replaces each value with an integer value","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ocvLHNGqgL"}],"key":"IK8zdtGEDy"}],"key":"KwCcDuix1W"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"OneHotEncoder","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"A5nPTwkzyd"},{"type":"text","value":" converts a feature of ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"NSnMw9FmcK"},{"type":"inlineMath","value":"n","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"h5OWp4EgZ1"},{"type":"text","value":" values to ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"FLjMIinIdr"},{"type":"inlineMath","value":"n","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"jMxbeTpfFw"},{"type":"text","value":" binary features","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"f1PPnce8Th"}],"key":"soMygjjloX"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Provide ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"m1u0GwDaik"},{"type":"inlineCode","value":"categories","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"kAxyP49ejK"},{"type":"text","value":" as array or set to ‘auto’","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LgvRqOFvnb"}],"key":"Y4Cso81v6a"}],"key":"dsB34gYc36"}],"key":"N7cUvlPozg"}],"key":"hLolvITFhp"}],"key":"hL7j5VICQg"},{"type":"code","lang":"python","value":"X_enc = OneHotEncoder(categories='auto').fit_transform(X)\n","position":{"start":{"line":7,"column":1},"end":{"line":10,"column":1}},"key":"f3Vi9ZTkyq"}],"key":"mhlCLWUCzK"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"ColumnTransformer","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kE4i1yjbFC"},{"type":"text","value":" can apply different transformers to different features","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"m9pEWI2RF6"}],"key":"KkyQ23MAfJ"}],"key":"EoDf603yRC"},{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Transformers can be pipelines doing multiple things","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ZNl0Zg8WTl"}],"key":"oohV7jYJnR"}],"key":"rDIpHi3SiJ"}],"key":"bCVAwgNUaG"},{"type":"code","lang":"python","value":"numeric_features = ['age', 'pref_o_attractive']\nnumeric_transformer = Pipeline(steps=[\n    ('imputer', SimpleImputer(strategy='median')),\n    ('scaler', StandardScaler())])\n\ncategorical_features = ['gender', 'd_d_age', 'field']\ncategorical_transformer = Pipeline(steps=[\n    ('imputer', SimpleImputer(strategy='constant', fill_value='missing')),\n    ('onehot', OneHotEncoder(handle_unknown='ignore'))])\n\npreprocessor = ColumnTransformer(\n    transformers=[\n        ('num', numeric_transformer, numeric_features),\n        ('cat', categorical_transformer, categorical_features)])","position":{"start":{"line":4,"column":1},"end":{"line":19,"column":1}},"key":"YdhdOvJwFH"}],"key":"qE5TDKVlnv"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Building Pipelines","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"a09WPYmSQX"}],"identifier":"building-pipelines","label":"Building Pipelines","html_id":"building-pipelines","implicit":true,"key":"P2pb4k2vfy"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"In scikit-learn, a ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"iXijEpG9ie"},{"type":"inlineCode","value":"pipeline","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"t6lPQJr3Sz"},{"type":"text","value":" combines multiple processing ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"JPRLMsGJCa"},{"type":"emphasis","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"steps","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"RDqHNtWhfW"}],"key":"p1oT8kF8Lc"},{"type":"text","value":" in a single estimator","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"sA2sdeg3IL"}],"key":"sLwGanASBG"}],"key":"hpMupOa8Z8"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"All but the last step should be transformer (have a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EcFTKTwtgR"},{"type":"inlineCode","value":"transform","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hnRVEOSNbi"},{"type":"text","value":" method)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"c5eAahrpQI"}],"key":"cixy7PiLCE"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The last step can be a transformer too (e.g. Scaler+PCA)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"eQMCp98uO9"}],"key":"dVjpBWxOJA"}],"key":"KADK7Tnd7E"}],"key":"vZmhpgjWsl"}],"key":"fWDWqKtBRh"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"It has a ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Tf3JCt4dBV"},{"type":"inlineCode","value":"fit","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"C0bwO4DEnE"},{"type":"text","value":", ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"XYwsxassk7"},{"type":"inlineCode","value":"predict","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"GhzTc2TbjV"},{"type":"text","value":", and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"vSts97lZph"},{"type":"inlineCode","value":"score","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"tslSQFMzff"},{"type":"text","value":" method, just like any other learning algorithm","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"KUkkwzTeX2"}],"key":"yW3BGCzFkD"}],"key":"GaFbt0HjJ7"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Pipelines are built as a list of steps, which are (name, algorithm) tuples","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Nv1fknvN9D"}],"key":"ROdT2fnamH"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The name can be anything you want, but can’t contain ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"QnDVZxBk18"},{"type":"inlineCode","value":"'__'","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"TlmSkbcwOQ"}],"key":"lAEuVSfA13"}],"key":"iBlnrkufKH"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We use ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"AKpzika4YH"},{"type":"inlineCode","value":"'__'","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"HdyBcVdNCR"},{"type":"text","value":" to refer to the hyperparameters, e.g. ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"TeNCZdZPmb"},{"type":"inlineCode","value":"svm__C","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"UBXvEs8fdM"}],"key":"fyWkeTBsiY"}],"key":"wC7v7r1EUu"}],"key":"PbbxO3T0RA"}],"key":"GWLYtmuDzu"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Let’s build, train, and score a ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Dk8qMf9ZtX"},{"type":"inlineCode","value":"MinMaxScaler","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"e9XGcC7PHa"},{"type":"text","value":" + ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"fktkOVItwp"},{"type":"inlineCode","value":"LinearSVC","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"zmlLAdCQSQ"},{"type":"text","value":" pipeline:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"F1f2VUXIYH"}],"key":"D969TAAQrP"}],"key":"p64nmnO224"}],"key":"gcHobZTTxO"}],"key":"jqRKsIUfp4"},{"type":"block","kind":"notebook-content","children":[{"type":"code","lang":"python","value":"pipe = Pipeline([(\"scaler\", MinMaxScaler()), (\"svm\", LinearSVC())])\npipe.fit(X_train, y_train).score(X_test, y_test)","position":{"start":{"line":1,"column":1},"end":{"line":4,"column":1}},"key":"mBKNrfxkHc"}],"key":"HHLnkMrt5i"},{"type":"block","kind":"notebook-code","data":{"hide_input":true,"slideshow":{"slide_type":"-"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from sklearn.pipeline import Pipeline\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.svm import LinearSVC\nfrom sklearn.datasets import load_breast_cancer\n\ncancer = load_breast_cancer()\n\npipe = Pipeline([(\"scaler\", MinMaxScaler()), (\"svm\", LinearSVC())])\n\nX_train, X_test, y_train, y_test = train_test_split(cancer.data, cancer.target,\n                                                    random_state=1)\npipe.fit(X_train, y_train)\nprint(\"Test score: {:.2f}\".format(pipe.score(X_test, y_test)))","key":"BEPIU0Pjvu"},{"type":"outputs","id":"_HKYcbchLWnqGdzSPmnxW","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Test score: 0.97\n"},"children":[],"key":"XDkPXHacAv"}],"key":"msp8wpiMIv"}],"key":"U0XiVjA5pn"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Now with cross-validation:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IVkWKCjFWJ"}],"key":"zuZJi8bACv"}],"key":"ORX1GMsTCQ"}],"key":"pX1Cosr2uz"},{"type":"code","lang":"python","value":"scores = cross_val_score(pipe, cancer.data, cancer.target)","position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"key":"zRqsA1jxGI"}],"key":"o00WCSgNfv"},{"type":"block","kind":"notebook-code","data":{"hide_input":true},"children":[{"type":"code","lang":"python","executable":true,"value":"from sklearn.model_selection import cross_val_score\nscores = cross_val_score(pipe, cancer.data, cancer.target)\nprint(\"Cross-validation scores: {}\".format(scores))\nprint(\"Average cross-validation score: {:.2f}\".format(scores.mean()))","key":"ySZqgTBtVl"},{"type":"outputs","id":"f5MZ7sf3rwO1GAIQ9oFO0","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Cross-validation scores: [0.98245614 0.97368421 0.96491228 0.96491228 0.99115044]\nAverage cross-validation score: 0.98\n"},"children":[],"key":"bZm42EtOI1"}],"key":"Acye6VRtV1"}],"key":"Vcq6AlFhej"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We can retrieve the trained SVM by querying the right step indices","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Y0YEDG7VWa"}],"key":"IZBPWFKXaK"}],"key":"WtaW4Ez1zW"}],"key":"cYOSQpEdFB"},{"type":"code","lang":"python","value":"pipe.steps[1][1]","position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"key":"v4UFbS428T"}],"key":"dHYSgTbCw5"},{"type":"block","kind":"notebook-code","data":{"hide_input":true},"children":[{"type":"code","lang":"python","executable":true,"value":"pipe.fit(X_train, y_train)\nprint(\"SVM component: {}\".format(pipe.steps[1][1]))","key":"JLZgn5vqfN"},{"type":"outputs","id":"DRyCbSY3uuCQ3uMdhJpFH","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"SVM component: LinearSVC()\n"},"children":[],"key":"idzveDX3eh"}],"key":"VlaqfRLWU5"}],"key":"ZsNle29bfg"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"-"}},"children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Or we can use the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"F7oBu0dig3"},{"type":"inlineCode","value":"named_steps","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"trOxNrK8fR"},{"type":"text","value":" dictionary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kTTXWuCJid"}],"key":"skFjF7dwib"}],"key":"H2hTTxVsck"}],"key":"jm6jPjjNRs"},{"type":"code","lang":"python","value":"pipe.named_steps['svm']","position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"key":"Vs9X7ROmkO"}],"key":"NbHfb4gkCe"},{"type":"block","kind":"notebook-code","data":{"hide_input":true},"children":[{"type":"code","lang":"python","executable":true,"value":"print(\"SVM component: {}\".format(pipe.named_steps['svm']))","key":"Az79tM7C14"},{"type":"outputs","id":"uLqVDFKpUdK1G3lcOSVG3","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"SVM component: LinearSVC()\n"},"children":[],"key":"cw7AmoAyI6"}],"key":"QS7GBw8LAC"}],"key":"WWH0kR58AM"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"When you don’t need specific names for specific steps, you can use ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UGx920oUlu"},{"type":"inlineCode","value":"make_pipeline","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dVukl2MoKM"}],"key":"WxnSoRLFRl"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Assigns names to steps automatically","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"N3akprr6my"}],"key":"q7mrdYjHkh"}],"key":"bwWkpNQyfx"}],"key":"HHFaEVpzqi"}],"key":"wlmfYVhyVC"}],"key":"O3vtJz5M5T"},{"type":"code","lang":"python","value":"pipe_short = make_pipeline(MinMaxScaler(), LinearSVC(C=100))\nprint(\"Pipeline steps:\\n{}\".format(pipe_short.steps))","position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"key":"H38iVq5i4s"}],"key":"AQ4vS9p0mh"},{"type":"block","kind":"notebook-code","data":{"hide_input":true},"children":[{"type":"code","lang":"python","executable":true,"value":"from sklearn.pipeline import make_pipeline\n# abbreviated syntax\npipe_short = make_pipeline(MinMaxScaler(), LinearSVC(C=100))\nprint(\"Pipeline steps:\\n{}\".format(pipe_short.steps))","key":"ugyK1VczqS"},{"type":"outputs","id":"4fjIb5WHzoTj7engVKo3z","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Pipeline steps:\n[('minmaxscaler', MinMaxScaler()), ('linearsvc', LinearSVC(C=100))]\n"},"children":[],"key":"jqvVvLTTAp"}],"key":"QQ0ceERiCQ"}],"key":"ryig7R5N3J"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Model selection and Hyperparameter tuning","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rsyU2z9Ysc"}],"identifier":"model-selection-and-hyperparameter-tuning","label":"Model selection and Hyperparameter tuning","html_id":"model-selection-and-hyperparameter-tuning","implicit":true,"key":"oqMR9UmDHa"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"There are many algorithms to choose from","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"OCRcYi1E1Z"}],"key":"eOA7EYMY6F"}],"key":"QhLenLuGm8"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Most algorithms have parameters (hyperparameters) that control model complexity","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ho7UiwTbZ4"}],"key":"e5KgRKmMUt"}],"key":"Tqzye5BG2q"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Now that we know how to evaluate models, we can improve them selecting by ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ky8MFiG0DK"},{"type":"inlineCode","value":"tuning","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"DDI6oYBsho"},{"type":"text","value":" algorithms for your data","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"yI5mQXNaSg"}],"key":"gVtcGMKA3M"}],"key":"l6wafbblh8"}],"key":"hA0Kqjh4Tj"}],"key":"B1HHfpkud9"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can basically use any optimization technique to optimize hyperparameters:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VPmsVtsocY"}],"key":"GYOFN93O3X"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Grid search","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"D57IwVKPce"}],"key":"Fdqyv8Nkrm"}],"key":"lw4cbGDhhc"}],"key":"YuCV8DQIpJ"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Random search","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"PXe4jok1QF"}],"key":"MRSE1ttV7L"}],"key":"O6etwQyk56"}],"key":"Dyyucuiqj5"}],"key":"Ku5VZl4O9D"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"More advanced techniques:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"IxWetQ0AdE"}],"key":"lCR7ZZvLab"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":8,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Local search","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"SOm7mghcIa"}],"key":"oIlbQVHvLA"}],"key":"qrUlPT8pU9"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Racing algorithms","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"sHFHTgY6Dt"}],"key":"N9wb5MkOHK"}],"key":"qOX3LelclM"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Bayesian optimization","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"DLHEYxHIFj"}],"key":"Ipn8rA7v5j"}],"key":"Htb5nJg2YL"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Multi-armed bandits","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"VECE5s8MDu"}],"key":"pYaP2ELcRR"}],"key":"CLkYRMuHuT"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Genetic algorithms","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"qAG3CMI14l"}],"key":"k6mLMCI0Cd"}],"key":"S7immfilmT"}],"key":"sl7GBQa9Km"}],"key":"Fm1L84nEh3"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Grid vs Random Search\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MgG7bElOiY"},{"type":"image","style":{"width":"800px"},"url":"/c3fe04398256b4fcc43a211bbbd4f2da.png","alt":"ml","key":"hRh5yHptaO","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/eval_gridrandom.png","urlOptimized":"/c3fe04398256b4fcc43a211bbbd4f2da.webp"}],"key":"S0xaPtAj2d"}],"key":"HVlr5g0oCd"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Grid Search","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ntG459aRPe"}],"identifier":"grid-search","label":"Grid Search","html_id":"grid-search","implicit":true,"key":"UvY42svkYp"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"For each hyperparameter, create a list of interesting/possible values","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FKW85aIDo1"}],"key":"wFYZ8KuTNi"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"E.g. For kNN: k in [1,3,5,7,9,11,33,55,77,99]","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Z4UbsJtT0P"}],"key":"IcJMyh5TV6"}],"key":"BOSat985Pf"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"E.g. For SVM: C and gamma in [","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"URMzNxGNiE"},{"type":"span","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"10","key":"uPXXaU7esT"},{"type":"superscript","children":[{"type":"text","value":"-10","key":"n3JN2Br9Qr"}],"key":"CKEFjAp7l6"}],"key":"hP00Cjx67I"},{"type":"text","value":"..","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"pjs7PHYqd0"},{"type":"span","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"10","key":"PA9uvTFMNY"},{"type":"superscript","children":[{"type":"text","value":"10","key":"UIOKFp5Twt"}],"key":"sIsxg1McKr"}],"key":"ttvjtZOeG1"},{"type":"text","value":"]","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"K4JHT6rl8M"}],"key":"vfgGzElHMp"}],"key":"uNscrjYrBl"}],"key":"eynhzzImco"}],"key":"UZuD50HJTa"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Evaluate all possible combinations of hyperparameter values","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"lvwjT7Gnve"}],"key":"j8Cy5fQPQr"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"E.g. using cross-validation","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"UApxNGeafI"}],"key":"qaNPnGARxh"}],"key":"KJeqqyGCTq"}],"key":"tK0ywMBbwJ"}],"key":"ZALBYpSHXw"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Split the training data into a training and validation set","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"MW4YOARoH7"}],"key":"JdDeDaIQp5"}],"key":"Jc9Ds8UBYE"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Select the hyperparameter values yielding the best results on the validation set","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"yoJNqAaCKi"}],"key":"aB0iylakvR"}],"key":"LiUDqhR2og"}],"key":"Huj97vWc9e"}],"key":"OddfwCWSoI"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Grid search in scikit-learn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sjRQcD6TTP"}],"identifier":"grid-search-in-scikit-learn","label":"Grid search in scikit-learn","html_id":"grid-search-in-scikit-learn","implicit":true,"key":"r68K4XFtLL"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Create a parameter grid as a dictionary","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Wg0xSaxTmC"}],"key":"YcSYWiANsj"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Keys are parameter names","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eWmkI7bpMG"}],"key":"YwV9EG3QaI"}],"key":"CKQmx9ELuv"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Values are lists of hyperparameter values","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ZuVyJn5EKD"}],"key":"JxY3DlJnZi"}],"key":"Jx6YUnUEZj"}],"key":"INwry9cdIL"}],"key":"k6BZR8aQx6"}],"key":"uLOW0bcf1x"},{"type":"code","lang":"python","value":"param_grid = {'C': [0.001, 0.01, 0.1, 1, 10, 100],\n              'gamma': [0.001, 0.01, 0.1, 1, 10, 100]}\nprint(\"Parameter grid:\\n{}\".format(param_grid))","position":{"start":{"line":6,"column":1},"end":{"line":10,"column":1}},"key":"iRxMlTs4zn"}],"key":"Q5UyZOeI1i"},{"type":"block","kind":"notebook-code","data":{"hide_input":true},"children":[{"type":"code","lang":"python","executable":true,"value":"param_grid = {'C': [0.001, 0.01, 0.1, 1, 10, 100],\n              'gamma': [0.001, 0.01, 0.1, 1, 10, 100]}\nprint(\"Parameter grid:\\n{}\".format(param_grid))","key":"gF82Sb4S8m"},{"type":"outputs","id":"emiEQ3rocXmysFfq3Xl2q","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Parameter grid:\n{'C': [0.001, 0.01, 0.1, 1, 10, 100], 'gamma': [0.001, 0.01, 0.1, 1, 10, 100]}\n"},"children":[],"key":"BcBvzrCdKl"}],"key":"dPHQ1NAr3L"}],"key":"uGgyRfXkWL"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"GridSearchCV","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QWBmDPNhx1"},{"type":"text","value":": like a classifier that uses CV to automatically optimize its hyperparameters internally","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xkNy5ZFwTH"}],"key":"e5mXYhlXB9"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Input: (untrained) model, parameter grid, CV procedure","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"LBkai3Y5Pp"}],"key":"yEal0iEIyF"}],"key":"h7PXZOsR8M"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Output: optimized model on given training data","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Feq23mJqeJ"}],"key":"dQIisM7Irr"}],"key":"hmAMQ33gp5"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Should only have access to training data","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"L7Aj6UgsRp"}],"key":"i8pHDdPjAw"}],"key":"GxgzmtqeQ7"}],"key":"PrFxwObEuc"}],"key":"DNWzEvPvY5"}],"key":"fTgFdf4l1C"},{"type":"code","lang":"python","value":"grid_search = GridSearchCV(SVC(), param_grid, cv=5)\ngrid_search.fit(X_train, y_train)","position":{"start":{"line":6,"column":1},"end":{"line":9,"column":1}},"key":"dOKYU4p3ob"}],"key":"WecKbgr0Vz"},{"type":"block","kind":"notebook-code","data":{"hide_input":true},"children":[{"type":"code","lang":"python","executable":true,"value":"from sklearn.model_selection import GridSearchCV \nfrom sklearn.svm import SVC\ngrid_search = GridSearchCV(SVC(), param_grid, cv=5)\nX_train, X_test, y_train, y_test = train_test_split(\n        iris.data, iris.target, random_state=0)\ngrid_search.fit(X_train, y_train)","key":"Yynzi6RReq"},{"type":"outputs","id":"6qMXkoLl6nNjyR8sUaPiN","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/plain":{"content":"GridSearchCV(cv=5, estimator=SVC(),\n             param_grid={'C': [0.001, 0.01, 0.1, 1, 10, 100],\n                         'gamma': [0.001, 0.01, 0.1, 1, 10, 100]})","content_type":"text/plain"}}},"children":[],"key":"XBP7aNNU31"}],"key":"t6T7caYWfZ"}],"key":"BuxP6XHmMA"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The optimized test score and hyperparameters can easily be retrieved:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"coJr2pgVx6"}],"key":"sxTEQDwtd7"},{"type":"code","lang":"python","value":"grid_search.score(X_test, y_test)\ngrid_search.best_params_\ngrid_search.best_score_\ngrid_search.best_estimator_","position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"key":"GWLnmqvOTV"}],"key":"PGNEpcziDp"},{"type":"block","kind":"notebook-code","data":{"hide_input":true},"children":[{"type":"code","lang":"python","executable":true,"value":"print(\"Test set score: {:.2f}\".format(grid_search.score(X_test, y_test)))\nprint(\"Best parameters: {}\".format(grid_search.best_params_))\nprint(\"Best cross-validation score: {:.2f}\".format(grid_search.best_score_))\nprint(\"Best estimator:\\n{}\".format(grid_search.best_estimator_))","key":"x7AbXOZftE"},{"type":"outputs","id":"Wrso7fYDBgQWBRhhisEy2","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Test set score: 0.97\nBest parameters: {'C': 10, 'gamma': 0.1}\nBest cross-validation score: 0.97\nBest estimator:\nSVC(C=10, gamma=0.1)\n"},"children":[],"key":"gOpCK78dpG"}],"key":"N41HE33Dk5"}],"key":"V8QiT6UjgK"},{"type":"block","kind":"notebook-content","data":{"hide_input":false,"slideshow":{"slide_type":"subslide"}},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Nested cross-validation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l0ANNkrgYI"}],"identifier":"nested-cross-validation","label":"Nested cross-validation","html_id":"nested-cross-validation","implicit":true,"key":"xsHfLObRa9"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Note that we are still using a single split to create the outer test set","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZFAcldmhTT"}],"key":"qnE7VsALIX"}],"key":"hIOIYYb1in"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We can also use cross-validation here","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Nvb7xbpWfU"}],"key":"EuZA0Xsa4m"}],"key":"abOzRnVeUL"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Nested cross-validation:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Qpfj6P8396"}],"key":"QuK5FGsDKh"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Outer loop: split data in training and test sets","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"SAWvWc1OFg"}],"key":"Pu1vtqmRqP"}],"key":"roFl9XM71i"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Inner loop: run grid search, splitting the training data into train and validation sets","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"W75pG1LwJn"}],"key":"F8UxwkjADN"}],"key":"xlnOEncr1r"}],"key":"JXDvuevlFx"}],"key":"dqpFZo0ZA4"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Result is a just a list of scores","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Ly1JCKr1XI"}],"key":"S71bqaNiJ3"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"There will be multiple optimized models and hyperparameter settings (not returned)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"No6huE1KgE"}],"key":"KVWwlet1lo"}],"key":"mfouWSTEUj"}],"key":"IrzyO60wmv"}],"key":"wh8LkGrE0S"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"To apply on future data, we need to train ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"CJEZg2MIWU"},{"type":"inlineCode","value":"GridSearchCV","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"IY2VVvNRqn"},{"type":"text","value":" on all data again","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"R3BaROLXYL"}],"key":"EW60k86Tzp"}],"key":"snX9EEJvu0"}],"key":"GpU0chimrs"}],"key":"AWUNSP7UE8"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"code","lang":"python","value":"scores = cross_val_score(GridSearchCV(SVC(), param_grid, cv=5),\n                         iris.data, iris.target, cv=5)","position":{"start":{"line":1,"column":1},"end":{"line":4,"column":1}},"key":"IWDzznBK2N"}],"key":"Qc9gsfc6LH"},{"type":"block","kind":"notebook-code","data":{"hide_input":true},"children":[{"type":"code","lang":"python","executable":true,"value":"scores = cross_val_score(GridSearchCV(SVC(), param_grid, cv=5),\n                         iris.data, iris.target, cv=5)\nprint(\"Cross-validation scores: \", scores)\nprint(\"Mean cross-validation score: \", scores.mean())","key":"M5YWynocUj"},{"type":"outputs","id":"RmyadNMhRhriSWbBnkBwP","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Cross-validation scores:  [0.96666667 1.         0.96666667 0.96666667 1.        ]\nMean cross-validation score:  0.9800000000000001\n"},"children":[],"key":"nrgRMPMa4s"}],"key":"P4ieuwoXLu"}],"key":"vtgOeeL6YJ"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Random Search","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JtWFYKflFd"}],"identifier":"random-search","label":"Random Search","html_id":"random-search","implicit":true,"key":"kSiZERCRtn"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Grid Search has a few downsides:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GW8y0AqLFq"}],"key":"kd5Hkv6WEj"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Optimizing many hyperparameters creates a combinatorial explosion","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"L78mME8TZc"}],"key":"dPAZt51mcK"}],"key":"WIv2VTjHlH"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"You have to predefine a grid, hence you may jump over optimal values","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"t1XXymJIG9"}],"key":"kFGa5zv8hi"}],"key":"USVfE9vovy"}],"key":"u6Ow6uoghe"}],"key":"z75EAJni20"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Random Search:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"uwVwcts73i"}],"key":"E6nddDrJlv"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Picks ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"nx8sXDetif"},{"type":"inlineCode","value":"n_iter","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"QYp3fdGDIm"},{"type":"text","value":" random parameter values","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"oE7o7Mfn1e"}],"key":"TxnxzSzc0v"}],"key":"xeMJGD0zO9"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Scales better, you control the number of iterations","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"XyEFyCh23P"}],"key":"PoEIOalsTL"}],"key":"dCKw72QFmc"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Often works better in practice, too","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ZCf0IzR6UD"}],"key":"hqcoCnfCPO"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"not all hyperparameters interact strongly","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"IJwunxbREd"}],"key":"jAvy7cYvBj"}],"key":"c8op8bvGhx"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"you don’t need to explore all combinations","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"bPE14jeiCX"}],"key":"ghUSZeE9EA"}],"key":"Tea4x9rhpb"}],"key":"OTIB8qCb4q"}],"key":"N9HV44gyT1"}],"key":"XT4wRiEuza"}],"key":"WFdZqvn5qe"}],"key":"MAn1LqMPxG"}],"key":"YdYltTJ0pc"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Executing random search in scikit-learn:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kwZ1qqiXDZ"}],"key":"UE4rrLQ5zc"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"RandomizedSearchCV","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"rjUtPYXNiB"},{"type":"text","value":" works like ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Ol9Vdtm0fC"},{"type":"inlineCode","value":"GridSearchCV","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"D3VH9hRT4V"}],"key":"BhQOfREyop"}],"key":"CMsgRkboc2"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Has ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YGusRBlYFf"},{"type":"inlineCode","value":"n_iter","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MJxBz7e5LS"},{"type":"text","value":" parameter for the number of iterations","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rvFgT8BSFR"}],"key":"Yku833e7pj"}],"key":"UchjtY62US"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Search grid can use distributions instead of fixed lists","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Mc0DqAQQtU"}],"key":"us6pnhu6Cr"}],"key":"oRdxdz5qGT"}],"key":"Xy6WF0C2wk"}],"key":"bYLotKY0OZ"}],"key":"dW4abqnzo8"},{"type":"code","lang":"python","value":"param_grid = {'C': expon(scale=100), \n              'gamma': expon(scale=.1)}\nrandom_search = RandomizedSearchCV(SVC(), param_distributions=param_grid,\n                                   n_iter=20)\nrandom_search.fit(X_train, y_train)\nrandom_search.best_estimator_","position":{"start":{"line":6,"column":1},"end":{"line":13,"column":1}},"key":"GIaPeDDVmk"}],"key":"qLLMt3AWmf"},{"type":"block","kind":"notebook-code","data":{"hide_input":true},"children":[{"type":"code","lang":"python","executable":true,"value":"from sklearn.model_selection import RandomizedSearchCV\nfrom scipy.stats import expon\n\nparam_grid = {'C': expon(scale=100), \n              'gamma': expon(scale=.1)}\nrandom_search = RandomizedSearchCV(SVC(), param_distributions=param_grid,\n                                   n_iter=20)\nX_train, X_test, y_train, y_test = train_test_split(\n        iris.data, iris.target, random_state=0)\nrandom_search.fit(X_train, y_train)\nrandom_search.best_estimator_","key":"bWvgCpSB0b"},{"type":"outputs","id":"SjWMeclSxc1ycunhdUO2-","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":25,"metadata":{},"data":{"text/plain":{"content":"SVC(C=210.39084256954456, gamma=0.003623016212739808)","content_type":"text/plain"}}},"children":[],"key":"UByC6Yf3sy"}],"key":"XZ35nm6lKX"}],"key":"MflHcLiRZA"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Using Pipelines in Grid-searches","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"K6qudi6F5T"}],"identifier":"using-pipelines-in-grid-searches","label":"Using Pipelines in Grid-searches","html_id":"using-pipelines-in-grid-searches","implicit":true,"key":"g4gcbgh4r6"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We can use the pipeline as a single estimator in ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"kteLOJdkwV"},{"type":"inlineCode","value":"cross_val_score","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"WVt0zSlXxn"},{"type":"text","value":" or ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"AD8zNtpm4A"},{"type":"inlineCode","value":"GridSearchCV","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Yo0hpx3lF5"}],"key":"tvzyfEEj9u"}],"key":"IX2T4Vqec2"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"To define a grid, refer to the hyperparameters of the steps","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Rl2HOmcvFF"}],"key":"fSphhbIbXr"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Step ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"xMeEbcVINE"},{"type":"inlineCode","value":"svm","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"AyElTEaJ1H"},{"type":"text","value":", parameter ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"AzeYG6f0Ch"},{"type":"inlineCode","value":"C","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"yeuE1I8yjG"},{"type":"text","value":" becomes ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"VmrsrFpzmG"},{"type":"inlineCode","value":"svm__C","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"MxPZv23pJU"}],"key":"BL7z7h0KFF"}],"key":"TDw6J8LL9V"}],"key":"qXHeS7U4G1"}],"key":"CoKEGMsxLN"}],"key":"XKePFyLUQf"},{"type":"code","lang":"python","value":"param_grid = {'svm__C': [0.001, 0.01, 0.1, 1, 10, 100],\n              'svm__gamma': [0.001, 0.01, 0.1, 1, 10, 100]}\npipe = pipeline.Pipeline([(\"scaler\", MinMaxScaler()), (\"svm\", SVC(C=100))])\ngrid = GridSearchCV(pipe, param_grid=param_grid, cv=5)\ngrid.fit(X_train, y_train)","position":{"start":{"line":6,"column":1},"end":{"line":12,"column":1}},"key":"Wuy763JwTR"}],"key":"vWS966nSQi"},{"type":"block","kind":"notebook-code","data":{"hide_input":true},"children":[{"type":"code","lang":"python","executable":true,"value":"param_grid = {'svm__C': [0.001, 0.01, 0.1, 1, 10, 100],\n              'svm__gamma': [0.001, 0.01, 0.1, 1, 10, 100]}","key":"ypwG2w484C"},{"type":"outputs","id":"_YZZ0dMabxpvx8h5vjTts","children":[],"key":"zcwM1nFFOu"}],"key":"kkYZRmim9M"},{"type":"block","kind":"notebook-code","data":{"hide_input":true},"children":[{"type":"code","lang":"python","executable":true,"value":"from sklearn import pipeline\nfrom sklearn.svm import SVC\nfrom sklearn.model_selection import GridSearchCV\n\n\npipe = pipeline.Pipeline([(\"scaler\", MinMaxScaler()), (\"svm\", SVC(C=100))])\ngrid = GridSearchCV(pipe, param_grid=param_grid, cv=5)\ngrid.fit(X_train, y_train)\nprint(\"Best cross-validation accuracy: {:.2f}\".format(grid.best_score_))\nprint(\"Test set score: {:.2f}\".format(grid.score(X_test, y_test)))\nprint(\"Best parameters: {}\".format(grid.best_params_))","key":"KpfwA69chg"},{"type":"outputs","id":"YWB0gMfWbJrwI0RLDQT7N","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Best cross-validation accuracy: 0.96\nTest set score: 0.97\nBest parameters: {'svm__C': 1, 'svm__gamma': 10}\n"},"children":[],"key":"fnEUDp17Kq"}],"key":"aXtcAl3lJt"}],"key":"kNgSTvBVJQ"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"subslide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Automated Machine Learning","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bbEaAXQIOB"}],"identifier":"automated-machine-learning","label":"Automated Machine Learning","html_id":"automated-machine-learning","implicit":true,"key":"gRwCiyFav4"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Optimizes both the pipeline and all hyperparameters","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"B5NtMpCy3y"}],"key":"t8WY8rAzrh"}],"key":"Dm8TxDJIan"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"E.g. auto-sklearn","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"A8fbGFtnIT"}],"key":"aFmlQJKnEh"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Drop-in sklearn classifier","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Y4LH2nbfgu"}],"key":"AONSSmRacj"}],"key":"mnUXMjulGJ"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Also optimizes pipelines (e.g. feature selection)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"UzV7enMjsJ"}],"key":"O0KGocUMSw"}],"key":"jPZixR36LL"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Uses OpenML to find good models on similar datasets","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"N0vV0gqAPj"}],"key":"mVIIz8bBWK"}],"key":"IFJZopjFCF"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Lacks Windows support","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"FhEiWAgRce"}],"key":"H7qU2Ouqpv"}],"key":"Dl86OQ62dq"}],"key":"nx6buJMjIr"}],"key":"Nf7ldnbgjR"}],"key":"GKlZ8t9Pbb"},{"type":"code","lang":"python","value":"automl = autosklearn.classification.AutoSklearnClassifier(\n    time_left_for_this_task=60, # sec., for entire process\n    per_run_time_limit=15, # sec., for each model\n    ml_memory_limit=1024, # MB, memory limit\n)\nautoml.fit(X_train, y_train)","position":{"start":{"line":9,"column":1},"end":{"line":16,"column":1}},"key":"jhI8CK9fZX"}],"key":"SC3VXU24ac"}],"key":"WUlPS8IEdc"},"references":{"cite":{"order":[],"data":{}}}}