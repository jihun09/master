{"version":3,"kind":"Notebook","sha256":"4c4594bbfca24cc18a26dbf4afcb83d253029b73945ee633644ae98e8fa7f760","slug":"notebooks.transformers","location":"/notebooks/08 - Transformers.ipynb","dependencies":[],"frontmatter":{"title":"Lecture 8. Transformers","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"github":"https://github.com/ml-course/master","copyright":"2025. CC0 Licensed - Use as you like. Appropriate credit is very welcome","numbering":{"title":{"offset":1}},"source_url":"https://github.com/ml-course/master/blob/master/notebooks/08 - Transformers.ipynb","edit_url":"https://github.com/ml-course/master/edit/master/notebooks/08 - Transformers.ipynb","thumbnail":"/f367a12936cc927ce4da18f7c14791f5.png","thumbnailOptimized":"/f367a12936cc927ce4da18f7c14791f5.webp","exports":[{"format":"ipynb","filename":"08 - Transformers.ipynb","url":"/08 - Transformers-7ee3a5c151fe86592c6b9a67076388e4.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Maybe attention is all you need","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DUw9AtbGpX"}],"key":"a80kaNU2XB"}],"key":"qj46kIOUus"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Joaquin Vanschoren","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"cFWfiVXzEV"}],"key":"aiXaoBFxNV"}],"key":"ezWVfwFGN9"},{"type":"block","kind":"notebook-code","data":{"hide_input":false,"slideshow":{"slide_type":"skip"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Auto-setup when running on Google Colab\nimport os\nif 'google.colab' in str(get_ipython()) and not os.path.exists('/content/master'):\n    !git clone -q https://github.com/ML-course/master.git /content/master\n    !pip --quiet install -r /content/master/requirements_colab.txt\n    %cd master/notebooks\n\n# Global imports and settings\n%matplotlib inline\nfrom preamble import *\ninteractive = True # Set to True for interactive plots \nif interactive:\n    fig_scale = 0.5\n    plt.rcParams.update(print_config)\nelse: # For printing\n    fig_scale = 0.4\n    plt.rcParams.update(print_config)\n    \nHTML('''<style>.rise-enabled .reveal pre {font-size=75%} </style>''')","visibility":"show","key":"PlNTc1oWmm"},{"type":"outputs","id":"4TVJ7HCAm0tB5Mv7kgNMU","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"text/html":{"content":"<style>.rise-enabled .reveal pre {font-size=75%} </style>","content_type":"text/html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}},"children":[],"key":"VoXI32XPd0"}],"visibility":"show","key":"zz4tR1rRWX"}],"visibility":"show","key":"oOWj1m9TAT"},{"type":"block","kind":"notebook-content","data":{"cell_style":"center","slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Overview","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s7OdLNpdwE"}],"identifier":"overview","label":"Overview","html_id":"overview","implicit":true,"key":"SKneiK5RFw"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Basics: word embeddings","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"JvACeg8IV2"}],"key":"APaqGS6xnq"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Word2Vec, FastText, GloVe","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Ij7tUuw0rR"}],"key":"eDuY7EDvBa"}],"key":"cbEYMcFfqS"}],"key":"V3LjHq1SZG"}],"key":"O98cZfX6M9"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Sequence-to-sequence and autoregressive models","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"tcvzEAoHLE"}],"key":"r8MkOHMNhf"}],"key":"xq8Fx2O31l"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Self-attention and transformer models","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DBPbPounX3"}],"key":"DClFFlaTAV"}],"key":"I72EfG7Coz"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Vision Transformers","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ovVLPqyQr4"}],"key":"hMAmLQomiy"}],"key":"JfwFxTHqwa"}],"key":"ZsMs4Cx7eJ"}],"key":"Nas1jGfX9O"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Bag of word representation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vCHmEgpTAE"}],"identifier":"bag-of-word-representation","label":"Bag of word representation","html_id":"bag-of-word-representation","implicit":true,"key":"xkng7iVJbl"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"First, build a ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"kpOtzePSmX"},{"type":"emphasis","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"vocabulary","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Ef0JQ95aeC"}],"key":"T7ijlhNRlz"},{"type":"text","value":" of all occuring words. Maps every word to an index.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"E3B3LV8VnG"}],"key":"tA2WirIo8f"}],"key":"b9F3jwOZqZ"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Represent each document as an ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Rak2b9pDVx"},{"type":"inlineMath","value":"N","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"IcdfQ8W0iV"},{"type":"text","value":" dimensional vector (top-","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uSDz2AgtQA"},{"type":"inlineMath","value":"N","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"BtQI8RRhKE"},{"type":"text","value":" most frequent words)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GcWSQfIQnt"}],"key":"I447wHDNLX"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"One-hot (sparse) encoding: 1 if the word occurs in the document","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ljwMZgJoEd"}],"key":"Zc9vH3Vnwl"}],"key":"rtCJ6W9hvG"}],"key":"b4T9keKc4n"}],"key":"LMSclLw38v"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Destroys the order of the words in the text (hence, a ‘bag’ of words)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"BuRSj6POjo"}],"key":"dT8Q9Pm5JG"}],"key":"hLgY3Fzzgz"}],"key":"mu3ZrYhPJc"},{"type":"image","style":{"width":"60%"},"url":"/f367a12936cc927ce4da18f7c14791f5.png","alt":"ml","key":"PxymiMJE2v","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/bag_of_words.png","urlOptimized":"/f367a12936cc927ce4da18f7c14791f5.webp"}],"key":"Ho0Qqb05UA"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Text preprocessing pipelines","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yP46xLtNyp"}],"identifier":"text-preprocessing-pipelines","label":"Text preprocessing pipelines","html_id":"text-preprocessing-pipelines","implicit":true,"key":"xaZuUDdDcr"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Tokenization: how to you split text into words / tokens?","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"gDvBIPVql7"}],"key":"LTPqmKR4BD"}],"key":"WQtQORMDTj"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Stemming: naive reduction to word stems. E.g. ‘the meeting’ to ‘the meet’","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aDzYdd8LlJ"}],"key":"UcB9TmINJe"}],"key":"K24w4GPwfi"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Lemmatization: NLP-based reduction, e.g. distinguishes between nouns and verbs","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"QZmUpmHQlv"}],"key":"XfuWrOHADQ"}],"key":"ihX4Wgukrv"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Discard stop words (‘the’, ‘an’,...)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"sRrdWwuw5w"}],"key":"P7h8CE3dRV"}],"key":"x5gCof3iTS"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Only use ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Q7r69xGLxq"},{"type":"inlineMath","value":"N","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"Nh3ZCOy4qx"},{"type":"text","value":" (e.g. 10000) most frequent words, or a hash function","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"CdvHxp2zwb"}],"key":"naxnhgesSA"}],"key":"rNGck3h0XJ"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"n-grams: Use combinations of ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"NtaWFqguPU"},{"type":"inlineMath","value":"n","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"r4sXOgn2DJ"},{"type":"text","value":" adjacent words next to individual words","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Pu70b2VRZh"}],"key":"bSZ30Ie2s3"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"e.g. 2-grams: “awesome movie”, “movie with”, “with creative”, ...","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"srlM7b0L2k"}],"key":"nNOtAm4VPf"}],"key":"L0IF0AYRuv"}],"key":"qbK2Nq8pkf"}],"key":"yi2STCLZLE"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Character n-grams: combinations of ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"iop39x6tYh"},{"type":"inlineMath","value":"n","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"VrHuehRLC3"},{"type":"text","value":" adjacent letters: ‘awe’, ‘wes’, ‘eso’,...","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"TyMJE0R29V"}],"key":"CYbwNdU17T"}],"key":"pj8uEqrXRq"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Subword tokenizers: graceful splits “unbelievability” -> un, believ, abil, ity","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"fr1XwcF2ek"}],"key":"TWUSp2iub1"}],"key":"WBObazJBE9"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Useful libraries: ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"RvXilx2c1y"},{"type":"link","url":"https://www.nltk.org/","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"nltk","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"qO0kHgp2oF"}],"urlSource":"https://www.nltk.org/","key":"xy4QBVKwo8"},{"type":"text","value":", ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"KA2I8gZfay"},{"type":"link","url":"https://spacy.io/","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"spaCy","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"VHwT2rPr3m"}],"urlSource":"https://spacy.io/","key":"RbuBosfioN"},{"type":"text","value":", ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"m6HkV964uQ"},{"type":"link","url":"https://radimrehurek.com/gensim/","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"gensim","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"nmOTPkbfOx"}],"urlSource":"https://radimrehurek.com/gensim/","key":"pvy9NBhHzX"},{"type":"text","value":", ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"w30nx1F8qP"},{"type":"link","url":"https://huggingface.co/docs/tokenizers/index","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"HuggingFace tokenizers","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"zg70hWpDcU"}],"urlSource":"https://huggingface.co/docs/tokenizers/index","key":"DUOdVBM3ZY"},{"type":"text","value":",...","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"F8UeUsuIuy"}],"key":"KnqtuMUcaQ"}],"key":"qohBZvk7k6"}],"key":"hj3wtlt3Jw"}],"key":"D3c1jWNjwL"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"skip"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Scaling","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"B9lEn85TNe"}],"identifier":"scaling","label":"Scaling","html_id":"scaling","implicit":true,"key":"IPABNV1Enh"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Only for classical models, LLMs use subword tokenizers and dense tokens from embedding layers (see later)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"MkcSrewNEi"}],"key":"nlrD1YCg2y"}],"key":"CA6Ak4NGtE"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"L2 Normalization (vector norm): sum of squares of all word values equals 1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZWLKw1VccU"}],"key":"qOrs1OZFHI"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Normalized Euclidean distance is equivalent to cosine distance","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"wotf7UYhbz"}],"key":"QG7InwSioJ"}],"key":"Jpmim7aarb"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Works better for distance-based models (e.g. kNN, SVM,...)\n","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"qObekmRB9o"}],"key":"FWOzheD34i"},{"type":"math","value":"t_i = \\frac{t_i}{\\| t\\|_2 }","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub><mo>=</mo><mfrac><msub><mi>t</mi><mi>i</mi></msub><mrow><mi mathvariant=\"normal\">∥</mi><mi>t</mi><msub><mi mathvariant=\"normal\">∥</mi><mn>2</mn></msub></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">t_i = \\frac{t_i}{\\| t\\|_2 }</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2281em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2921em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">∥</span><span class=\"mord mathnormal\">t</span><span class=\"mord\"><span class=\"mord\">∥</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"1","key":"gyCMk1JkKV"}],"key":"GXoy4wUaFo"}],"key":"E0BdeRBbl2"}],"key":"Slv7OT63X0"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Term Frequency - Inverted Document Frequency (TF-IDF)","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"lZAMiIungs"}],"key":"JXqEiBlGos"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Scales value of words by how frequently they occur across all ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"gOlpYP3aYN"},{"type":"inlineMath","value":"N","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"rkugtuoBrY"},{"type":"text","value":" documents","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"E2TMUt8BLo"}],"key":"hMRT7eefIl"}],"key":"PPoP6KMFLU"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Words that only occur in few documents get higher weight, and vice versa","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"je06artT9q"}],"key":"pJDAtviz9u"}],"key":"tGTde73ptl"}],"key":"dPkEuvUsqd"}],"key":"NBzbpW3Ldz"}],"key":"cqMmQT8W3x"},{"type":"math","value":"t_i = t_i \\cdot log(\\frac{N}{|\\{d \\in D : t_i \\in d\\}|})","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub><mo>⋅</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=\"false\">(</mo><mfrac><mi>N</mi><mrow><mi mathvariant=\"normal\">∣</mi><mo stretchy=\"false\">{</mo><mi>d</mi><mo>∈</mo><mi>D</mi><mo>:</mo><msub><mi>t</mi><mi>i</mi></msub><mo>∈</mo><mi>d</mi><mo stretchy=\"false\">}</mo><mi mathvariant=\"normal\">∣</mi></mrow></mfrac><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">t_i = t_i \\cdot log(\\frac{N}{|\\{d \\in D : t_i \\in d\\}|})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2963em;vertical-align:-0.936em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">∣</span><span class=\"mopen\">{</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mclose\">}</span><span class=\"mord\">∣</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"2","key":"Or4WVHIhVD"}],"key":"NzIrQ3wtpk"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Neural networks on bag of words","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bUHXWSoYtw"}],"identifier":"neural-networks-on-bag-of-words","label":"Neural networks on bag of words","html_id":"neural-networks-on-bag-of-words","implicit":true,"key":"OjxVPwXJb7"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We can build neural networks on bag-of-word vectors","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"MHRQrPiaEj"}],"key":"MYyJQ8QbsT"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Do a one-hot-encoding with 10000 most frequent words","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sb8PZnj5S4"}],"key":"D45qBcJ2Gv"}],"key":"cswUaUT8Qc"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Simple model with 2 dense layers, ReLU activation, dropout","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"CfqGu060A0"}],"key":"FllMXVUhg7"}],"key":"mEAqwFuBgQ"}],"key":"s6UFdZSy2V"}],"key":"jky6mjUjye"}],"key":"SZ9QEvmY4v"},{"type":"code","lang":"python","value":"self.model = nn.Sequential(\n    nn.Linear(10000, 16),\n    nn.ReLU(),\n    nn.Dropout(0.5),\n    nn.Linear(16, 16),\n    nn.ReLU(),\n    nn.Dropout(0.5),\n    nn.Linear(16, 1)\n)","position":{"start":{"line":6,"column":1},"end":{"line":16,"column":1}},"key":"Op2IebrkjW"}],"key":"b1xZR9OhCH"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Evaluation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SmBJr3N6r1"}],"identifier":"evaluation","label":"Evaluation","html_id":"evaluation","implicit":true,"key":"SIZT9gqRCg"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"IMDB dataset of movie reviews (label is ‘positive’ or ‘negative’)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"RNScnJEY8y"}],"key":"l7f0xnSz5k"}],"key":"TzrKj6hvzj"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Take a validation set of 10,000 samples from the training set","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vcu7aTnW04"}],"key":"BexCzoIPEX"}],"key":"j5QXgcwX71"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Works prety well (88% Acc), but overfits easily","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"v11iuDc7gg"}],"key":"JJhysw2nA0"}],"key":"orQhDbP26a"}],"key":"NLnJrd3cjk"}],"key":"N8detXi7uH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import torch\nfrom torch.utils.data import DataLoader, Dataset, random_split\nfrom collections import Counter\nimport torch.nn as nn\nimport torch.nn.functional as F\nimport pytorch_lightning as pl\nfrom keras.datasets import imdb\nfrom IPython.display import clear_output\n\n# Load data with top 10,000 words\n(train_data, train_labels), (test_data, test_labels) = imdb.load_data(num_words=10000)\n\n# Vectorize sequences into one-hot encoded vectors\ndef vectorize_sequences(sequences, dimension=10000):\n    results = np.zeros((len(sequences), dimension), dtype=np.float32)\n    for i, sequence in enumerate(sequences):\n        results[i, sequence] = 1.0\n    return results\n\n# One-hot encode\nx_train = vectorize_sequences(train_data)\nx_test = vectorize_sequences(test_data)\ny_train = np.asarray(train_labels).astype('float32')\ny_test = np.asarray(test_labels).astype('float32')\n\nclass IMDBVectorizedDataset(Dataset):\n    def __init__(self, features, labels):\n        self.x = torch.tensor(features, dtype=torch.float32)\n        self.y = torch.tensor(labels, dtype=torch.float32)\n\n    def __len__(self):\n        return len(self.x)\n\n    def __getitem__(self, idx):\n        return self.x[idx], self.y[idx]\n    \n# Validation split like in Keras: first 10k for val\nx_val, x_partial_train = x_train[:10000], x_train[10000:]\ny_val, y_partial_train = y_train[:10000], y_train[10000:]\n\ntrain_dataset = IMDBVectorizedDataset(x_partial_train, y_partial_train)\nval_dataset = IMDBVectorizedDataset(x_val, y_val)\ntest_dataset = IMDBVectorizedDataset(x_test, y_test)\n\ntrain_loader = DataLoader(train_dataset, batch_size=512, shuffle=True)\nval_loader = DataLoader(val_dataset, batch_size=512)\ntest_loader = DataLoader(test_dataset, batch_size=512)\n\nclass LivePlotCallback(pl.Callback):\n    def __init__(self):\n        self.train_losses = []\n        self.train_accs = []\n        self.val_losses = []\n        self.val_accs = []\n        self.max_acc = 0\n\n    def on_train_epoch_end(self, trainer, pl_module):\n        metrics = trainer.callback_metrics\n\n        train_loss = metrics.get(\"train_loss\")\n        train_acc = metrics.get(\"train_acc\")\n        val_loss = metrics.get(\"val_loss\")\n        val_acc = metrics.get(\"val_acc\")\n\n        if all(v is not None for v in [train_loss, train_acc, val_loss, val_acc]):\n            self.train_losses.append(train_loss.item())\n            self.train_accs.append(train_acc.item())\n            self.val_losses.append(val_loss.item())\n            self.val_accs.append(val_acc.item())\n            self.max_acc = max(self.max_acc, val_acc.item())\n\n            if len(self.train_losses) > 1:\n                clear_output(wait=True)\n                N = np.arange(0, len(self.train_losses))\n                plt.figure(figsize=(10, 4))\n                plt.plot(N, self.train_losses, label='train_loss', lw=2, c='r')\n                plt.plot(N, self.train_accs, label='train_acc', lw=2, c='b')\n                plt.plot(N, self.val_losses, label='val_loss', lw=2, linestyle=\":\", c='r')\n                plt.plot(N, self.val_accs, label='val_acc', lw=2, linestyle=\":\", c='b')\n                plt.title(f\"Training Loss and Accuracy [Max Val Acc: {self.max_acc:.4f}]\", fontsize=12)\n                plt.xlabel(\"Epoch\", fontsize=12)\n                plt.ylabel(\"Loss / Accuracy\", fontsize=12)\n                plt.tick_params(axis='both', labelsize=12)\n                plt.legend(fontsize=12)\n                plt.grid(True)\n                plt.show()\n            \nclass IMDBClassifier(pl.LightningModule):\n    def __init__(self):\n        super().__init__()\n        self.fc1 = nn.Linear(10000, 16)\n        self.dropout1 = nn.Dropout(0.5)\n        self.fc2 = nn.Linear(16, 16)\n        self.dropout2 = nn.Dropout(0.5)\n        self.fc3 = nn.Linear(16, 1)\n\n    def forward(self, x):\n        x = F.relu(self.fc1(x))\n        x = self.dropout1(x)\n        x = F.relu(self.fc2(x))\n        x = self.dropout2(x)\n        x = torch.sigmoid(self.fc3(x))\n        return x.squeeze()\n\n    def training_step(self, batch, batch_idx):\n        x, y = batch\n        y_hat = self(x)\n        loss = F.binary_cross_entropy(y_hat, y)\n        acc = ((y_hat > 0.5) == y.bool()).float().mean()\n        self.log(\"train_loss\", loss, on_step=False, on_epoch=True, prog_bar=True)\n        self.log(\"train_acc\", acc, on_step=False, on_epoch=True, prog_bar=True)\n        return loss\n\n    def validation_step(self, batch, batch_idx):\n        x, y = batch\n        y_hat = self(x)\n        val_loss = F.binary_cross_entropy(y_hat, y)\n        val_acc = ((y_hat > 0.5) == y.bool()).float().mean()\n        self.log(\"val_loss\", val_loss, on_epoch=True, prog_bar=True)\n        self.log(\"val_acc\", val_acc, on_epoch=True, prog_bar=True)\n\n    def configure_optimizers(self):\n        return torch.optim.RMSprop(self.parameters())\n    \nmodel = IMDBClassifier()\ntrainer = pl.Trainer(max_epochs=15, callbacks=[LivePlotCallback()], logger=False, enable_checkpointing=False)\ntrainer.fit(model, train_dataloaders=train_loader, val_dataloaders=val_loader)\n\n","key":"FfO1Za5vGz"},{"type":"outputs","id":"OXiXU-BqYOvFS2PnNzZGo","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"application/pdf":{"content":"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aGFyUHJvY3MgMTYgMCBSCi9FbmNvZGluZyA8PCAvVHlwZSAvRW5jb2RpbmcKL0RpZmZlcmVuY2VzIFsgMzIgL3NwYWNlIDQ2IC9wZXJpb2QgL3NsYXNoIC96ZXJvIC9vbmUgL3R3byAvdGhyZWUgL2ZvdXIgL2ZpdmUgL3NpeAovc2V2ZW4gL2VpZ2h0IC9uaW5lIC9jb2xvbiA2NSAvQSA2OSAvRSA3NiAvTCAvTSA4NCAvVCA4NiAvViA5MSAvYnJhY2tldGxlZnQKOTMgL2JyYWNrZXRyaWdodCA5NSAvdW5kZXJzY29yZSA5NyAvYSA5OSAvYyAvZCAxMDMgL2cgL2ggL2kgMTA4IC9sIDExMCAvbgovbyAvcCAxMTQgL3IgL3MgL3QgL3UgL3YgMTIwIC94IC95IF0KPj4KL1dpZHRocyAxMyAwIFIgPj4KZW5kb2JqCjE0IDAgb2JqCjw8IC9UeXBlIC9Gb250RGVzY3JpcHRvciAvRm9udE5hbWUgL0JNUVFEVitEZWphVnVTYW5zIC9GbGFncyAzMgovRm9udEJCb3ggWyAtMTAyMSAtNDYzIDE3OTQgMTIzMyBdIC9Bc2NlbnQgOTI5IC9EZXNjZW50IC0yMzYgL0NhcEhlaWdodCAwCi9YSGVpZ2h0IDAgL0l0YWxpY0FuZ2xlIDAgL1N0ZW1WIDAgL01heFdpZHRoIDEzNDIgPj4KZW5kb2JqCjEzIDAgb2JqClsgNjAwIDYwMCA2MDAgNjAwIDYwMCA2MDAgNjAwIDYwMCA2MDAgNjAwIDYwMCA2MDAgNjAwIDYwMCA2MDAgNjAwIDYwMCA2MDAKNjAwIDYwMCA2MDAgNjAwIDYwMCA2MDAgNjAwIDYwMCA2MDAgNjAwIDYwMCA2MDAgNjAwIDYwMCAzMTggNDAxIDQ2MCA4MzggNjM2Cjk1MCA3ODAgMjc1IDM5MCAzOTAgNTAwIDgzOCAzMTggMzYxIDMxOCAzMzcgNjM2IDYzNiA2MzYgNjM2IDYzNiA2MzYgNjM2IDYzNgo2MzYgNjM2IDMzNyAzMzcgODM4IDgzOCA4MzggNTMxIDEwMDAgNjg0IDY4NiA2OTggNzcwIDYzMiA1NzUgNzc1IDc1MiAyOTUKMjk1IDY1NiA1NTcgODYzIDc0OCA3ODcgNjAzIDc4NyA2OTUgNjM1IDYxMSA3MzIgNjg0IDk4OSA2ODUgNjExIDY4NSAzOTAgMzM3CjM5MCA4MzggNTAwIDUwMCA2MTMgNjM1IDU1MCA2MzUgNjE1IDM1MiA2MzUgNjM0IDI3OCAyNzggNTc5IDI3OCA5NzQgNjM0IDYxMgo2MzUgNjM1IDQxMSA1MjEgMzkyIDYzNCA1OTIgODE4IDU5MiA1OTIgNTI1IDYzNiAzMzcgNjM2IDgzOCA2MDAgNjM2IDYwMCAzMTgKMzUyIDUxOCAxMDAwIDUwMCA1MDAgNTAwIDEzNDIgNjM1IDQwMCAxMDcwIDYwMCA2ODUgNjAwIDYwMCAzMTggMzE4IDUxOCA1MTgKNTkwIDUwMCAxMDAwIDUwMCAxMDAwIDUyMSA0MDAgMTAyMyA2MDAgNTI1IDYxMSAzMTggNDAxIDYzNiA2MzYgNjM2IDYzNiAzMzcKNTAwIDUwMCAxMDAwIDQ3MSA2MTIgODM4IDM2MSAxMDAwIDUwMCA1MDAgODM4IDQwMSA0MDEgNTAwIDYzNiA2MzYgMzE4IDUwMAo0MDEgNDcxIDYxMiA5NjkgOTY5IDk2OSA1MzEgNjg0IDY4NCA2ODQgNjg0IDY4NCA2ODQgOTc0IDY5OCA2MzIgNjMyIDYzMiA2MzIKMjk1IDI5NSAyOTUgMjk1IDc3NSA3NDggNzg3IDc4NyA3ODcgNzg3IDc4NyA4MzggNzg3IDczMiA3MzIgNzMyIDczMiA2MTEgNjA1CjYzMCA2MTMgNjEzIDYxMyA2MTMgNjEzIDYxMyA5ODIgNTUwIDYxNSA2MTUgNjE1IDYxNSAyNzggMjc4IDI3OCAyNzggNjEyIDYzNAo2MTIgNjEyIDYxMiA2MTIgNjEyIDgzOCA2MTIgNjM0IDYzNCA2MzQgNjM0IDU5MiA2MzUgNTkyIF0KZW5kb2JqCjE2IDAgb2JqCjw8IC9BIDE3IDAgUiAvRSAxOCAwIFIgL0wgMTkgMCBSIC9NIDIwIDAgUiAvVCAyMSAwIFIgL1YgMjIgMCBSIC9hIDIzIDAgUgovYnJhY2tldGxlZnQgMjQgMCBSIC9icmFja2V0cmlnaHQgMjUgMCBSIC9jIDI2IDAgUiAvY29sb24gMjcgMCBSIC9kIDI4IDAgUgovZWlnaHQgMjkgMCBSIC9maXZlIDMwIDAgUiAvZm91ciAzMSAwIFIgL2cgMzIgMCBSIC9oIDMzIDAgUiAvaSAzNCAwIFIKL2wgMzUgMCBSIC9uIDM2IDAgUiAvbmluZSAzNyAwIFIgL28gMzggMCBSIC9vbmUgMzkgMCBSIC9wIDQwIDAgUgovcGVyaW9kIDQxIDAgUiAvciA0MiAwIFIgL3MgNDMgMCBSIC9zZXZlbiA0NCAwIFIgL3NpeCA0NSAwIFIgL3NsYXNoIDQ2IDAgUgovc3BhY2UgNDcgMCBSIC90IDQ4IDAgUiAvdGhyZWUgNDkgMCBSIC90d28gNTAgMCBSIC91IDUxIDAgUgovdW5kZXJzY29yZSA1MiAwIFIgL3YgNTMgMCBSIC94IDU0IDAgUiAveSA1NSAwIFIgL3plcm8gNTYgMCBSID4+CmVuZG9iagozIDAgb2JqCjw8IC9GMSAxNSAwIFIgPj4KZW5kb2JqCjQgMCBvYmoKPDwgL0ExIDw8IC9UeXBlIC9FeHRHU3RhdGUgL0NBIDAgL2NhIDEgPj4KL0EyIDw8IC9UeXBlIC9FeHRHU3RhdGUgL0NBIDEgL2NhIDEgPj4KL0EzIDw8IC9UeXBlIC9FeHRHU3RhdGUgL0NBIDAuOCAvY2EgMC44ID4+ID4+CmVuZG9iago1IDAgb2JqCjw8ID4+CmVuZG9iago2IDAgb2JqCjw8ID4+CmVuZG9iago3IDAgb2JqCjw8ID4+CmVuZG9iagoyIDAgb2JqCjw8IC9UeXBlIC9QYWdlcyAvS2lkcyBbIDExIDAgUiBdIC9Db3VudCAxID4+CmVuZG9iago1NyAwIG9iago8PCAvQ3JlYXRvciAoTWF0cGxvdGxpYiB2My4xMC4wLCBodHRwczovL21hdHBsb3RsaWIub3JnKQovUHJvZHVjZXIgKE1hdHBsb3RsaWIgcGRmIGJhY2tlbmQgdjMuMTAuMCkKL0NyZWF0aW9uRGF0ZSAoRDoyMDI1MDMyNDE4MzQyMiswMicwMCcpID4+CmVuZG9iagp4cmVmCjAgNTgKMDAwMDAwMDAwMCA2NTUzNSBmIAowMDAwMDAwMDE2IDAwMDAwIG4gCjAwMDAwMTQwMzkgMDAwMDAgbiAKMDAwMDAxMzgwMiAwMDAwMCBuIAowMDAwMDEzODM0IDAwMDAwIG4gCjAwMDAwMTM5NzYgMDAwMDAgbiAKMDAwMDAxMzk5NyAwMDAwMCBuIAowMDAwMDE0MDE4IDAwMDAwIG4gCjAwMDAwMDAwNjUgMDAwMDAgbiAKMDAwMDAwMDM0MCAwMDAwMCBuIAowMDAwMDAyMjUxIDAwMDAwIG4gCjAwMDAwMDAyMDggMDAwMDAgbiAKMDAwMDAwMjIzMCAwMDAwMCBuIAowMDAwMDEyMjUwIDAwMDAwIG4gCjAwMDAwMTIwNDMgMDAwMDAgbiAKMDAwMDAxMTQ4MyAwMDAwMCBuIAowMDAwMDEzMzAzIDAwMDAwIG4gCjAwMDAwMDIyNzEgMDAwMDAgbiAKMDAwMDAwMjQzNCAwMDAwMCBuIAowMDAwMDAyNTg3IDAwMDAwIG4gCjAwMDAwMDI3MjAgMDAwMDAgbiAKMDAwMDAwMjg4MiAwMDAwMCBuIAowMDAwMDAzMDIwIDAwMDAwIG4gCjAwMDAwMDMxNjQgMDAwMDAgbiAKMDAwMDAwMzU0NCAwMDAwMCBuIAowMDAwMDAzNjg5IDAwMDAwIG4gCjAwMDAwMDM4MzAgMDAwMDAgbiAKMDAwMDAwNDEzNSAwMDAwMCBuIAowMDAwMDA0MjgwIDAwMDAwIG4gCjAwMDAwMDQ1ODQgMDAwMDAgbiAKMDAwMDAwNTA1MiAwMDAwMCBuIAowMDAwMDA1Mzc0IDAwMDAwIG4gCjAwMDAwMDU1NDAgMDAwMDAgbiAKMDAwMDAwNTk1NCAwMDAwMCBuIAowMDAwMDA2MTkxIDAwMDAwIG4gCjAwMDAwMDYzMzUgMDAwMDAgbiAKMDAwMDAwNjQ1NCAwMDAwMCBuIAowMDAwMDA2NjkwIDAwMDAwIG4gCjAwMDAwMDcwODUgMDAwMDAgbiAKMDAwMDAwNzM3NiAwMDAwMCBuIAowMDAwMDA3NTMxIDAwMDAwIG4gCjAwMDAwMDc4NDMgMDAwMDAgbiAKMDAwMDAwNzk2NiAwMDAwMCBuIAowMDAwMDA4MTk5IDAwMDAwIG4gCjAwMDAwMDg2MDYgMDAwMDAgbiAKMDAwMDAwODc0OCAwMDAwMCBuIAowMDAwMDA5MTQxIDAwMDAwIG4gCjAwMDAwMDkyNjcgMDAwMDAgbiAKMDAwMDAwOTM1NyAwMDAwMCBuIAowMDAwMDA5NTYzIDAwMDAwIG4gCjAwMDAwMDk5NzYgMDAwMDAgbiAKMDAwMDAxMDMwMCAwMDAwMCBuIAowMDAwMDEwNTQ3IDAwMDAwIG4gCjAwMDAwMTA2NzMgMDAwMDAgbiAKMDAwMDAxMDgyMCAwMDAwMCBuIAowMDAwMDEwOTgxIDAwMDAwIG4gCjAwMDAwMTExOTUgMDAwMDAgbiAKMDAwMDAxNDA5OSAwMDAwMCBuIAp0cmFpbGVyCjw8IC9TaXplIDU4IC9Sb290IDEgMCBSIC9JbmZvIDU3IDAgUiA+PgpzdGFydHhyZWYKMTQyNTgKJSVFT0YK","content_type":"application/pdf"},"image/png":{"content_type":"image/png","hash":"d5e2fa1fc63ac0867f264b8cd3a214c5","path":"/d5e2fa1fc63ac0867f264b8cd3a214c5.png"},"text/plain":{"content":"<Figure size 3000x1200 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"Z0Cg0DKWqL"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"`Trainer.fit` stopped: `max_epochs=15` reached.\n"},"children":[],"key":"avdRjFweun"}],"key":"BvYxV3gWcD"}],"key":"F5a6uIYUQX"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Predictions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xvGHub886i"}],"identifier":"predictions","label":"Predictions","html_id":"predictions","implicit":true,"key":"VPRzHlA5rr"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Let’s look at a few predictions. Why is the last one so negative?","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"YQkfBZro1j"}],"key":"KjPwdVTKxK"}],"key":"mQGQ0s3cpA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# 1. Get the trained model into eval mode\nmodel.eval()\n\n# 2. Disable gradient tracking\nwith torch.no_grad():\n    # Convert entire test set to a tensor if not already\n    x_test_tensor = torch.tensor(x_test, dtype=torch.float32)\n\n    # Get predictions\n    predictions = model(x_test_tensor).numpy()\n\n# Get word index from Keras\nword_index = imdb.get_word_index()\nreverse_word_index = {value + 3: key for key, value in word_index.items()}\n\n# Add special tokens\nreverse_word_index[0] = '[PAD]'\nreverse_word_index[1] = '[START]'\nreverse_word_index[2] = '[UNK]'\nreverse_word_index[3] = '[UNUSED]'\n\ndef encode_review(text, word_index, num_words=10000):\n    # Basic preprocessing\n    words = text.lower().split()\n    encoded = [1]  # 1 is the index for [START]\n\n    for word in words:\n        index = word_index.get(word, 2)  # 2 is [UNK]\n        if index < num_words:\n            encoded.append(index)\n    return encoded\n\n# Function to decode a review\ndef decode_review(encoded_review):\n    return ' '.join([reverse_word_index.get(i, '?') for i in encoded_review])\n\nprint(\"Review 0:\\n\", decode_review(test_data[0]))\nprint(\"Predicted positiveness:\", predictions[0])\n\nprint(\"\\nReview 16:\\n\", decode_review(test_data[16]))\nprint(\"Predicted positiveness:\", predictions[16])\n\n# New sentence\nsentence = 'the restaurant is not too terrible'\nencoded = encode_review(sentence, word_index)\nvectorized = vectorize_sequences([encoded])  # Note: wrap in list to get shape (1, 10000)\nmodel.eval() \nwith torch.no_grad():\n    input_tensor = torch.tensor(vectorized, dtype=torch.float32)\n    prediction = model(input_tensor).item()\n\nprint(\"\\nReview X:\\n\", \"[START]\",sentence)\nprint(f\"Predicted positiveness: {prediction:.4f}\")","key":"UgVZq5O2Gn"},{"type":"outputs","id":"KXlBgq3058TbMaWHyvbV9","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Review 0:\n [START] please give this one a miss br br [UNK] [UNK] and the rest of the cast rendered terrible performances the show is flat flat flat br br i don't know how michael madison could have allowed this one on his plate he almost seemed to know this wasn't going to work out and his performance was quite [UNK] so all you madison fans give this a miss\nPredicted positiveness: 0.15110373\n\nReview 16:\n [START] from 1996 first i watched this movie i feel never reach the end of my satisfaction i feel that i want to watch more and more until now my god i don't believe it was ten years ago and i can believe that i almost remember every word of the dialogues i love this movie and i love this novel absolutely perfection i love willem [UNK] he has a strange voice to spell the words black night and i always say it for many times never being bored i love the music of it's so much made me come into another world deep in my heart anyone can feel what i feel and anyone could make the movie like this i don't believe so thanks thanks\nPredicted positiveness: 0.99687344\n\nReview X:\n [START] the restaurant is not too terrible\nPredicted positiveness: 0.8728\n"},"children":[],"key":"G8Mh6npPXb"}],"key":"E5ohS9RLWo"}],"key":"FuWiGBaNsA"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Word Embeddings","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AmDWqzGAko"}],"identifier":"word-embeddings","label":"Word Embeddings","html_id":"word-embeddings","implicit":true,"key":"hvUAMajPf5"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"A word embedding is a numeric vector representation of a word","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"PE4epJvsMs"}],"key":"lU4A7ohkOa"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Can be manual or ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dQxY1dpHfC"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"learned","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cU5yzHXPCz"}],"key":"ohpbcsqDAS"},{"type":"text","value":" from an existing representation (e.g. one-hot)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xnkTy1NG5K"}],"key":"lbtpt6vMxW"}],"key":"hBY2TGC4Bh"}],"key":"omEsj2qN4b"}],"key":"wUyEna4inr"}],"key":"DWBD8BpjIY"},{"type":"image","style":{"width":"60%","marginLeft":"auto","marginRight":"auto"},"url":"/56ca782892db0019e2d6252b76b16a51.png","alt":"ml","key":"WGSx4DsIYK","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/10_embeddings.png","urlOptimized":"/56ca782892db0019e2d6252b76b16a51.webp"}],"key":"stYECsabXl"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Learning embeddings from scratch","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pWEpIGW6Y6"}],"identifier":"learning-embeddings-from-scratch","label":"Learning embeddings from scratch","html_id":"learning-embeddings-from-scratch","implicit":true,"key":"EtH65dUeVi"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Input layer uses fixed length documents (with 0-padding).","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"B5iy6F45wj"}],"key":"DWcfJ3hwqt"}],"key":"g8L8KY9nVU"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Add an ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yXnlAOcc4T"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"embedding layer","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"iEw8fJUXJ0"}],"key":"kNVIV3vAX8"},{"type":"text","value":" to learn the embedding","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CVcH2UAduq"}],"key":"Bkn1Xmj1ka"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Create ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"kUSaGSJAdP"},{"type":"inlineMath","value":"n","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"zVWVcr8Yjd"},{"type":"text","value":"-dimensional one-hot encoding.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"HjFd7l8LgI"}],"key":"s8yWMgNGlV"}],"key":"CoCaUDZCun"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"To learn an ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"aE8wvG8jZn"},{"type":"inlineMath","value":"m","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"bX1Owy90TS"},{"type":"text","value":"-dimensional embedding, use ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LEKkJQkssd"},{"type":"inlineMath","value":"m","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"DLG9kVLap4"},{"type":"text","value":" hidden nodes. Weight matrix ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"umykwjlIwf"},{"type":"inlineMath","value":"W^{n x m}","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>W</mi><mrow><mi>n</mi><mi>x</mi><mi>m</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">W^{n x m}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mord mathnormal mtight\">m</span></span></span></span></span></span></span></span></span></span></span></span>","key":"SFAURAJblo"}],"key":"lgx2CyXx3r"}],"key":"CmY3ePO4lG"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Linear activation function: ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"YGgjNBKI1j"},{"type":"inlineMath","value":"\\mathbf{X}_{embed} = W \\mathbf{X}_{orig}","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">X</mi><mrow><mi>e</mi><mi>m</mi><mi>b</mi><mi>e</mi><mi>d</mi></mrow></msub><mo>=</mo><mi>W</mi><msub><mi mathvariant=\"bold\">X</mi><mrow><mi>o</mi><mi>r</mi><mi>i</mi><mi>g</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{X}_{embed} = W \\mathbf{X}_{orig}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\">mb</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9722em;vertical-align:-0.2861em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord\"><span class=\"mord mathbf\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">or</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">g</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"egDOVyKHFB"},{"type":"text","value":".","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"HCHYpy57d2"}],"key":"X5oeTMU3S2"}],"key":"ZJl58qoxX0"}],"key":"Q2MWw2Eswv"}],"key":"KyAshRTydl"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Combine all word embeddings into a document embedding (e.g. global pooling).","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"dKPfexz8qI"}],"key":"eK7PnKdVZt"}],"key":"cng1UE8YBH"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Add layers to map word embeddings to the output. Learn embedding weights from data.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"C6jadfW17N"}],"key":"ULCuZ9omjd"}],"key":"CVp5i8bZkB"}],"key":"uoqyQPLf7T"},{"type":"image","style":{"width":"60%","marginLeft":"auto","marginRight":"auto"},"url":"/e6607127224ac310fb404127614ee04f.png","alt":"ml","key":"skWgulYRUn","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/10_embedding_layer.png","urlOptimized":"/e6607127224ac310fb404127614ee04f.webp"}],"key":"gLOurLqqKt"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s try this:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BboEkS8Ysk"}],"key":"nXyOb8NgG0"},{"type":"code","lang":"python","value":"max_length = 100 # pad documents to a maximum number of words\nvocab_size = 10000 # vocabulary size\nembedding_length = 20 # embedding length (more would be better)\n\nself.model = nn.Sequential(\n    nn.Embedding(vocab_size, embedding_length),\n    nn.AdaptiveAvgPool1d(1),  # global average pooling over sequence\n    nn.Linear(embedding_length, 1),\n)","position":{"start":{"line":3,"column":1},"end":{"line":13,"column":1}},"key":"ntt68VmoDf"}],"key":"mitlqnzSdg"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Training on the IMDB dataset: slightly worse than using bag-of-words?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yaqj0qLvDT"}],"key":"sFLvUWLlP9"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Embedding of dim 20 is very small, should be closer to 100 (or 300)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"XlxSqmEPEv"}],"key":"dkDbfWgbNQ"}],"key":"yY1dP4m2Ym"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We don’t have enough data to learn a really good embedding from scratch","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yceKbtCySo"}],"key":"JjeSM0JZHn"}],"key":"dGKMjDIzDo"}],"key":"eWxqw3nfL4"}],"key":"VZCWxMKtbe"}],"key":"qnKTNN3T9U"}],"key":"ePMOkgbsxu"},{"type":"block","kind":"notebook-code","data":{"slideshow":{"slide_type":"-"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import torch\nimport torch.nn as nn\nimport torch.nn.functional as F\nimport pytorch_lightning as pl\n\nclass IMDBVectorizedDataset(Dataset):\n    def __init__(self, features, labels):\n        self.x = torch.tensor(features, dtype=torch.long) # Needs long\n        self.y = torch.tensor(labels, dtype=torch.float32)\n\n    def __len__(self):\n        return len(self.x)\n\n    def __getitem__(self, idx):\n        return self.x[idx], self.y[idx]\n\nclass IMDBEmbeddingModel(pl.LightningModule):\n    def __init__(self, vocab_size=10000, embedding_length=20, max_length=100):\n        super().__init__()\n        self.embedding = nn.Embedding(vocab_size, embedding_length)\n        self.pooling = nn.AdaptiveAvgPool1d(1)  # GlobalAveragePooling1D equivalent\n        self.fc = nn.Linear(embedding_length, 1)\n\n    def forward(self, x):\n        # x: (batch, max_length)\n        embedded = self.embedding(x)  # (batch, max_length, embedding_length)\n        embedded = embedded.permute(0, 2, 1)  # for AdaptiveAvgPool1d → (batch, embed_dim, seq_len)\n        pooled = self.pooling(embedded).squeeze(-1)  # → (batch, embed_dim)\n        output = torch.sigmoid(self.fc(pooled))  # → (batch, 1)\n        return output.squeeze()\n\n    def training_step(self, batch, batch_idx):\n        x, y = batch\n        y_hat = self(x)\n        loss = F.binary_cross_entropy(y_hat, y)\n        acc = ((y_hat > 0.5) == y.bool()).float().mean()\n        self.log(\"train_loss\", loss, on_step=False, on_epoch=True, prog_bar=True)\n        self.log(\"train_acc\", acc, on_step=False, on_epoch=True, prog_bar=True)\n        return loss\n\n    def validation_step(self, batch, batch_idx):\n        x, y = batch\n        y_hat = self(x)\n        val_loss = F.binary_cross_entropy(y_hat, y)\n        val_acc = ((y_hat > 0.5) == y.bool()).float().mean()\n        self.log(\"val_loss\", val_loss, on_epoch=True, prog_bar=True)\n        self.log(\"val_acc\", val_acc, on_epoch=True, prog_bar=True)\n\n    def configure_optimizers(self):\n        return torch.optim.RMSprop(self.parameters())\n\n# Build padded sequences\nfrom keras.preprocessing.sequence import pad_sequences\n\n# Parameters\nvocab_size = 10000\nmax_length = 100\n\n# Load and preprocess\n(train_data, train_labels), (test_data, test_labels) = imdb.load_data(num_words=vocab_size)\nx_train = pad_sequences(train_data, maxlen=max_length)\nx_test = pad_sequences(test_data, maxlen=max_length)\n\ny_train = train_labels\ny_test = test_labels\n\n# Split training/validation like in Keras example\nx_val, x_partial_train = x_train[:10000], x_train[10000:]\ny_val, y_partial_train = y_train[:10000], y_train[10000:]\n\nfrom torch.utils.data import DataLoader\n\ntrain_dataset = IMDBVectorizedDataset(x_partial_train, y_partial_train)\nval_dataset = IMDBVectorizedDataset(x_val, y_val)\ntest_dataset = IMDBVectorizedDataset(x_test, y_test)\n\ntrain_loader = DataLoader(train_dataset, batch_size=512, shuffle=True)\nval_loader = DataLoader(val_dataset, batch_size=512)\ntest_loader = DataLoader(test_dataset, batch_size=512)\n\nmodel = IMDBEmbeddingModel(vocab_size=vocab_size, embedding_length=20, max_length=max_length)\n\ntrainer = pl.Trainer(\n    max_epochs=15,\n    logger=False,\n    enable_checkpointing=False,\n    callbacks=[LivePlotCallback()]  # optional\n)\n\ntrainer.fit(model, train_dataloaders=train_loader, val_dataloaders=val_loader)","visibility":"show","key":"szuHD7TN4J"},{"type":"outputs","id":"Lun_Z66BybrN0tGOgd6Rl","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"application/pdf":{"content":"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L2JyYWNrZXRsZWZ0IDkzCi9icmFja2V0cmlnaHQgOTUgL3VuZGVyc2NvcmUgOTcgL2EgOTkgL2MgL2QgMTAzIC9nIC9oIC9pIDEwOCAvbCAxMTAgL24gL28KL3AgMTE0IC9yIC9zIC90IC91IC92IDEyMCAveCAveSBdCj4+Ci9XaWR0aHMgMTMgMCBSID4+CmVuZG9iagoxNCAwIG9iago8PCAvVHlwZSAvRm9udERlc2NyaXB0b3IgL0ZvbnROYW1lIC9CTVFRRFYrRGVqYVZ1U2FucyAvRmxhZ3MgMzIKL0ZvbnRCQm94IFsgLTEwMjEgLTQ2MyAxNzk0IDEyMzMgXSAvQXNjZW50IDkyOSAvRGVzY2VudCAtMjM2IC9DYXBIZWlnaHQgMAovWEhlaWdodCAwIC9JdGFsaWNBbmdsZSAwIC9TdGVtViAwIC9NYXhXaWR0aCAxMzQyID4+CmVuZG9iagoxMyAwIG9iagpbIDYwMCA2MDAgNjAwIDYwMCA2MDAgNjAwIDYwMCA2MDAgNjAwIDYwMCA2MDAgNjAwIDYwMCA2MDAgNjAwIDYwMCA2MDAgNjAwCjYwMCA2MDAgNjAwIDYwMCA2MDAgNjAwIDYwMCA2MDAgNjAwIDYwMCA2MDAgNjAwIDYwMCA2MDAgMzE4IDQwMSA0NjAgODM4IDYzNgo5NTAgNzgwIDI3NSAzOTAgMzkwIDUwMCA4MzggMzE4IDM2MSAzMTggMzM3IDYzNiA2MzYgNjM2IDYzNiA2MzYgNjM2IDYzNiA2MzYKNjM2IDYzNiAzMzcgMzM3IDgzOCA4MzggODM4IDUzMSAxMDAwIDY4NCA2ODYgNjk4IDc3MCA2MzIgNTc1IDc3NSA3NTIgMjk1CjI5NSA2NTYgNTU3IDg2MyA3NDggNzg3IDYwMyA3ODcgNjk1IDYzNSA2MTEgNzMyIDY4NCA5ODkgNjg1IDYxMSA2ODUgMzkwIDMzNwozOTAgODM4IDUwMCA1MDAgNjEzIDYzNSA1NTAgNjM1IDYxNSAzNTIgNjM1IDYzNCAyNzggMjc4IDU3OSAyNzggOTc0IDYzNCA2MTIKNjM1IDYzNSA0MTEgNTIxIDM5MiA2MzQgNTkyIDgxOCA1OTIgNTkyIDUyNSA2MzYgMzM3IDYzNiA4MzggNjAwIDYzNiA2MDAgMzE4CjM1MiA1MTggMTAwMCA1MDAgNTAwIDUwMCAxMzQyIDYzNSA0MDAgMTA3MCA2MDAgNjg1IDYwMCA2MDAgMzE4IDMxOCA1MTggNTE4CjU5MCA1MDAgMTAwMCA1MDAgMTAwMCA1MjEgNDAwIDEwMjMgNjAwIDUyNSA2MTEgMzE4IDQwMSA2MzYgNjM2IDYzNiA2MzYgMzM3CjUwMCA1MDAgMTAwMCA0NzEgNjEyIDgzOCAzNjEgMTAwMCA1MDAgNTAwIDgzOCA0MDEgNDAxIDUwMCA2MzYgNjM2IDMxOCA1MDAKNDAxIDQ3MSA2MTIgOTY5IDk2OSA5NjkgNTMxIDY4NCA2ODQgNjg0IDY4NCA2ODQgNjg0IDk3NCA2OTggNjMyIDYzMiA2MzIgNjMyCjI5NSAyOTUgMjk1IDI5NSA3NzUgNzQ4IDc4NyA3ODcgNzg3IDc4NyA3ODcgODM4IDc4NyA3MzIgNzMyIDczMiA3MzIgNjExIDYwNQo2MzAgNjEzIDYxMyA2MTMgNjEzIDYxMyA2MTMgOTgyIDU1MCA2MTUgNjE1IDYxNSA2MTUgMjc4IDI3OCAyNzggMjc4IDYxMiA2MzQKNjEyIDYxMiA2MTIgNjEyIDYxMiA4MzggNjEyIDYzNCA2MzQgNjM0IDYzNCA1OTIgNjM1IDU5MiBdCmVuZG9iagoxNiAwIG9iago8PCAvQSAxNyAwIFIgL0UgMTggMCBSIC9MIDE5IDAgUiAvTSAyMCAwIFIgL1QgMjEgMCBSIC9WIDIyIDAgUiAvYSAyMyAwIFIKL2JyYWNrZXRsZWZ0IDI0IDAgUiAvYnJhY2tldHJpZ2h0IDI1IDAgUiAvYyAyNiAwIFIgL2NvbG9uIDI3IDAgUiAvZCAyOCAwIFIKL2VpZ2h0IDI5IDAgUiAvZml2ZSAzMCAwIFIgL2ZvdXIgMzEgMCBSIC9nIDMyIDAgUiAvaCAzMyAwIFIgL2kgMzQgMCBSCi9sIDM1IDAgUiAvbiAzNiAwIFIgL28gMzcgMCBSIC9vbmUgMzggMCBSIC9wIDM5IDAgUiAvcGVyaW9kIDQwIDAgUgovciA0MSAwIFIgL3MgNDIgMCBSIC9zaXggNDMgMCBSIC9zbGFzaCA0NCAwIFIgL3NwYWNlIDQ1IDAgUiAvdCA0NiAwIFIKL3R3byA0NyAwIFIgL3UgNDggMCBSIC91bmRlcnNjb3JlIDQ5IDAgUiAvdiA1MCAwIFIgL3ggNTEgMCBSIC95IDUyIDAgUgovemVybyA1MyAwIFIgPj4KZW5kb2JqCjMgMCBvYmoKPDwgL0YxIDE1IDAgUiA+PgplbmRvYmoKNCAwIG9iago8PCAvQTEgPDwgL1R5cGUgL0V4dEdTdGF0ZSAvQ0EgMCAvY2EgMSA+PgovQTIgPDwgL1R5cGUgL0V4dEdTdGF0ZSAvQ0EgMSAvY2EgMSA+PgovQTMgPDwgL1R5cGUgL0V4dEdTdGF0ZSAvQ0EgMC44IC9jYSAwLjggPj4gPj4KZW5kb2JqCjUgMCBvYmoKPDwgPj4KZW5kb2JqCjYgMCBvYmoKPDwgPj4KZW5kb2JqCjcgMCBvYmoKPDwgPj4KZW5kb2JqCjIgMCBvYmoKPDwgL1R5cGUgL1BhZ2VzIC9LaWRzIFsgMTEgMCBSIF0gL0NvdW50IDEgPj4KZW5kb2JqCjU0IDAgb2JqCjw8IC9DcmVhdG9yIChNYXRwbG90bGliIHYzLjEwLjAsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcpCi9Qcm9kdWNlciAoTWF0cGxvdGxpYiBwZGYgYmFja2VuZCB2My4xMC4wKQovQ3JlYXRpb25EYXRlIChEOjIwMjUwMzI0MTQxODI3KzAyJzAwJykgPj4KZW5kb2JqCnhyZWYKMCA1NQowMDAwMDAwMDAwIDY1NTM1IGYgCjAwMDAwMDAwMTYgMDAwMDAgbiAKMDAwMDAxMjkwNyAwMDAwMCBuIAowMDAwMDEyNjcwIDAwMDAwIG4gCjAwMDAwMTI3MDIgMDAwMDAgbiAKMDAwMDAxMjg0NCAwMDAwMCBuIAowMDAwMDEyODY1IDAwMDAwIG4gCjAwMDAwMTI4ODYgMDAwMDAgbiAKMDAwMDAwMDA2NSAwMDAwMCBuIAowMDAwMDAwMzQwIDAwMDAwIG4gCjAwMDAwMDIxMjEgMDAwMDAgbiAKMDAwMDAwMDIwOCAwMDAwMCBuIAowMDAwMDAyMTAwIDAwMDAwIG4gCjAwMDAwMTExNTkgMDAwMDAgbiAKMDAwMDAxMDk1MiAwMDAwMCBuIAowMDAwMDEwNDAzIDAwMDAwIG4gCjAwMDAwMTIyMTIgMDAwMDAgbiAKMDAwMDAwMjE0MSAwMDAwMCBuIAowMDAwMDAyMzA0IDAwMDAwIG4gCjAwMDAwMDI0NTcgMDAwMDAgbiAKMDAwMDAwMjU5MCAwMDAwMCBuIAowMDAwMDAyNzUyIDAwMDAwIG4gCjAwMDAwMDI4OTAgMDAwMDAgbiAKMDAwMDAwMzAzNCAwMDAwMCBuIAowMDAwMDAzNDE0IDAwMDAwIG4gCjAwMDAwMDM1NTkgMDAwMDAgbiAKMDAwMDAwMzcwMCAwMDAwMCBuIAowMDAwMDA0MDA1IDAwMDAwIG4gCjAwMDAwMDQxNTAgMDAwMDAgbiAKMDAwMDAwNDQ1NCAwMDAwMCBuIAowMDAwMDA0OTIyIDAwMDAwIG4gCjAwMDAwMDUyNDQgMDAwMDAgbiAKMDAwMDAwNTQxMCAwMDAwMCBuIAowMDAwMDA1ODI0IDAwMDAwIG4gCjAwMDAwMDYwNjEgMDAwMDAgbiAKMDAwMDAwNjIwNSAwMDAwMCBuIAowMDAwMDA2MzI0IDAwMDAwIG4gCjAwMDAwMDY1NjAgMDAwMDAgbiAKMDAwMDAwNjg1MSAwMDAwMCBuIAowMDAwMDA3MDA2IDAwMDAwIG4gCjAwMDAwMDczMTggMDAwMDAgbiAKMDAwMDAwNzQ0MSAwMDAwMCBuIAowMDAwMDA3Njc0IDAwMDAwIG4gCjAwMDAwMDgwODEgMDAwMDAgbiAKMDAwMDAwODQ3NCAwMDAwMCBuIAowMDAwMDA4NjAwIDAwMDAwIG4gCjAwMDAwMDg2OTAgMDAwMDAgbiAKMDAwMDAwODg5NiAwMDAwMCBuIAowMDAwMDA5MjIwIDAwMDAwIG4gCjAwMDAwMDk0NjcgMDAwMDAgbiAKMDAwMDAwOTU5MyAwMDAwMCBuIAowMDAwMDA5NzQwIDAwMDAwIG4gCjAwMDAwMDk5MDEgMDAwMDAgbiAKMDAwMDAxMDExNSAwMDAwMCBuIAowMDAwMDEyOTY3IDAwMDAwIG4gCnRyYWlsZXIKPDwgL1NpemUgNTUgL1Jvb3QgMSAwIFIgL0luZm8gNTQgMCBSID4+CnN0YXJ0eHJlZgoxMzEyNgolJUVPRgo=","content_type":"application/pdf"},"image/png":{"content_type":"image/png","hash":"6d362c71f3d6995287c7baf5506bbbc2","path":"/6d362c71f3d6995287c7baf5506bbbc2.png"},"text/plain":{"content":"<Figure size 3000x1200 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"qX04b8ctHe"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"`Trainer.fit` stopped: `max_epochs=15` reached.\n"},"children":[],"key":"rOdtgrcauu"}],"visibility":"show","key":"nqJ3xWD6GD"}],"visibility":"show","key":"N4c8Gqzn7L"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Pre-trained embeddings","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"C1cfBjKQwn"}],"identifier":"pre-trained-embeddings","label":"Pre-trained embeddings","html_id":"pre-trained-embeddings","implicit":true,"key":"TLL4shJatI"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"With more data we can build better embeddings, but we also need more labels","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"sXvtoSNRKy"}],"key":"mWuWH0ANGK"}],"key":"WDzWAX2CcH"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Solution: transfer learning! Learn embedding on auxiliary task that doesn’t require labels","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vpkJaG0Fpx"}],"key":"b0xevBU8LZ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"E.g. given a word, predict the surrounding words.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"kaLdL4d0m0"}],"key":"Vj2pi23vah"}],"key":"t4RggsCW5r"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Also called self-supervised learning. Supervision is provided by data itself","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LcMt7h9g31"}],"key":"t9kyKw681k"}],"key":"Ja6ovGVA2f"}],"key":"B6Ox4sYKyN"}],"key":"ob7DjPE93V"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Freeze embedding weights to produce simple word embeddings, or finetune to a new tasks","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"pYegdE5q6q"}],"key":"Z6X3LaFjj7"}],"key":"ATlrQuikYV"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Most common approaches:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Dohc6BhL4A"}],"key":"tCuP3UxblG"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":8,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Word2Vec: Learn neural embedding for a word based on surrounding words","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"fDrAEfr9GT"}],"key":"FYpYzKHv90"}],"key":"Ln538HBN4W"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"FastText: learns embedding for character n-grams","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"CgD2XueIRT"}],"key":"qP23Y0fXY1"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Can also produce embeddings for new, unseen words","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"KgcJr1OL5s"}],"key":"ooBEl1ycvc"}],"key":"DWPTxModib"}],"key":"bV2HbhYIvk"}],"key":"qTj2esQF21"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"GloVe (Global Vector): Count co-occurrences of words in a matrix","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"WAk4d7UrsM"}],"key":"ESo8oL5A5Q"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Use a low-rank approximation to get a latent vector representation","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"L5V70vLgGz"}],"key":"WTZ4LUIZZX"}],"key":"eD6ct5FoeF"}],"key":"YXXyQHfkcH"}],"key":"IK6MdhYLNX"}],"key":"qafZH0iDKn"}],"key":"AdPcw7oiIx"}],"key":"N0tsqrOivK"}],"key":"S5AZBStEGK"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Word2Vec","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SmW1iTzk8R"}],"identifier":"word2vec","label":"Word2Vec","html_id":"word2vec","implicit":true,"key":"v3KnW0JPF1"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Move a window over text to get ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"yBcxFUGmUX"},{"type":"inlineMath","value":"C","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi></mrow><annotation encoding=\"application/x-tex\">C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span></span></span></span>","key":"XkvQHHPiCy"},{"type":"text","value":" context words (","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"dtsQILpyMP"},{"type":"inlineMath","value":"V","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span>","key":"CHWHpyrNpK"},{"type":"text","value":"-dim one-hot encoded)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Pc7ms3RGRJ"}],"key":"n40NUYLNdp"}],"key":"UqcpFh5zyx"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Add embedding layer with ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UlZGQFoCwV"},{"type":"inlineMath","value":"N","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"cH1FMFjdFp"},{"type":"text","value":" linear nodes, global average pooling, and softmax layer(s)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jfw2vvkAWg"}],"key":"ls0K1PQC4n"}],"key":"UqmVRrBLMc"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"CBOW: predict word given context, use weights of last layer ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"jYW8hUXZox"},{"type":"inlineMath","value":"W^{'}_{NxV}","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>W</mi><mrow><mi>N</mi><mi>x</mi><mi>V</mi></mrow><msup><mrow></mrow><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></msubsup></mrow><annotation encoding=\"application/x-tex\">W^{&#x27;}_{NxV}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2178em;vertical-align:-0.2753em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9425em;\"><span style=\"top:-2.4247em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.22222em;\">V</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8278em;\"><span style=\"top:-2.931em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2753em;\"><span></span></span></span></span></span></span></span></span></span>","key":"IRs2ngWynd"},{"type":"text","value":" as embedding","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"GZNcmEHIcY"}],"key":"eAZvz9ZGdj"}],"key":"Wdlwgr0QJa"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Skip-Gram: predict context given word, use weights of first layer ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"TG1NamWkLi"},{"type":"inlineMath","value":"W^{T}_{VxN}","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>W</mi><mrow><mi>V</mi><mi>x</mi><mi>N</mi></mrow><mi>T</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">W^{T}_{VxN}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1167em;vertical-align:-0.2753em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.4247em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2753em;\"><span></span></span></span></span></span></span></span></span></span>","key":"u8owHFHVvo"},{"type":"text","value":" as embedding","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"NDs0YtzKj0"}],"key":"Bh9tekUY12"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Scales to larger text corpora, learns relationships between words better","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Nrn8drd3ra"}],"key":"u2eAI53Egn"}],"key":"MHzr39U2Hb"}],"key":"TH4EAHrsQ5"}],"key":"lMQP07vYMn"}],"key":"flzH1kKPQC"},{"type":"image","style":{"width":"55%","marginLeft":"auto","marginRight":"auto"},"url":"/a952376945ed06a6272fa1aaaaba8944.png","alt":"ml","key":"WKhzTYvYwQ","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/09_word_embeddings_3.png","urlOptimized":"/a952376945ed06a6272fa1aaaaba8944.webp"}],"key":"fEHbS1h9Zv"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Word2Vec properties","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WOEB56j4nP"}],"identifier":"word2vec-properties","label":"Word2Vec properties","html_id":"word2vec-properties","implicit":true,"key":"WK9hTpU4TT"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Word2Vec happens to learn ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"QjFzRhhied"},{"type":"link","url":"https://www.aclweb.org/anthology/N13-1090/","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"interesting relationships","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"JuvH1O78jA"}],"urlSource":"https://www.aclweb.org/anthology/N13-1090/","key":"wlj69l56qj"},{"type":"text","value":" between words","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"oncneoeayP"}],"key":"Yn3klv0Pez"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Simple vector arithmetic can map words to plurals, conjugations, gender analogies,...","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"x0npOUeSoX"}],"key":"SB3vYk4c0L"}],"key":"ewU2VeDeHD"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"e.g. Gender relationships: ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"MPt28AylE5"},{"type":"inlineMath","value":"vec_{king} - vec_{man} + vec_{woman} \\sim vec_{queen}","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi><mi>e</mi><msub><mi>c</mi><mrow><mi>k</mi><mi>i</mi><mi>n</mi><mi>g</mi></mrow></msub><mo>−</mo><mi>v</mi><mi>e</mi><msub><mi>c</mi><mrow><mi>m</mi><mi>a</mi><mi>n</mi></mrow></msub><mo>+</mo><mi>v</mi><mi>e</mi><msub><mi>c</mi><mrow><mi>w</mi><mi>o</mi><mi>m</mi><mi>a</mi><mi>n</mi></mrow></msub><mo>∼</mo><mi>v</mi><mi>e</mi><msub><mi>c</mi><mrow><mi>q</mi><mi>u</mi><mi>e</mi><mi>e</mi><mi>n</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">vec_{king} - vec_{man} + vec_{woman} \\sim vec_{queen}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8694em;vertical-align:-0.2861em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">e</span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">kin</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">g</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">e</span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">man</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">e</span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">man</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">e</span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">q</span><span class=\"mord mathnormal mtight\">u</span><span class=\"mord mathnormal mtight\">ee</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"qmrJ1SGamR"}],"key":"Uxwmg0r3pW"}],"key":"w8Oka6ISYY"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"PCA applied to embeddings shows Country - Capital relationship","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"zgeb3GDo4s"}],"key":"Hj9iwHurPz"}],"key":"L8aDnVy9k2"}],"key":"Glku4wpluj"}],"key":"zZnDXkFD9B"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Careful: embeddings can capture ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"klrAQL1EYm"},{"type":"link","url":"https://arxiv.org/abs/1607.06520","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"gender and other biases","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"cSBEucxoSm"}],"urlSource":"https://arxiv.org/abs/1607.06520","key":"dqDPl3XDEU"},{"type":"text","value":" present in the data.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"v9Ls8EZx9B"}],"key":"fQRoDMUzbX"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Important unsolved problem!","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"vmfVoxfhvl"}],"key":"kCp6szS1oi"}],"key":"sPKLfuvBGY"}],"key":"oz09SkE8D3"}],"key":"xuCKSVVnBX"}],"key":"wWaYNqp6bN"},{"type":"image","style":{"width":"80%","marginLeft":"auto","marginRight":"auto"},"url":"/cdf9f0b699de20a6a234d59c2a6b836d.png","alt":"ml","key":"onaNClRaaV","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/word2vec.png","urlOptimized":"/cdf9f0b699de20a6a234d59c2a6b836d.webp"}],"key":"QIqfPkXIlK"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Doc2Vec","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"z1F2F7sgAI"}],"identifier":"doc2vec","label":"Doc2Vec","html_id":"doc2vec","implicit":true,"key":"EkkxeFnr6o"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Alternative way to combine word embeddings (instead of global pooling)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"rX4fUwaFRj"}],"key":"CW6e5tyWRs"}],"key":"lW3hkmvA3R"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Adds a paragraph (or document) embedding: learns how paragraphs (or docs) relate to each other","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bBDLnbBggd"}],"key":"aviGCEepGo"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Captures document-level semantics: context and meaning of entire document","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"vLZhMiNwMP"}],"key":"sMgTLW7hof"}],"key":"Yr44xEuElW"}],"key":"C9UH0nqVeK"}],"key":"B0GD7SRAw9"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Can be used to determine semantic similarity between documents.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Ctwu0s2qYv"}],"key":"AMjyitlaQL"}],"key":"bwmyVSrgug"}],"key":"JjhZztytM7"},{"type":"image","style":{"width":"50%","marginLeft":"auto","marginRight":"auto"},"url":"/c79818e04f92b2e3718e2a7c52f8f3aa.png","alt":"ml","key":"EkMzTc84Tw","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/doc2vec.png","urlOptimized":"/c79818e04f92b2e3718e2a7c52f8f3aa.webp"}],"key":"HfSiUWCLea"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"FastText","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Hswy4Kv2V8"}],"identifier":"fasttext","label":"FastText","html_id":"fasttext","implicit":true,"key":"R9or9Tt8jO"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Limitations of Word2Vec:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"GdTCkjpYVp"}],"key":"uMqUslbkRY"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Cannot represent new (out-of-vocabulary) words","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aKAULABKMM"}],"key":"WYKTo7BvQH"}],"key":"Ki0j4BDms9"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Similar words are learned independently: less efficient (no parameter sharing)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"iLLPSQBQnB"}],"key":"Hmy6IysTIg"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"E.g. ‘meet’ and ‘meeting’","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Q2gerWbCfQ"}],"key":"u4RxFcbP0d"}],"key":"yd5Boj1vOQ"}],"key":"ZHcu7OfDlt"}],"key":"bO7Y0K9ldP"}],"key":"VWP1waTzDH"}],"key":"i4luO27ysV"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"FastText: same model, but uses ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"mPgMkeZVbU"},{"type":"emphasis","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"character n-grams","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Q7WRwC6F0p"}],"key":"B5erIDECFc"}],"key":"VTjyg64w7Q"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Words are represented by all character n-grams of length 3 to 6","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"n5hyXhadvK"}],"key":"jbfiVKPbSR"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"“football” 3-grams: <fo, foo, oot, otb, tba, bal, all, ll>","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"mPiXKm2NCg"}],"key":"QgylXA2MeS"}],"key":"UaSJrcFkaM"}],"key":"k6x4l8zQNu"}],"key":"uiHg8AYRcW"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Because there are so many n-grams, they are hashed (dimensionality = bin size)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ROcTb6kkPY"}],"key":"UpoCPzsZbs"}],"key":"NoEx8lnFVM"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Representation of word “football” is sum of its n-gram embeddings","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"zwOgKq6ZbR"}],"key":"CTFVdzIpZb"}],"key":"IeaesJ3BYk"}],"key":"sY8p8Q7Com"}],"key":"ZytjOY3XdU"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Negative sampling: also trains on random negative examples (out-of-context words)","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"N2sy3Ayj17"}],"key":"psGvrSyMeX"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Weights are updated so that they are ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"quVzVZuTZd"},{"type":"emphasis","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"less","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"f5nzBokUEa"}],"key":"PYm32ogD2U"},{"type":"text","value":" likely to be predicted","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"tOdhPioW0H"}],"key":"sPagXzP3hz"}],"key":"XiesGmXVGE"}],"key":"av74s7jq5d"}],"key":"wSSPaiaYiI"}],"key":"kdZr8d3CZT"}],"key":"uY8zoDAKSB"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Global Vector model (GloVe)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BLGioahSly"}],"identifier":"global-vector-model-glove","label":"Global Vector model (GloVe)","html_id":"global-vector-model-glove","implicit":true,"key":"b2kl3cAuWO"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Builds a co-occurence matrix ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"nkuLiozEs0"},{"type":"inlineMath","value":"\\mathbf{X}","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">X</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{X}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">X</span></span></span></span>","key":"be8Zz8pb8z"},{"type":"text","value":": counts how often 2 words occur in the same context","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"on52l27OhG"}],"key":"aZ3a8atgk4"}],"key":"dMn3iXNB9q"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Learns a k-dimensional embedding ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gARdAHgu3h"},{"type":"inlineMath","value":"W","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi></mrow><annotation encoding=\"application/x-tex\">W</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span></span>","key":"zi44hAwPbX"},{"type":"text","value":" through matrix factorization with rank k","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xcHvQqdQcB"}],"key":"PvVQGB90gW"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Actually learns 2 embeddings ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"wlcVq9ng5p"},{"type":"inlineMath","value":"W","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi></mrow><annotation encoding=\"application/x-tex\">W</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span></span>","key":"nRAizRq6RS"},{"type":"text","value":" and ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ESR2AwBUyE"},{"type":"inlineMath","value":"W'","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>W</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">W&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"VU5fh55icD"},{"type":"text","value":" (differ in random initialization)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Bs8J3TWjr9"}],"key":"GDfZOxdBxo"}],"key":"AEAnoNKIup"}],"key":"iR6Pee3QXn"}],"key":"loRE6TDUzx"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Minimizes loss ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"bnkzzu7orz"},{"type":"inlineMath","value":"\\mathcal{L}","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathcal{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathcal\">L</span></span></span></span>","key":"RUNV9tDD7H"},{"type":"text","value":", where ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"c3dhvnyJH4"},{"type":"inlineMath","value":"b_i","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">b_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"cpfptbpruP"},{"type":"text","value":" and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Qa2i33a1hn"},{"type":"inlineMath","value":"b'_i","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>b</mi><mi>i</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msubsup></mrow><annotation encoding=\"application/x-tex\">b&#x27;_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0106em;vertical-align:-0.2587em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-2.4413em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2587em;\"><span></span></span></span></span></span></span></span></span></span>","key":"aA9NmZWE7s"},{"type":"text","value":" are bias terms and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"aqQn3KI7Pf"},{"type":"inlineMath","value":"f","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"ag2zn6R8Zw"},{"type":"text","value":" is a weighting function","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"q10ufp55ek"}],"key":"trhDqcxKh8"}],"key":"GeWlFAV4Fs"}],"key":"A1yZAAwy7j"},{"type":"math","value":"\\mathcal{L} = \\sum_{i,j=1}^{V} f(\\mathbf{X}_{ij}) (\\mathbf{w_i} \\mathbf{w'_j} + b_i + b'_j - log(\\mathbf{X}_{ij}))^2","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"script\">L</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>V</mi></munderover><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">X</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">w</mi><mi mathvariant=\"bold\">i</mi></msub><msubsup><mi mathvariant=\"bold\">w</mi><mi mathvariant=\"bold\">j</mi><mo mathvariant=\"bold\" lspace=\"0em\" rspace=\"0em\">′</mo></msubsup><mo>+</mo><msub><mi>b</mi><mi>i</mi></msub><mo>+</mo><msubsup><mi>b</mi><mi>j</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msubsup><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">X</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy=\"false\">)</mo><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\mathcal{L} = \\sum_{i,j=1}^{V} f(\\mathbf{X}_{ij}) (\\mathbf{w_i} \\mathbf{w&#x27;_j} + b_i + b&#x27;_j - log(\\mathbf{X}_{ij}))^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathcal\">L</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.2421em;vertical-align:-1.4138em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.22222em;\">V</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4138em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.016em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathbf mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-2.453em;margin-left:-0.016em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathbf mtight\">j</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathbf mtight\">′</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3831em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.185em;vertical-align:-0.3831em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3831em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1502em;vertical-align:-0.2861em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"3","key":"qkkHVw5O72"},{"type":"image","style":{"width":"80%","marginLeft":"auto","marginRight":"auto"},"url":"/02b5760bf4ec4d100655a6243ed7feed.png","alt":"ml","key":"M7Nd0YpgGd","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/glove3.png","urlOptimized":"/02b5760bf4ec4d100655a6243ed7feed.webp"}],"key":"iHRpvzkIQc"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s try this","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iBopNhqCzh"}],"key":"AlJKlJpUc1"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Download the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VvJQecHdaH"},{"type":"link","url":"https://nlp.stanford.edu/projects/glove","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"GloVe embeddings trained on Wikipedia","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zXMOghuS0u"}],"urlSource":"https://nlp.stanford.edu/projects/glove","key":"Ue6E1zereN"}],"key":"gbn8ZKkWSY"}],"key":"IYxw3BeeEP"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We can now get embeddings for 400,000 English words","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"RFDpCF3yFK"}],"key":"arEDHccCJZ"}],"key":"nrQ8Vk4sbY"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"E.g. ‘queen’ (50 first values of 300-dim embedding)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"AuxTDDdSgp"}],"key":"FJHby35a3J"}],"key":"YIts9W5nzd"}],"key":"TzuXFHusuX"}],"key":"DmjCytOc6d"},{"type":"block","kind":"notebook-code","data":{"slideshow":{"slide_type":"skip"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# To find the original data files, see\n# http://nlp.stanford.edu/data/glove.6B.zip\n# http://www.cs.cmu.edu/afs/cs.cmu.edu/project/theo-20/www/data/news20.tar.gz\n\n# Build an index so that we can later easily compose the embedding matrix\ndata_dir = '../data'\nembeddings_index = {}\nwith open(os.path.join(data_dir, 'glove.txt')) as f:\n    for line in f:\n        word, coefs = line.split(maxsplit=1)\n        coefs = np.fromstring(coefs, \"f\", sep=\" \")\n        embeddings_index[word] = coefs\n\nprint('Found %s word vectors.' % len(embeddings_index))","key":"xZh5aqHBgW"},{"type":"outputs","id":"Y5Ygl2apLRWPn2APluPrH","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Found 400000 word vectors.\n"},"children":[],"key":"FKERNMHjVS"}],"key":"ziqilywbGH"}],"key":"kVULzyOVtd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"embeddings_index['queen'][0:50]","key":"uRZnR6vB1f"},{"type":"outputs","id":"EPIN6CQ7G3BhXSdq6OS3A","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":80,"metadata":{},"data":{"text/plain":{"content":"array([-0.222,  0.065, -0.086,  0.513,  0.325, -0.129,  0.083,  0.092,\n       -0.309, -0.941, -0.089, -0.108,  0.211,  0.701,  0.268, -0.04 ,\n        0.174, -0.308, -0.052, -0.175, -0.841,  0.192, -0.138,  0.385,\n        0.272, -0.174, -0.466, -0.025,  0.097,  0.301,  0.18 , -0.069,\n       -0.205,  0.357, -0.283,  0.281, -0.012,  0.107, -0.244, -0.179,\n       -0.132, -0.17 , -0.594,  0.957,  0.204, -0.043,  0.607, -0.069,\n        0.523, -0.548], dtype=float32)","content_type":"text/plain"}}},"children":[],"key":"Ir9nDV9jYW"}],"key":"gimLUHy6X5"}],"key":"XInmZrc46t"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Same simple model, but with frozen GloVe embeddings: much worse!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ykZklD35uo"}],"key":"XYPteJTZZn"}],"key":"UuH8mCZWrW"},{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Linear layer is too simple. We need something more complex -> transformers :)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"XlAbGNnaO4"}],"key":"suVEW0T4Wn"}],"key":"KIlb4by8Qv"}],"key":"AoIfvgMvit"},{"type":"code","lang":"python","value":"embedding_tensor = torch.tensor(embedding_matrix, dtype=torch.float32)\nself.model = nn.Sequential(\n    nn.Embedding.from_pretrained(embedding_tensor, freeze=True),\n    nn.AdaptiveAvgPool1d(1),\n    nn.Linear(embedding_tensor.shape[1], 1))","position":{"start":{"line":4,"column":1},"end":{"line":10,"column":1}},"key":"iqgvPRozS9"}],"key":"j16rv6qVXe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Load GloVe (assumes file is like 'glove.6B.300d.txt')\nembedding_dim = 300\nglove_path = \"../data/glove.txt\"\n\nembeddings_index = {}\nwith open(glove_path, encoding='utf-8') as f:\n    for line in f:\n        values = line.strip().split()\n        word = values[0]\n        vector = np.asarray(values[1:], dtype='float32')\n        embeddings_index[word] = vector\n        \nvocab_size = 10000\nembedding_matrix = np.zeros((vocab_size, embedding_dim))\nmissing = 0\n\nfor word, i in word_index.items():\n    if i < vocab_size:\n        embedding_vector = embeddings_index.get(word)\n        if embedding_vector is not None:\n            embedding_matrix[i] = embedding_vector\n        else:\n            missing += 1\n\nprint(f\"{missing} words not found in GloVe.\")\n\nclass Permute(nn.Module):\n    def __init__(self, *dims):\n        super().__init__()\n        self.dims = dims\n\n    def forward(self, x):\n        return x.permute(*self.dims)\n\nclass Squeeze(nn.Module):\n    def __init__(self, dim=-1):\n        super().__init__()\n        self.dim = dim\n\n    def forward(self, x):\n        return x.squeeze(self.dim)\n\nclass FrozenGloVeModel(pl.LightningModule):\n    def __init__(self, embedding_matrix, max_length=100):\n        super().__init__()\n        embedding_tensor = torch.tensor(embedding_matrix, dtype=torch.float32)\n\n        self.model = nn.Sequential(\n            nn.Embedding.from_pretrained(embedding_tensor, freeze=True),\n            Permute(0, 2, 1),\n            nn.AdaptiveAvgPool1d(1),\n            Squeeze(dim=-1),\n            nn.Linear(embedding_tensor.shape[1], 1),\n            nn.Sigmoid()\n        )\n\n    def forward(self, x):\n        return self.model(x).squeeze()\n\n    def training_step(self, batch, batch_idx):\n        x, y = batch\n        y_hat = self(x)\n        loss = F.binary_cross_entropy(y_hat, y)\n        acc = ((y_hat > 0.5) == y.bool()).float().mean()\n        self.log(\"train_loss\", loss, on_step=False, on_epoch=True)\n        self.log(\"train_acc\", acc, on_step=False, on_epoch=True)\n        return loss\n\n    def validation_step(self, batch, batch_idx):\n        x, y = batch\n        y_hat = self(x)\n        val_loss = F.binary_cross_entropy(y_hat, y)\n        val_acc = ((y_hat > 0.5) == y.bool()).float().mean()\n        self.log(\"val_loss\", val_loss, on_epoch=True)\n        self.log(\"val_acc\", val_acc, on_epoch=True)\n\n    def configure_optimizers(self):\n        return torch.optim.Adam(self.parameters())\n    \nmodel = FrozenGloVeModel(embedding_matrix=embedding_matrix, max_length=100)\n\ntrainer = pl.Trainer(\n    max_epochs=30,\n    logger=False,\n    enable_checkpointing=False,\n    callbacks=[LivePlotCallback()]  # optional\n)\n\ntrainer.fit(model, train_dataloaders=train_loader, val_dataloaders=val_loader)\n        \n        \n        \n        \n        \n        ","key":"Bily8fkb2H"},{"type":"outputs","id":"BaKN7MoOW4Q0u5i6U9FGR","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"application/pdf":{"content":"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OTMKL2JyYWNrZXRyaWdodCA5NSAvdW5kZXJzY29yZSA5NyAvYSA5OSAvYyAvZCAxMDMgL2cgL2ggL2kgMTA4IC9sIDExMCAvbiAvbwovcCAxMTQgL3IgL3MgL3QgL3UgL3YgMTIwIC94IC95IF0KPj4KL1dpZHRocyAxMyAwIFIgPj4KZW5kb2JqCjE0IDAgb2JqCjw8IC9UeXBlIC9Gb250RGVzY3JpcHRvciAvRm9udE5hbWUgL0JNUVFEVitEZWphVnVTYW5zIC9GbGFncyAzMgovRm9udEJCb3ggWyAtMTAyMSAtNDYzIDE3OTQgMTIzMyBdIC9Bc2NlbnQgOTI5IC9EZXNjZW50IC0yMzYgL0NhcEhlaWdodCAwCi9YSGVpZ2h0IDAgL0l0YWxpY0FuZ2xlIDAgL1N0ZW1WIDAgL01heFdpZHRoIDEzNDIgPj4KZW5kb2JqCjEzIDAgb2JqClsgNjAwIDYwMCA2MDAgNjAwIDYwMCA2MDAgNjAwIDYwMCA2MDAgNjAwIDYwMCA2MDAgNjAwIDYwMCA2MDAgNjAwIDYwMCA2MDAKNjAwIDYwMCA2MDAgNjAwIDYwMCA2MDAgNjAwIDYwMCA2MDAgNjAwIDYwMCA2MDAgNjAwIDYwMCAzMTggNDAxIDQ2MCA4MzggNjM2Cjk1MCA3ODAgMjc1IDM5MCAzOTAgNTAwIDgzOCAzMTggMzYxIDMxOCAzMzcgNjM2IDYzNiA2MzYgNjM2IDYzNiA2MzYgNjM2IDYzNgo2MzYgNjM2IDMzNyAzMzcgODM4IDgzOCA4MzggNTMxIDEwMDAgNjg0IDY4NiA2OTggNzcwIDYzMiA1NzUgNzc1IDc1MiAyOTUKMjk1IDY1NiA1NTcgODYzIDc0OCA3ODcgNjAzIDc4NyA2OTUgNjM1IDYxMSA3MzIgNjg0IDk4OSA2ODUgNjExIDY4NSAzOTAgMzM3CjM5MCA4MzggNTAwIDUwMCA2MTMgNjM1IDU1MCA2MzUgNjE1IDM1MiA2MzUgNjM0IDI3OCAyNzggNTc5IDI3OCA5NzQgNjM0IDYxMgo2MzUgNjM1IDQxMSA1MjEgMzkyIDYzNCA1OTIgODE4IDU5MiA1OTIgNTI1IDYzNiAzMzcgNjM2IDgzOCA2MDAgNjM2IDYwMCAzMTgKMzUyIDUxOCAxMDAwIDUwMCA1MDAgNTAwIDEzNDIgNjM1IDQwMCAxMDcwIDYwMCA2ODUgNjAwIDYwMCAzMTggMzE4IDUxOCA1MTgKNTkwIDUwMCAxMDAwIDUwMCAxMDAwIDUyMSA0MDAgMTAyMyA2MDAgNTI1IDYxMSAzMTggNDAxIDYzNiA2MzYgNjM2IDYzNiAzMzcKNTAwIDUwMCAxMDAwIDQ3MSA2MTIgODM4IDM2MSAxMDAwIDUwMCA1MDAgODM4IDQwMSA0MDEgNTAwIDYzNiA2MzYgMzE4IDUwMAo0MDEgNDcxIDYxMiA5NjkgOTY5IDk2OSA1MzEgNjg0IDY4NCA2ODQgNjg0IDY4NCA2ODQgOTc0IDY5OCA2MzIgNjMyIDYzMiA2MzIKMjk1IDI5NSAyOTUgMjk1IDc3NSA3NDggNzg3IDc4NyA3ODcgNzg3IDc4NyA4MzggNzg3IDczMiA3MzIgNzMyIDczMiA2MTEgNjA1CjYzMCA2MTMgNjEzIDYxMyA2MTMgNjEzIDYxMyA5ODIgNTUwIDYxNSA2MTUgNjE1IDYxNSAyNzggMjc4IDI3OCAyNzggNjEyIDYzNAo2MTIgNjEyIDYxMiA2MTIgNjEyIDgzOCA2MTIgNjM0IDYzNCA2MzQgNjM0IDU5MiA2MzUgNTkyIF0KZW5kb2JqCjE2IDAgb2JqCjw8IC9BIDE3IDAgUiAvRSAxOCAwIFIgL0wgMTkgMCBSIC9NIDIwIDAgUiAvVCAyMSAwIFIgL1YgMjIgMCBSIC9hIDIzIDAgUgovYnJhY2tldGxlZnQgMjQgMCBSIC9icmFja2V0cmlnaHQgMjUgMCBSIC9jIDI2IDAgUiAvY29sb24gMjcgMCBSIC9kIDI4IDAgUgovZml2ZSAyOSAwIFIgL2cgMzAgMCBSIC9oIDMxIDAgUiAvaSAzMiAwIFIgL2wgMzMgMCBSIC9uIDM0IDAgUiAvbmluZSAzNSAwIFIKL28gMzYgMCBSIC9vbmUgMzcgMCBSIC9wIDM4IDAgUiAvcGVyaW9kIDM5IDAgUiAvciA0MCAwIFIgL3MgNDEgMCBSCi9zZXZlbiA0MiAwIFIgL3NpeCA0MyAwIFIgL3NsYXNoIDQ0IDAgUiAvc3BhY2UgNDUgMCBSIC90IDQ2IDAgUgovdGhyZWUgNDcgMCBSIC90d28gNDggMCBSIC91IDQ5IDAgUiAvdW5kZXJzY29yZSA1MCAwIFIgL3YgNTEgMCBSIC94IDUyIDAgUgoveSA1MyAwIFIgL3plcm8gNTQgMCBSID4+CmVuZG9iagozIDAgb2JqCjw8IC9GMSAxNSAwIFIgPj4KZW5kb2JqCjQgMCBvYmoKPDwgL0ExIDw8IC9UeXBlIC9FeHRHU3RhdGUgL0NBIDAgL2NhIDEgPj4KL0EyIDw8IC9UeXBlIC9FeHRHU3RhdGUgL0NBIDEgL2NhIDEgPj4KL0EzIDw8IC9UeXBlIC9FeHRHU3RhdGUgL0NBIDAuOCAvY2EgMC44ID4+ID4+CmVuZG9iago1IDAgb2JqCjw8ID4+CmVuZG9iago2IDAgb2JqCjw8ID4+CmVuZG9iago3IDAgb2JqCjw8ID4+CmVuZG9iagoyIDAgb2JqCjw8IC9UeXBlIC9QYWdlcyAvS2lkcyBbIDExIDAgUiBdIC9Db3VudCAxID4+CmVuZG9iago1NSAwIG9iago8PCAvQ3JlYXRvciAoTWF0cGxvdGxpYiB2My4xMC4wLCBodHRwczovL21hdHBsb3RsaWIub3JnKQovUHJvZHVjZXIgKE1hdHBsb3RsaWIgcGRmIGJhY2tlbmQgdjMuMTAuMCkKL0NyZWF0aW9uRGF0ZSAoRDoyMDI1MDMyNDE0NDI0NCswMicwMCcpID4+CmVuZG9iagp4cmVmCjAgNTYKMDAwMDAwMDAwMCA2NTUzNSBmIAowMDAwMDAwMDE2IDAwMDAwIG4gCjAwMDAwMTM4MDggMDAwMDAgbiAKMDAwMDAxMzU3MSAwMDAwMCBuIAowMDAwMDEzNjAzIDAwMDAwIG4gCjAwMDAwMTM3NDUgMDAwMDAgbiAKMDAwMDAxMzc2NiAwMDAwMCBuIAowMDAwMDEzNzg3IDAwMDAwIG4gCjAwMDAwMDAwNjUgMDAwMDAgbiAKMDAwMDAwMDMzNiAwMDAwMCBuIAowMDAwMDAyNjg4IDAwMDAwIG4gCjAwMDAwMDAyMDggMDAwMDAgbiAKMDAwMDAwMjY2NyAwMDAwMCBuIAowMDAwMDEyMDQ2IDAwMDAwIG4gCjAwMDAwMTE4MzkgMDAwMDAgbiAKMDAwMDAxMTI4NiAwMDAwMCBuIAowMDAwMDEzMDk5IDAwMDAwIG4gCjAwMDAwMDI3MDggMDAwMDAgbiAKMDAwMDAwMjg3MSAwMDAwMCBuIAowMDAwMDAzMDI0IDAwMDAwIG4gCjAwMDAwMDMxNTcgMDAwMDAgbiAKMDAwMDAwMzMxOSAwMDAwMCBuIAowMDAwMDAzNDU3IDAwMDAwIG4gCjAwMDAwMDM2MDEgMDAwMDAgbiAKMDAwMDAwMzk4MSAwMDAwMCBuIAowMDAwMDA0MTI2IDAwMDAwIG4gCjAwMDAwMDQyNjcgMDAwMDAgbiAKMDAwMDAwNDU3MiAwMDAwMCBuIAowMDAwMDA0NzE3IDAwMDAwIG4gCjAwMDAwMDUwMjEgMDAwMDAgbiAKMDAwMDAwNTM0MyAwMDAwMCBuIAowMDAwMDA1NzU3IDAwMDAwIG4gCjAwMDAwMDU5OTQgMDAwMDAgbiAKMDAwMDAwNjEzOCAwMDAwMCBuIAowMDAwMDA2MjU3IDAwMDAwIG4gCjAwMDAwMDY0OTMgMDAwMDAgbiAKMDAwMDAwNjg4OCAwMDAwMCBuIAowMDAwMDA3MTc5IDAwMDAwIG4gCjAwMDAwMDczMzQgMDAwMDAgbiAKMDAwMDAwNzY0NiAwMDAwMCBuIAowMDAwMDA3NzY5IDAwMDAwIG4gCjAwMDAwMDgwMDIgMDAwMDAgbiAKMDAwMDAwODQwOSAwMDAwMCBuIAowMDAwMDA4NTUxIDAwMDAwIG4gCjAwMDAwMDg5NDQgMDAwMDAgbiAKMDAwMDAwOTA3MCAwMDAwMCBuIAowMDAwMDA5MTYwIDAwMDAwIG4gCjAwMDAwMDkzNjYgMDAwMDAgbiAKMDAwMDAwOTc3OSAwMDAwMCBuIAowMDAwMDEwMTAzIDAwMDAwIG4gCjAwMDAwMTAzNTAgMDAwMDAgbiAKMDAwMDAxMDQ3NiAwMDAwMCBuIAowMDAwMDEwNjIzIDAwMDAwIG4gCjAwMDAwMTA3ODQgMDAwMDAgbiAKMDAwMDAxMDk5OCAwMDAwMCBuIAowMDAwMDEzODY4IDAwMDAwIG4gCnRyYWlsZXIKPDwgL1NpemUgNTYgL1Jvb3QgMSAwIFIgL0luZm8gNTUgMCBSID4+CnN0YXJ0eHJlZgoxNDAyNwolJUVPRgo=","content_type":"application/pdf"},"image/png":{"content_type":"image/png","hash":"0281b1834f2207579187851c8e031bda","path":"/0281b1834f2207579187851c8e031bda.png"},"text/plain":{"content":"<Figure size 3000x1200 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"A8UfHF6Bg5"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"`Trainer.fit` stopped: `max_epochs=30` reached.\n"},"children":[],"key":"eSmLUpJY9l"}],"key":"vuOe8LPTXF"}],"key":"NqXyZUPlgK"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Sequence-to-sequence (seq2seq) models","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P3m650uXBx"}],"identifier":"sequence-to-sequence-seq2seq-models","label":"Sequence-to-sequence (seq2seq) models","html_id":"sequence-to-sequence-seq2seq-models","implicit":true,"key":"NpeZRAkzi6"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Global average pooling or flattening destroys the word order","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"UG8JwLKXof"}],"key":"g9PDFhXLNs"}],"key":"tYVu23TsvN"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We need to model sequences explictly, e.g.:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Dr4ZaF5F3m"}],"key":"pvrMnl7J3V"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"1D convolutional models: run a 1D filter over the input data","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"kM5e2iQN2n"}],"key":"VJqR3TrtAE"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Fast, but can only look at small part of the sentence","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"MqXm3Guxnu"}],"key":"nBXPIH9ax4"}],"key":"cOQpiJNqeR"}],"key":"vEPRY4waDP"}],"key":"stSe2YjhCz"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Recurrent neural networks (RNNs)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Seo8b7oBkd"}],"key":"nV83HEbpfj"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Can look back at the entire previous sequence","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"MiwkN3Co20"}],"key":"e4EGfo1l6O"}],"key":"VqhjuPkdpc"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Much slower to train, have limited memory in practice","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"RkFlPhgpzB"}],"key":"Kot54TWKdb"}],"key":"nhk65vB3l6"}],"key":"aRFT3y6Yn5"}],"key":"pboMGVnlWT"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Attention-based networks (Transformers)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"KZRjNLZLYC"}],"key":"snYpI2AmIg"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Best of both worlds: fast and very long memory","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"eAsZXYToCA"}],"key":"kesJ4rubkX"}],"key":"We4C8DQnWc"}],"key":"q5ku0DqP2Z"}],"key":"EVDgF0vFpu"}],"key":"ywcyog9Hwa"}],"key":"Dg6dtgPpZr"}],"key":"CJu0Be5srz"}],"key":"BNDmsoCXeC"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"seq2seq models","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GHgajBueAF"}],"identifier":"seq2seq-models","label":"seq2seq models","html_id":"seq2seq-models","implicit":true,"key":"hTc6yorbcz"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Produce a series of output given a series of inputs over time","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"seC30NZMh0"}],"key":"xJoVTlThwb"}],"key":"DAQ04zUs3q"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Can handle sequences of different lengths","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GsAZfbcrO1"}],"key":"apjUjJ5nKZ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Label-to-sequence, Sequence-to-label, seq2seq,...","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"TNcjnuXi9S"}],"key":"HQyyeirLLP"}],"key":"XrSbK3C5fU"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Autoregressive models (e.g. predict the next character, unsupervised)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"I5guoJx0MC"}],"key":"koFJa2ZE2X"}],"key":"cwXM12jTlV"}],"key":"eMiWdcZSrA"}],"key":"nCjpNgQFux"}],"key":"rjZ6I3K9pC"},{"type":"image","style":{"width":"80%","marginLeft":"auto","marginRight":"auto"},"url":"/36c883aad53fbd524f9bd8516c6b0cec.png","alt":"ml","key":"IskbreAyuw","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/10_seq2seq.png","urlOptimized":"/36c883aad53fbd524f9bd8516c6b0cec.webp"}],"key":"oDtcAlO24d"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1D convolutional networks","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Yl2lGNLtbf"}],"identifier":"id-1d-convolutional-networks","label":"1D convolutional networks","html_id":"id-1d-convolutional-networks","implicit":true,"key":"TYO2jnKlzT"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Similar to 2D convnets, but moves only in 1 direction (time)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"USAY96R9yq"}],"key":"fGpNhExYYg"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Extract local 1D patch, apply filter (kernel) to every patch","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZDCWQgoT7Q"}],"key":"gJnzXCn55K"}],"key":"NF9EaLb9Q7"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Pattern learned can later be recognized elsewhere (translation invariance)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"xEod4SfQoq"}],"key":"DAn4YwCbBf"}],"key":"bEwC20zeCh"}],"key":"FWqjKXUQqM"}],"key":"PRNVyMJN8c"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Limited memory: only sees a small part of the sequence (receptive field)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"bjt4Hgslxr"}],"key":"FfbStfWYQh"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"You can use multiple layers, dilations,... but becomes expensive","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"y6O0v9HJko"}],"key":"DxdEC074Us"}],"key":"v1yre81jUR"}],"key":"f813ibtbNN"}],"key":"tEkTkY9aYT"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Looks at ‘future’ parts of the series, but can be made to look only at the past","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"zBP2oqtKzg"}],"key":"TFj2rEzvYU"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Known as ‘causal’ models (not related to causality)","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"b7aQ29qclv"}],"key":"N3O02Hsy9G"}],"key":"tj1CnicgMU"}],"key":"Rr8t3iQTQD"}],"key":"bwQcZ4i0gf"}],"key":"iVCpjN7iwR"},{"type":"image","style":{"width":"100%"},"url":"/c35d1a9ee6a70056151e6a3c0d3d5b09.png","alt":"ml","key":"pocbGv94kO","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/10_1dconv.png","urlOptimized":"/c35d1a9ee6a70056151e6a3c0d3d5b09.webp"}],"visibility":"show","key":"TjtuWUwSTo"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"},"tags":[]},"children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Same embedding, but add 2 ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"y4Mo7EG0By"},{"type":"inlineCode","value":"Conv1D","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rPGwDixLee"},{"type":"text","value":" layers and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QRMCenYYa2"},{"type":"inlineCode","value":"MaxPooling1D","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Q1fPXI8irb"},{"type":"text","value":". Better!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kiSoVpiL1I"}],"key":"gpomTsU15B"}],"key":"XYLLtIx16U"}],"key":"g9ciDL8qs9"},{"type":"code","lang":"python","value":"model = nn.Sequential(\n    nn.Embedding(num_embeddings=10000, embedding_dim=embedding_dim),\n    nn.Conv1d(in_channels=embedding_dim, out_channels=32, kernel_size=7),\n    nn.ReLU(),\n    nn.MaxPool1d(kernel_size=5),\n    nn.Conv1d(in_channels=32, out_channels=32, kernel_size=7),\n    nn.ReLU(),\n    nn.AdaptiveAvgPool1d(1),  # GAP\n    nn.Flatten(),             # (batch, 32, 1) → (batch, 32)\n    nn.Linear(32, 1)\n)","position":{"start":{"line":2,"column":1},"end":{"line":14,"column":1}},"key":"lWuZK2j2iv"}],"visibility":"show","key":"wgZrgjNtWH"},{"type":"block","kind":"notebook-code","data":{"slideshow":{"slide_type":"skip"}},"children":[{"type":"code","lang":"python","executable":true,"value":"model = nn.Sequential(\n    nn.Embedding(num_embeddings=10000, embedding_dim=embedding_dim),  # embedding_layer\n    nn.Conv1d(in_channels=embedding_dim, out_channels=32, kernel_size=7),\n    nn.ReLU(),\n    nn.MaxPool1d(kernel_size=5),\n    nn.Conv1d(in_channels=32, out_channels=32, kernel_size=7),\n    nn.ReLU(),\n    nn.AdaptiveAvgPool1d(1),  # equivalent to GlobalAveragePooling1D\n    nn.Flatten(),             # flatten (batch, 32, 1) → (batch, 32)\n    nn.Linear(32, 1),\n    nn.Sigmoid()\n)","key":"ZQO3DCOAE9"},{"type":"outputs","id":"q_8YSIfImAMZf8GWmazvb","children":[],"key":"OdxIpTygkp"}],"key":"uRu4n9vQlg"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Recurrent neural networks (RNNs)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"j6kFiUmoNI"}],"identifier":"recurrent-neural-networks-rnns","label":"Recurrent neural networks (RNNs)","html_id":"recurrent-neural-networks-rnns","implicit":true,"key":"nmsfEZgeEN"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Recurrent connection: concats output to next input\n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"k1cUXkv2kV"},{"type":"inlineMath","value":"{\\color{orange} h_t} = \\sigma \\left( {\\color{orange} W } \\left[ \\begin{array}{c} {\\color{blue}x}_t \\\\ {\\color{orange} h}_{t-1} \\end{array} \\right] + b \\right)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle mathcolor=\"orange\"><msub><mi>h</mi><mi>t</mi></msub></mstyle><mo>=</mo><mi>σ</mi><mrow><mo fence=\"true\">(</mo><mstyle mathcolor=\"orange\"><mi>W</mi></mstyle><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mstyle mathcolor=\"blue\"><mi>x</mi></mstyle><mi>t</mi></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mstyle mathcolor=\"orange\"><mi>h</mi></mstyle><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mo>+</mo><mi>b</mi><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">{\\color{orange} h_t} = \\sigma \\left( {\\color{orange} W } \\left[ \\begin{array}{c} {\\color{blue}x}_t \\\\ {\\color{orange} h}_{t-1} \\end{array} \\right] + b \\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"color:orange;\"><span class=\"mord mathnormal\" style=\"color:orange;\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color:orange;\"><span class=\"mord mathnormal mtight\" style=\"color:orange;\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;color:orange;\">W</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"color:blue;\">x</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"color:orange;\">h</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span></span></span></span>","key":"yHQtJ8MxqT"}],"key":"AwYoBNSBuq"}],"key":"POnQx4EsgG"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Unbounded memory, but training requires ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"QxnJ2H17YI"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"backpropagation through time","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Fu5kpLl1hy"}],"key":"E2qAXPkxAc"}],"key":"H3ir0ktUIs"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Requires storing previous network states (slow + lots of memory)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"uHotgkIPwq"}],"key":"IEZv4xiAxo"}],"key":"lWNvGiteUx"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Vanishing gradients strongly limit practical memory","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"zGaJ9bwP79"}],"key":"FZfVghW4T8"}],"key":"dCKvjJBfHf"}],"key":"aW6WryWDzh"}],"key":"xDgdpx6s69"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Improved with ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"sHRovAVIFE"},{"type":"emphasis","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"gating","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"DrC976No4c"}],"key":"XjdqkKBr55"},{"type":"text","value":": learn what to input, forget, output (LSTMs, GRUs,...)","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"m2iiucDfZQ"}],"key":"u3PDQEQOr9"}],"key":"rgsSv4dvoE"}],"key":"bRIWkoH77p"},{"type":"image","style":{"width":"70%"},"url":"/82b161d920fc8fd09af30880b0ffe17b.png","alt":"ml","key":"z7cjeqldxd","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/10_rnn.png","urlOptimized":"/82b161d920fc8fd09af30880b0ffe17b.webp"}],"key":"huqRhYRcJh"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Simple self-attention","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"k0bqk3kmFw"}],"identifier":"simple-self-attention","label":"Simple self-attention","html_id":"simple-self-attention","implicit":true,"key":"Wmg2CtabLv"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Maps a ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"VASgMkREYa"},{"type":"emphasis","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"set","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ixl1g790wV"}],"key":"C0JbZhNN20"},{"type":"text","value":" of inputs to a set of outputs (","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"svFmWeNsn2"},{"type":"emphasis","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"without","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"xiAUtI2lXz"}],"key":"nnR2WIKC5Q"},{"type":"text","value":" learned weigths)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"pyr3laTWcb"}],"key":"Ahb6l86BgE"}],"key":"ukIp2bOnMG"}],"key":"EwzTXDcxqb"},{"type":"image","style":{"width":"50%"},"url":"/7a89270055ec902ace03eb6461615c88.png","alt":"ml","key":"P6obvkQ1Is","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/selfattention.png","urlOptimized":"/7a89270055ec902ace03eb6461615c88.webp"}],"key":"JZLQaMw06u"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Simple self-attention","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zTg3HTTZRC"}],"identifier":"simple-self-attention","label":"Simple self-attention","html_id":"simple-self-attention-1","implicit":true,"key":"xm483U4qwM"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Compute dot product of input vector ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"z58dEXVlkg"},{"type":"inlineMath","value":"x_i","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"m6QOCb3hHM"},{"type":"text","value":" with every ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"tSEYiN4yqH"},{"type":"inlineMath","value":"x_j","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"FFXjwjTBWk"},{"type":"text","value":" (including itself): ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"aSDjKFQKRX"},{"type":"inlineMath","value":"{\\color{Orange} w_{ij}}","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle mathcolor=\"Orange\"><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mstyle></mrow><annotation encoding=\"application/x-tex\">{\\color{Orange} w_{ij}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"color:Orange;\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;color:Orange;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color:Orange;\"><span class=\"mord mtight\" style=\"color:Orange;\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;color:Orange;\">ij</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span></span>","key":"yYjaJ5rp6R"}],"key":"Yr0462p7YB"}],"key":"eSFGEzfhHi"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Compute softmax over all these weights (positive, sum to 1)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eOkrC6gv93"}],"key":"iwtgQZmwoV"}],"key":"ZIlroJ7X9w"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Multiply by each input vector, and sum everything up","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"eDNXbo8VZ5"}],"key":"r9GFz6JTLe"}],"key":"PB9os0TlMj"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Can be easily vectorized: ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"j2rX5PtqK7"},{"type":"inlineMath","value":"{\\color{green} Y}^T = {\\color{orange} W}{\\color{blue} X^T}","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mstyle mathcolor=\"green\"><mi>Y</mi></mstyle><mi>T</mi></msup><mo>=</mo><mstyle mathcolor=\"orange\"><mi>W</mi></mstyle><mstyle mathcolor=\"blue\"><msup><mi>X</mi><mi>T</mi></msup></mstyle></mrow><annotation encoding=\"application/x-tex\">{\\color{green} Y}^T = {\\color{orange} W}{\\color{blue} X^T}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;color:green;\">Y</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;color:orange;\">W</span></span><span class=\"mord\"><span class=\"mord\" style=\"color:blue;\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;color:blue;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color:blue;\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;color:blue;\">T</span></span></span></span></span></span></span></span></span></span></span></span>","key":"ubHy1cLdOJ"},{"type":"text","value":", ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"obCmdtlTVj"},{"type":"inlineMath","value":"{\\color{orange} W} = \\textrm{softmax}( {\\color{blue} X}^T {\\color{blue}X} )","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle mathcolor=\"orange\"><mi>W</mi></mstyle><mo>=</mo><mtext>softmax</mtext><mo stretchy=\"false\">(</mo><msup><mstyle mathcolor=\"blue\"><mi>X</mi></mstyle><mi>T</mi></msup><mstyle mathcolor=\"blue\"><mi>X</mi></mstyle><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">{\\color{orange} W} = \\textrm{softmax}( {\\color{blue} X}^T {\\color{blue}X} )</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;color:orange;\">W</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0913em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord textrm\">softmax</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;color:blue;\">X</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;color:blue;\">X</span></span><span class=\"mclose\">)</span></span></span></span>","key":"AsjqVQAmoc"}],"key":"RosvrL7t7i"}],"key":"QuFxYZS1HQ"}],"key":"QSOLuIZZy8"},{"type":"image","style":{"width":"70%"},"url":"/0f5247b5a94f0a52ed21e7a9139d148a.png","alt":"ml","key":"KlX7D6nP8M","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/10_selfattention.png","urlOptimized":"/0f5247b5a94f0a52ed21e7a9139d148a.webp"}],"key":"nsyCdsLsau"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"For each output, we mix information from all inputs according to how ‘similar’ they are","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IB8R4tzsbz"}],"key":"eUMfaueVYt"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The set of weights ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"WFbrqMhOu5"},{"type":"inlineMath","value":"{\\color{Orange} w_{i}}","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle mathcolor=\"Orange\"><msub><mi>w</mi><mi>i</mi></msub></mstyle></mrow><annotation encoding=\"application/x-tex\">{\\color{Orange} w_{i}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"color:Orange;\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;color:Orange;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color:Orange;\"><span class=\"mord mtight\" style=\"color:Orange;\"><span class=\"mord mathnormal mtight\" style=\"color:Orange;\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","key":"WitdGps5LP"},{"type":"text","value":" for a given token is called the attention vector","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"q9GBGat0sE"}],"key":"CUv8MrCLeN"}],"key":"PmXsgo6Lkb"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"It says how much ‘attention’ each token gives to other tokens","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Lgoc2W5WCe"}],"key":"tSkGg7ojfz"}],"key":"NRbYrTdiQR"}],"key":"ssxOfGmjfZ"}],"key":"TpJqTXMOze"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Doesn’t learn (no parameters), the embedding of ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"IcWcSANb4x"},{"type":"inlineMath","value":"{\\color{blue} X}","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle mathcolor=\"blue\"><mi>X</mi></mstyle></mrow><annotation encoding=\"application/x-tex\">{\\color{blue} X}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;color:blue;\">X</span></span></span></span></span>","key":"HzoCGhaosj"},{"type":"text","value":" defines self-attention","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"XS5rgzj15n"}],"key":"NhP6mcQECT"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We’ll learn how to ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"VmxEa2UOie"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"transform the embeddings","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Xyo0UBJl3I"}],"key":"mLZ2IyYXt7"},{"type":"text","value":" later","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"pIORbKFbWD"}],"key":"uUDxedcOkt"}],"key":"o8AsVObDPC"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"That way we can learn different relationships (not just similarity)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"kMR1QXS2Ci"}],"key":"g7xkalpIPU"}],"key":"uinq8mdvmu"}],"key":"KoFofJvzrT"}],"key":"EsT0BNEvHy"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Has no problem looking ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"MYp14pf8Ei"},{"type":"emphasis","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"very","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"hYIRCt9EKB"}],"key":"oZOT2rfBAJ"},{"type":"text","value":" far back in the sequence","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"oYsbAusoG2"}],"key":"L5wewIDiGP"}],"key":"UljRRaoz6U"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Operates on ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"BNOv6kAICh"},{"type":"emphasis","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"sets","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"hZ585L4lv5"}],"key":"pb2qEIlOHD"},{"type":"text","value":" (permutation invariant): allows img-to-set, set-to-set,... tasks","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"rMQaaEj9O4"}],"key":"dxzjIVsrDq"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"If the token order matters, we’ll have to encode it in the token embedding","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"cHcKnHu0il"}],"key":"hqu2bxJogd"}],"key":"bQJ0xNcDoM"}],"key":"h1GyK8LMTV"}],"key":"FHoGLbqbbj"}],"key":"sz7gdCn0WO"},{"type":"image","style":{"width":"45%"},"url":"/0f5247b5a94f0a52ed21e7a9139d148a.png","alt":"ml","key":"reqR3Fnyhp","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/10_selfattention.png","urlOptimized":"/0f5247b5a94f0a52ed21e7a9139d148a.webp"}],"key":"Oc0Ru30Msi"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Scaled dot products","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aq2ijyOIj7"}],"identifier":"scaled-dot-products","label":"Scaled dot products","html_id":"scaled-dot-products","implicit":true,"key":"R2Wh1ZAyer"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Self-attention is powerful because it’s mostly a linear operation","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"EoHYWnTjp9"}],"key":"lQHjuwCtZ2"}],"key":"yntxw3pnFP"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"{\\color{green} Y}^T = {\\color{orange} W}{\\color{blue} X^T}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mstyle mathcolor=\"green\"><mi>Y</mi></mstyle><mi>T</mi></msup><mo>=</mo><mstyle mathcolor=\"orange\"><mi>W</mi></mstyle><mstyle mathcolor=\"blue\"><msup><mi>X</mi><mi>T</mi></msup></mstyle></mrow><annotation encoding=\"application/x-tex\">{\\color{green} Y}^T = {\\color{orange} W}{\\color{blue} X^T}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;color:green;\">Y</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;color:orange;\">W</span></span><span class=\"mord\"><span class=\"mord\" style=\"color:blue;\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;color:blue;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color:blue;\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;color:blue;\">T</span></span></span></span></span></span></span></span></span></span></span></span>","key":"OAoGRg0xuQ"},{"type":"text","value":" is ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RJy18noJHX"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"linear","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DbCCJzEgzB"}],"key":"jQLZ87Uw4R"},{"type":"text","value":", there are no vanishing gradients","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"X7bPkbZZuQ"}],"key":"gk0nBQij6T"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The softmax function only applies to ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"MfEERscufg"},{"type":"inlineMath","value":"{\\color{orange} W} = \\textrm{softmax}( {\\color{blue} X}^T {\\color{blue}X} )","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle mathcolor=\"orange\"><mi>W</mi></mstyle><mo>=</mo><mtext>softmax</mtext><mo stretchy=\"false\">(</mo><msup><mstyle mathcolor=\"blue\"><mi>X</mi></mstyle><mi>T</mi></msup><mstyle mathcolor=\"blue\"><mi>X</mi></mstyle><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">{\\color{orange} W} = \\textrm{softmax}( {\\color{blue} X}^T {\\color{blue}X} )</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;color:orange;\">W</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0913em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord textrm\">softmax</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;color:blue;\">X</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;color:blue;\">X</span></span><span class=\"mclose\">)</span></span></span></span>","key":"qqajzQ0WIS"},{"type":"text","value":", not to ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ou6buLZbB6"},{"type":"inlineMath","value":"{\\color{green} Y}^T","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mstyle mathcolor=\"green\"><mi>Y</mi></mstyle><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">{\\color{green} Y}^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;color:green;\">Y</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span>","key":"YP7i5G3S16"}],"key":"kTEbxnEXn3"}],"key":"ygdrXeFjey"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Needed to make the attention values sum up nicely to 1 without exploding","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"WuuzZGH14X"}],"key":"E5CC8yz6dh"}],"key":"aEB37pW5eT"}],"key":"qrnubPvSHK"}],"key":"h92T0hhgFn"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The dot products do get larger as the embedding dimension ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"CkuyHqL185"},{"type":"inlineMath","value":"k","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"M54ySkqLxw"},{"type":"text","value":" gets larger (by a factor ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"WjVUXT2z6y"},{"type":"inlineMath","value":"\\sqrt{k}","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msqrt><mi>k</mi></msqrt></mrow><annotation encoding=\"application/x-tex\">\\sqrt{k}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.04em;vertical-align:-0.1078em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9322em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span><span style=\"top:-2.8922em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1078em;\"><span></span></span></span></span></span></span></span></span>","key":"ON2lnIHywr"},{"type":"text","value":")","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"CP6q04c5GT"}],"key":"Arwrmkxohl"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We therefore normalize the dot product by the input dimension ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"tWIEsCp9QD"},{"type":"inlineMath","value":"k","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"KNTeFG20tJ"},{"type":"text","value":": ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"esUDRq7KkT"},{"type":"inlineMath","value":"{\\color{orange}w^{'}_{ij}} = \\frac{{\\color{blue} x_i}^T \\color{blue} x_j}{\\sqrt{k}}","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle mathcolor=\"orange\"><msubsup><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow><msup><mrow></mrow><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></msubsup></mstyle><mo>=</mo><mfrac><mrow><msup><mstyle mathcolor=\"blue\"><msub><mi>x</mi><mi>i</mi></msub></mstyle><mi>T</mi></msup><mstyle mathcolor=\"blue\"><msub><mi>x</mi><mi>j</mi></msub></mstyle></mrow><msqrt><mi>k</mi></msqrt></mfrac></mrow><annotation encoding=\"application/x-tex\">{\\color{orange}w^{&#x27;}_{ij}} = \\frac{{\\color{blue} x_i}^T \\color{blue} x_j}{\\sqrt{k}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.3373em;vertical-align:-0.3948em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"color:orange;\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;color:orange;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9425em;\"><span style=\"top:-2.4413em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color:orange;\"><span class=\"mord mtight\" style=\"color:orange;\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;color:orange;\">ij</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color:orange;\"><span class=\"mord mtight\" style=\"color:orange;\"><span class=\"mord mtight\" style=\"color:orange;\"><span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8278em;\"><span style=\"top:-2.931em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\" style=\"color:orange;\"><span class=\"mord mtight\" style=\"color:orange;\"><span class=\"mord mtight\" style=\"color:orange;\">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3948em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.6887em;vertical-align:-0.538em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1507em;\"><span style=\"top:-2.5335em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord sqrt mtight\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9378em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mtight\" style=\"padding-left:0.833em;\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span><span style=\"top:-2.8978em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail mtight\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1022em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.5073em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\" style=\"color:blue;\"><span class=\"mord mathnormal mtight\" style=\"color:blue;\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\" style=\"color:blue;\"><span class=\"mord mathnormal mtight\" style=\"color:blue;\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9191em;\"><span style=\"top:-2.931em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mtight\" style=\"color:blue;\"><span class=\"mord mathnormal mtight\" style=\"color:blue;\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\" style=\"color:blue;\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;color:blue;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.538em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"tUYhvSj2at"}],"key":"pqAYEQ0cQv"}],"key":"WbHnD0eWIN"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"This also makes training more stable: large softmas values lead to ‘sharp’ outputs, making some gradients very large and others very small","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"GZue0E8eB8"}],"key":"XKkxmQLJ82"}],"key":"dKZwZfr5iq"}],"key":"kMAD6sB5iR"}],"key":"yc3VGhggQw"}],"key":"IRlI7p21g6"}],"key":"DLPQb7nT2Y"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Simple self-attention layer","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OF0j3BbSmd"}],"identifier":"simple-self-attention-layer","label":"Simple self-attention layer","html_id":"simple-self-attention-layer","implicit":true,"key":"toIFnWPmnA"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Let’s add a simple self-attention layer to our movie sentiment model","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"FIbxcVwPH9"}],"key":"S4nYKDUwPv"}],"key":"yDoAzHY9vZ"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Without self-attention, every word would contribute independently (bag of words)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MQXd6OY8Lv"}],"key":"f9XIMnqX8d"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The word ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"mjgi2XDNcz"},{"type":"emphasis","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"terrible","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"jsWxiBjGuE"}],"key":"ZipjMJvlwA"},{"type":"text","value":" will likely result in a negative prediction","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"C1cDo5dgvv"}],"key":"VVGBut0vhr"}],"key":"qH6wKgKBC9"}],"key":"hIaStBjOCw"}],"key":"eiWZEAYWhw"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Now, we can freeze the embedding, take output ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"JaR2SkSDJN"},{"type":"inlineMath","value":"{\\color{gray}Y}","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle mathcolor=\"gray\"><mi>Y</mi></mstyle></mrow><annotation encoding=\"application/x-tex\">{\\color{gray}Y}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;color:gray;\">Y</span></span></span></span></span>","key":"PrtKcPdbaa"},{"type":"text","value":", obtain a loss, and do backpropagation so that the self-attention layer can ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"jQjLnLVmgx"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"learn","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"NAvmtJ21IM"}],"key":"xZ2vDago4e"},{"type":"text","value":" that ‘not’ should invert the meaning of ‘terrible’","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"imKolHh9cV"}],"key":"wKKTt4Zh7J"}],"key":"wpCRKDmPWf"}],"key":"YcDBvc4Xw5"},{"type":"image","style":{"width":"40%"},"url":"/01023bd893216ef8c675f2841d41340f.png","alt":"ml","key":"Crh94tfxia","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/10_selfattention_layer_train.png","urlOptimized":"/01023bd893216ef8c675f2841d41340f.webp"}],"key":"uUjovBzsSc"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Simple self-attention layer","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QXOGX919CQ"}],"identifier":"simple-self-attention-layer","label":"Simple self-attention layer","html_id":"simple-self-attention-layer-1","implicit":true,"key":"Powtgf8c18"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Through training, we want the self-attention to learn how certain tokens (e.g. ‘not’) can affect other tokens / words.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"k270Ossr0X"}],"key":"MRumoKAMw2"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"E.g. we need to learn to change the representations of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UOoMCFLmC5"},{"type":"inlineMath","value":"v_{not}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>v</mi><mrow><mi>n</mi><mi>o</mi><mi>t</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">v_{not}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ZbjabZWGVK"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VU93yPjXlo"},{"type":"inlineMath","value":"v_{terrible}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>v</mi><mrow><mi>t</mi><mi>e</mi><mi>r</mi><mi>r</mi><mi>i</mi><mi>b</mi><mi>l</mi><mi>e</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">v_{terrible}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">err</span><span class=\"mord mathnormal mtight\">ib</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\">e</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"g0iMENGTtm"},{"type":"text","value":" so that they produce a ‘correct’ (low loss) output","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XyTkw7fqZa"}],"key":"MChTC4mz96"}],"key":"gFfBZ4BrB3"}],"key":"seTS5qW1Q0"}],"key":"bhuuFPuVHg"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"For that, we do need to add some trainable parameters.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"wHesrGgqcn"}],"key":"rIDCIBh1Au"}],"key":"XRvDOqFstK"}],"key":"Fh8uDWviPY"},{"type":"image","style":{"width":"50%"},"url":"/56397b06909a60de50ed00b310a82cc4.png","alt":"ml","key":"ZqAP7yaFbf","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/10_selfattention_negation.png","urlOptimized":"/56397b06909a60de50ed00b310a82cc4.webp"}],"key":"actX9vD5kS"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Standard self-attention","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uFxTMnBebW"}],"identifier":"standard-self-attention","label":"Standard self-attention","html_id":"standard-self-attention","implicit":true,"key":"Krrzkjw0vO"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We add 3 weight matrices (K, Q, V) and biases to change each vector:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"d5jCQUzy02"}],"key":"Rh3HydjdAs"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"k_i = K x_i + b_k","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>k</mi><mi>i</mi></msub><mo>=</mo><mi>K</mi><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><msub><mi>b</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">k_i = K x_i + b_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"z7JxXDXvmz"}],"key":"Cr8aLtQ3u9"}],"key":"EdwB9g388l"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"q_i = Q x_i + b_q","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>q</mi><mi>i</mi></msub><mo>=</mo><mi>Q</mi><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><msub><mi>b</mi><mi>q</mi></msub></mrow><annotation encoding=\"application/x-tex\">q_i = Q x_i + b_q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">q</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"WXRgy1CUga"}],"key":"g6W61R2tJU"}],"key":"ZEMODsqcMr"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"v_i = V x_i + b_v","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub><mo>=</mo><mi>V</mi><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><msub><mi>b</mi><mi>v</mi></msub></mrow><annotation encoding=\"application/x-tex\">v_i = V x_i + b_v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"uULszv2C0A"}],"key":"vAwgZ9b6HI"}],"key":"zF5VL5E5Dz"}],"key":"BzV05elJAE"}],"key":"VU4jrHGDvI"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The same K, Q, V are used for all tokens depending on whether they are the input token (v), the token we are currently looking at (q), or the token we’re comparing with (k)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"LSql1ku1Hg"}],"key":"L3OhXVDUBD"}],"key":"Tl03c5BISv"}],"key":"awGZdqaFTJ"},{"type":"image","style":{"width":"50%","marginLeft":"auto","marginRight":"auto"},"url":"/c18dbad3ae64c567fab26d78b935ee7d.png","alt":"ml","key":"EwkisBOjQW","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/10_selfattention_kqv3.png","urlOptimized":"/c18dbad3ae64c567fab26d78b935ee7d.webp"}],"key":"Eo7w1WDVFK"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Sidenote on terminology","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ASjX4V9E6P"}],"identifier":"sidenote-on-terminology","label":"Sidenote on terminology","html_id":"sidenote-on-terminology","implicit":true,"key":"m55muxbR8q"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"View the set of tokens as a dictionary\n","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"aNqQfinA2r"},{"type":"inlineCode","value":"s = {a: v_a, b: v_b, c: v_c}","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"W0crFqewYj"}],"key":"Oa2oHEgVSy"}],"key":"x4IJDpuQxi"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"In a dictionary, the third output (for key c) would simple be ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"fujNaR0VxB"},{"type":"inlineCode","value":"s[c] = v_c","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"e9LSP7jo1u"}],"key":"S1QwgnDxpL"}],"key":"jA3R8c0eeb"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"In a ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"RYGotE3GSL"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"soft","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Zst74OpeVv"}],"key":"gq4KMfVc4E"},{"type":"text","value":" dictionary, it’s a weighted sum: ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"qtKPdSd4Jk"},{"type":"inlineMath","value":"s[c] = w_a * v_a + w_b * v_b + w_c * v_c","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mo stretchy=\"false\">[</mo><mi>c</mi><mo stretchy=\"false\">]</mo><mo>=</mo><msub><mi>w</mi><mi>a</mi></msub><mo>∗</mo><msub><mi>v</mi><mi>a</mi></msub><mo>+</mo><msub><mi>w</mi><mi>b</mi></msub><mo>∗</mo><msub><mi>v</mi><mi>b</mi></msub><mo>+</mo><msub><mi>w</mi><mi>c</mi></msub><mo>∗</mo><msub><mi>v</mi><mi>c</mi></msub></mrow><annotation encoding=\"application/x-tex\">s[c] = w_a * v_a + w_b * v_b + w_c * v_c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">c</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6153em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6153em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6153em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"mFu6kvSc6s"}],"key":"oyqtGkyvGd"}],"key":"cFxDpZhZ9D"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"If ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"x6jQTilWyV"},{"type":"inlineMath","value":"w_i","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">w_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ebagDtQyMf"},{"type":"text","value":" are dot products: ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"H3mNUYbmiQ"},{"type":"inlineMath","value":"s[c] = (k_a\\cdot q_c) * v_a + (k_b\\cdot q_c) * v_b + (k_b\\cdot q_c) * v_c","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mo stretchy=\"false\">[</mo><mi>c</mi><mo stretchy=\"false\">]</mo><mo>=</mo><mo stretchy=\"false\">(</mo><msub><mi>k</mi><mi>a</mi></msub><mo>⋅</mo><msub><mi>q</mi><mi>c</mi></msub><mo stretchy=\"false\">)</mo><mo>∗</mo><msub><mi>v</mi><mi>a</mi></msub><mo>+</mo><mo stretchy=\"false\">(</mo><msub><mi>k</mi><mi>b</mi></msub><mo>⋅</mo><msub><mi>q</mi><mi>c</mi></msub><mo stretchy=\"false\">)</mo><mo>∗</mo><msub><mi>v</mi><mi>b</mi></msub><mo>+</mo><mo stretchy=\"false\">(</mo><msub><mi>k</mi><mi>b</mi></msub><mo>⋅</mo><msub><mi>q</mi><mi>c</mi></msub><mo stretchy=\"false\">)</mo><mo>∗</mo><msub><mi>v</mi><mi>c</mi></msub></mrow><annotation encoding=\"application/x-tex\">s[c] = (k_a\\cdot q_c) * v_a + (k_b\\cdot q_c) * v_b + (k_b\\cdot q_c) * v_c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">c</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"yZfE3WXL9n"}],"key":"AvpdBI7zwF"}],"key":"sI9619FKJ8"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"jmqixV3dMR"},{"type":"emphasis","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"blend","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Svo9zoD59s"}],"key":"FP5cb8iKrk"},{"type":"text","value":" the influence of every token based on their learned relations with other tokens\n","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"NS4QG1g1FY"},{"type":"image","style":{"width":"40%","marginLeft":"auto","marginRight":"auto"},"url":"/b7194b007dc23a3e147803547fd89e33.png","alt":"ml","key":"gAMq3epv9Y","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/10_selfattention_kqv_dict.png","urlOptimized":"/b7194b007dc23a3e147803547fd89e33.webp"}],"key":"bky8xDaNIM"}],"key":"IP0gPuGbIW"}],"key":"bDBPouEwnC"}],"key":"wff3AhUGb6"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Intuition","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DIyUUlccLh"}],"identifier":"intuition","label":"Intuition","html_id":"intuition","implicit":true,"key":"twAoUAHLUB"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"MHL5BQBZHA"},{"type":"emphasis","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"blend","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"PDHiqpQKDw"}],"key":"XfbVYP2zuZ"},{"type":"text","value":" the influence of every token based on their learned ‘relations’ with other tokens","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Ws6Z2qxSyZ"}],"key":"fdeDJ7984a"}],"key":"EgyZu0VXWo"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Say that we need to learn how ‘negation’ works","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vElqciXfk2"}],"key":"LsXjKBaLwr"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The ‘query’ vector could be trained (via Q) to say something like ‘are there any negation words?’","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"im0ShQXRJ0"}],"key":"h5JlFDMwIv"}],"key":"wYWktWuPmi"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"A token (e.g. ‘not’), transformed by K, could then respond very positively if it is","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"jCXjIPBqAR"}],"key":"ufF21naY4j"}],"key":"bFRWd4pSLV"}],"key":"W6eJIKr7ML"}],"key":"tvJYUcG43x"}],"key":"ybjRWbCkKB"},{"type":"image","style":{"width":"40%","marginLeft":"auto","marginRight":"auto"},"url":"/0f1f6629dba60251dea97ed32470700d.png","alt":"ml","key":"er7MJ2qB96","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/10_selfattention_kqv_not2.png","urlOptimized":"/0f1f6629dba60251dea97ed32470700d.webp"}],"key":"izy80B1aDV"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Single-head self-attention","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"S7QMLNctHX"}],"identifier":"single-head-self-attention","label":"Single-head self-attention","html_id":"single-head-self-attention","implicit":true,"key":"useFhOD8Br"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"There are different relations to model within a sentence.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"CpM5kwYyBw"}],"key":"Rzz5ZwUBFo"}],"key":"iyxAWIESNy"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The same input token, e.g. ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"k2gEzBMVeU"},{"type":"inlineMath","value":"v_{terrible}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>v</mi><mrow><mi>t</mi><mi>e</mi><mi>r</mi><mi>r</mi><mi>i</mi><mi>b</mi><mi>l</mi><mi>e</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">v_{terrible}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">err</span><span class=\"mord mathnormal mtight\">ib</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\">e</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"iD0Pd0dOCu"},{"type":"text","value":" can relate completely differently to other kinds of tokens","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"pqj1zNu77J"}],"key":"dNEDOR7Rrg"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"But we only have one set of K, V, and Q matrices","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"swM63iXinT"}],"key":"kcF7OcLvIc"}],"key":"epywh5zh0e"}],"key":"J521I2GtDP"}],"key":"FAq7rTpGuP"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"To better capture multiple relationships, we need multiple self-attention operations (expensive)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"m9ixz9c2Q1"}],"key":"zPus7H4pue"}],"key":"RUUxUkMULv"}],"key":"yTJddhYrcl"},{"type":"image","style":{"width":"40%","marginLeft":"auto","marginRight":"auto"},"url":"/355deed2c47755da7cf10730b239cb53.png","alt":"ml","key":"m8cZSIuinl","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/10_properties.png","urlOptimized":"/355deed2c47755da7cf10730b239cb53.webp"}],"key":"WKZwu2tPrM"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Multi-head self-attention","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ByOpFwDwR6"}],"identifier":"multi-head-self-attention","label":"Multi-head self-attention","html_id":"multi-head-self-attention","implicit":true,"key":"pa0UWrEREI"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"What if we project the input embeddings to a lower-dimensional embedding ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"WVRqrnOzcU"},{"type":"inlineMath","value":"k","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"XDtiqZT50v"},{"type":"text","value":"?","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"j1xIgB8luw"}],"key":"gi6BsfYhkI"}],"key":"rWkQlEWZIB"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Then we could learn multiple self-attention operations in parallel","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wIfGBtyqHt"}],"key":"GIRsyML9gR"}],"key":"QvhRCGC9QI"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Effectively, we split the self-attention in multiple heads","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Wy0LZ1yD2c"}],"key":"CZPcq0jxS9"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Each applies a separate low-dimensional self attention (with ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"YNhJuRdOmX"},{"type":"inlineMath","value":"K^{kxk},Q^{kxk},V^{kxk}","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>K</mi><mrow><mi>k</mi><mi>x</mi><mi>k</mi></mrow></msup><mo separator=\"true\">,</mo><msup><mi>Q</mi><mrow><mi>k</mi><mi>x</mi><mi>k</mi></mrow></msup><mo separator=\"true\">,</mo><msup><mi>V</mi><mrow><mi>k</mi><mi>x</mi><mi>k</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">K^{kxk},Q^{kxk},V^{kxk}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0435em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span></span></span></span></span>","key":"sSDmbSUoO4"},{"type":"text","value":")","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Qwf5FvCPYX"}],"key":"zuFGpWmwgs"}],"key":"CKcKqfGCd7"}],"key":"JJ08Jl6xyQ"}],"key":"NbH0mh0LMe"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"After running them (in parallel), we concatenate their outputs.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"krX7U1wgKZ"}],"key":"FPgmz3j9WG"}],"key":"UwjtfNnbPo"}],"key":"DAn9TKIj52"},{"type":"image","style":{"width":"60%"},"url":"/9ef881b01a2c062f4d3beb599562a55e.png","alt":"ml","key":"JUjarPGPKC","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/10_multihead_attention.png","urlOptimized":"/9ef881b01a2c062f4d3beb599562a55e.webp"}],"key":"v6tryq1zbB"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Transformer model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xxOxkXdWwt"}],"identifier":"transformer-model","label":"Transformer model","html_id":"transformer-model","implicit":true,"key":"j486D3b8bW"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Repeat self-attention multiple times in controlled fashion","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"dO7OiRhBSl"}],"key":"N9ZCKd7ZRk"}],"key":"YR81CsLyXA"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Works for sequences, images, graphs,... (learn how sets of objects interact)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DHlcRRAIXC"}],"key":"DNZXIoAjZN"}],"key":"SBS6yfDIJI"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Models consist of multiple transformer blocks, usually:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"dHZMLHOTQj"}],"key":"fc1xpsWeW1"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Layer normalization (every input is normalized independently)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mmp3lGWc2K"}],"key":"Kn6tCQb8iX"}],"key":"tCrfLJ9G9R"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Self-attention layer (learn interactions)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"jTjfHj6YY3"}],"key":"T576IElyMG"}],"key":"VbxSl6GA29"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Residual connections (preserve gradients in deep networks)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"rpbqgvHeHE"}],"key":"woHZltl9AI"}],"key":"JJQ6veq18J"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Feed-forward layer (learn mappings)","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"WbrG1984Nl"}],"key":"nntyZYjRpT"}],"key":"gE6v7hFCMC"}],"key":"fVt9TfGosu"}],"key":"Pag6hHo2d1"}],"key":"g848KODYo9"},{"type":"image","style":{"width":"60%"},"url":"/f972e371d8e674e00bbbe47c539cf72c.png","alt":"ml","key":"exPSchiUsd","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/10_transformer_model.png","urlOptimized":"/f972e371d8e674e00bbbe47c539cf72c.webp"}],"key":"k2VtIky6Eh"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Positional encoding","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SjyRLuozsw"}],"identifier":"positional-encoding","label":"Positional encoding","html_id":"positional-encoding","implicit":true,"key":"ixkJpUPrdj"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We need some way to tell the self-attention layer about position in the sequence","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"tnvPfELGoD"}],"key":"EdOrmxWL8t"}],"key":"d5tOZmMK1h"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Represent position by vectors, using some easy-to-learn predictable pattern","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fAF0SPWJvU"}],"key":"ZIhZN1JHda"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Add these encodings to vector embeddings","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Tv2NWhqcSt"}],"key":"olgrUNjcLy"}],"key":"z4smMDJFYz"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Gives information on how far one input is from the others","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"dhSHMCVyKf"}],"key":"CaJvM5GqhV"}],"key":"GjXJ6JN3Q3"}],"key":"u0Alt91dKC"}],"key":"qtJchYzcFl"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Other techniques exist (e.g. relative positioning)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"l3S8T4bfZ5"}],"key":"l3YNaR8QEf"}],"key":"ETspzxI0Eq"}],"key":"VRISdqDokn"},{"type":"image","style":{"width":"70%"},"url":"/7c5b74c9b04d62085365af8401653954.png","alt":"ml","key":"Y5fZ1UYH8O","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/10_encoding2.png","urlOptimized":"/7c5b74c9b04d62085365af8401653954.webp"}],"key":"tfPADmDq9X"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Autoregressive models","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rjM4uJqQHY"}],"identifier":"autoregressive-models","label":"Autoregressive models","html_id":"autoregressive-models","implicit":true,"key":"hqFxEg1HZQ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Models that predict future values based on past values of the same stream","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wewFaHRCfg"}],"key":"Stk925x5fS"}],"key":"uNLgA63KnT"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Output token is mapped to list of probabilities, sampled with softmax (with temperature)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"GzPPD172D1"}],"key":"T7kPMYXhr1"}],"key":"laQ7Krjwfb"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Problem: self-attention can simply look ahead in the stream","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"tQpLUMS1Md"}],"key":"bmlncEEYIP"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We need to make the transformer blocks ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"px5miYQvYI"},{"type":"emphasis","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"causal","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"NYDKRJgm9u"}],"key":"vRpw5bRpMP"}],"key":"vXQfuozvfZ"}],"key":"y5tZcOCkqZ"}],"key":"DzKG3s6sfA"}],"key":"J5VEhxfvn4"}],"key":"y6corR6tC4"},{"type":"image","style":{"width":"60%","marginLeft":"auto","marginRight":"auto"},"url":"/5e2e82ca100a793c74bc6699d49b2e31.png","alt":"ml","key":"RdAVWiA3p5","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/10_autoregressive2.png","urlOptimized":"/5e2e82ca100a793c74bc6699d49b2e31.webp"}],"key":"wFNLxnQ6xx"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Masked self-attention","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M6vGsFIw52"}],"identifier":"masked-self-attention","label":"Masked self-attention","html_id":"masked-self-attention","implicit":true,"key":"iv5z7arloD"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Simple solution: simply mask out any attention weights from current to future tokens","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ToK2YayzAl"}],"key":"lA0HOlNvYr"}],"key":"wY1Rw5Jd2I"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Replace with -infinity, so that after softmax they will be 0","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"iNYXYphevg"}],"key":"F1asP3bi5a"}],"key":"ErffT9hRXL"}],"key":"KCXFHLY3VF"},{"type":"image","style":{"width":"60%","marginLeft":"auto","marginRight":"auto"},"url":"/06df24e37d331881ef5ab52d18bb793a.png","alt":"ml","key":"gIOIyHt9i2","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/10_maskedse.png","urlOptimized":"/06df24e37d331881ef5ab52d18bb793a.webp"}],"key":"Osibqm6yY5"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Famous transformers","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s5nKnukSrM"}],"identifier":"famous-transformers","label":"Famous transformers","html_id":"famous-transformers","implicit":true,"key":"XfkEbN8VI4"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"“Attention is all you need”: first paper to use attention without CNNs or RNNs","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"DBK70CPT2Q"}],"key":"jpsgldRGZ1"}],"key":"nuab1zb474"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Encoder-Decoder architecture for translation: (k, q) to source attention layer","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fIcAMle1zU"}],"key":"GoKnBpmrmc"}],"key":"IiGrVGnWaJ"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We’ll reproduce this (partly) in the Lab 6 tutorial :)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"CN9gyJqdm4"}],"key":"Nw9BxD3tmI"}],"key":"LXTXHYpRnm"}],"key":"CRCKszFP9K"},{"type":"image","style":{"width":"40%","marginLeft":"auto","marginRight":"auto"},"url":"/101ba46707d5c2ff20449dd243180354.png","alt":"ml","key":"pzD8gUELhe","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/10_aiayn.png","urlOptimized":"/101ba46707d5c2ff20449dd243180354.webp"}],"key":"JL21apWwo4"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"GPT 3","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dVTokHbXrw"}],"identifier":"gpt-3","label":"GPT 3","html_id":"gpt-3","implicit":true,"key":"vaMktBPdqb"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Decoder-only, single stack of 96 transformer blocks (and 96 heads)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"bSfyjHI5wK"}],"key":"jlHoVFNFjW"}],"key":"UtYRmgna5g"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Sequence size 2048, input dimensionality 12,288, 175B parameters","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"P9kB8LeT7D"}],"key":"sCmVo094xe"}],"key":"eVmGH27fp9"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Trained on entire common crawl dataset (1 epoch)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"yJfjffRq5w"}],"key":"Q1EQ6jrhRP"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Additional training on high-quality data (Wikipedia,...)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"CQyaFVNL5x"}],"key":"fpbEqHPy53"}],"key":"lUK6VhUWHr"}],"key":"P5wA1i2KOA"}],"key":"V3orfUmq1N"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://youtu.be/wjZofJX0v4M?t=305","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Excellent animation by 1b3b","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Us7xgfxzsH"}],"urlSource":"https://youtu.be/wjZofJX0v4M?t=305","key":"C3u2nWDOi5"}],"key":"nyemCmjGBA"}],"key":"j2i7zFeSM7"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://www.youtube.com/watch?v=kCc8FmEb1nY","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"GPT from scratch by A. Karpathy","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"rzlwvUcbuZ"}],"urlSource":"https://www.youtube.com/watch?v=kCc8FmEb1nY","key":"vRovHiH31J"}],"key":"ldBtz4Pc6B"}],"key":"UoEU5IbuOa"}],"key":"jFZCd71u0y"},{"type":"image","style":{"width":"40%","marginLeft":"auto","marginRight":"auto"},"url":"/9facbf2e07ce6c23962a8467d9aa8fcd.png","alt":"ml","key":"F4U2Tm3CDi","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/10_gpt.png","urlOptimized":"/9facbf2e07ce6c23962a8467d9aa8fcd.webp"}],"key":"YNJEa99tvq"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"GPT 4","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xW4LG0K5NR"}],"identifier":"gpt-4","label":"GPT 4","html_id":"gpt-4","implicit":true,"key":"g6QotBJZ8I"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Likely a ‘mixtures of experts’ model","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"LRRtAFZr9a"}],"key":"GFEOms6kpf"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Router (small MLP) selects which subnetworks (e.g. 2) to use given input","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"txUYifeZHz"}],"key":"WlDyBpkb1D"}],"key":"rTl5Qv5pHF"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Predictions get ensembled","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"xIk6eoCqpl"}],"key":"VEP8hHXw3K"}],"key":"qg5MWlxJHG"}],"key":"WXH5AyKJg9"}],"key":"JR8IpcrQpJ"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Allows scaling up parameter count without proportionate (inference) cost","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"skhijeeEva"}],"key":"hc1fempZ8r"}],"key":"pqpamVna6B"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Also better data, more human-in-the-loop training (RLHF),...","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"tLLjK71V9K"}],"key":"eGV40dMSpP"}],"key":"VukyUz8XDg"}],"key":"D9loWLIfYD"},{"type":"image","style":{"width":"60%","marginLeft":"auto","marginRight":"auto"},"url":"/9ce9456a148f9f690845fd026e675ef6.png","alt":"ml","key":"PHa5z9wQBS","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/10_switch_transformer2.png","urlOptimized":"/9ce9456a148f9f690845fd026e675ef6.webp"}],"key":"mvxzDfmOfm"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Vision transformers","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VrhAe0FE8D"}],"identifier":"vision-transformers","label":"Vision transformers","html_id":"vision-transformers","implicit":true,"key":"UPzHaAzT0m"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Same principle: split up into patches, embed into tokens, add position encoding","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"YJs9FKNKfN"}],"key":"NlskE06sh9"}],"key":"tH58En4Ozl"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"For classification: add an extra (random) input token -> [CLS] output token\n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZnUT3ZAlFe"},{"type":"image","style":{"width":"70%"},"url":"/97104eeb479fbedf8d78908ae76c49ab.gif","alt":"ml","key":"fcYVPzICxt","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/vit.gif"}],"key":"HzyBxwmsNn"}],"key":"geeiH568Kc"}],"key":"KqoeI7pXCy"}],"key":"BDtrruz6D2"},{"type":"block","kind":"notebook-code","data":{"slideshow":{"slide_type":"skip"}},"children":[{"type":"code","lang":"python","executable":true,"value":"import torch\nimport torch.nn as nn\nimport torch.nn.functional as F\nimport torch.utils.data as data\nimport torch.optim as optim\n\n## Torchvision\nimport torchvision\nfrom torchvision.datasets import CIFAR10\nfrom torchvision import transforms\nimport pytorch_lightning as pl\nfrom pytorch_lightning.callbacks import LearningRateMonitor, ModelCheckpoint\n\n\ndevice = \"cpu\"\nif torch.backends.mps.is_available():\n    device = torch.device(\"mps\")\nelif torch.cuda.is_available():\n    device = torch.device(\"cuda\")\nprint(\"Device:\", device)\n\nDATASET_PATH = \"../data\"\nCHECKPOINT_PATH = \"../data/checkpoints\"","key":"loPlczfkPX"},{"type":"outputs","id":"RAqRIdB17whiZdwLC6EyL","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Device: mps\n"},"children":[],"key":"onN7SE8EJF"}],"key":"Hc9Qjy2Mid"}],"key":"k0x3RTM6Se"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demonstration","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UM94rl1qUK"}],"identifier":"demonstration","label":"Demonstration","html_id":"demonstration","implicit":true,"key":"I5p5JSQpN4"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We’ll experiment with the CIFAR-10 datasets","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IOR7eYt70U"}],"key":"qxND106HVE"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"ViTs are quite expensive on large images.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"KQuyieYPZN"}],"key":"pi3y8rrGhK"}],"key":"mkjfMZr6Pa"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"This ViT takes about an hour to train (we’ll run it from a checkpoint)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"SbYyhURkDw"}],"key":"TOwG4jTwxy"}],"key":"qH9B5VUy9p"}],"key":"W2NyQDEqe4"}],"key":"u4gTdv1jeP"},{"type":"block","kind":"notebook-code","data":{"slideshow":{"slide_type":"skip"}},"children":[{"type":"code","lang":"python","executable":true,"value":"pl.seed_everything(42)","key":"eOpnjjnXqO"},{"type":"outputs","id":"BhvzzkVELY6Fhya14Pz6f","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"Seed set to 42\n"},"children":[],"key":"zPdGOF8tKN"},{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":72,"metadata":{},"data":{"text/plain":{"content":"42","content_type":"text/plain"}}},"children":[],"key":"LIbKxxKT4i"}],"key":"YZIAhnhTFk"}],"key":"hsM1ezRjFm"},{"type":"block","kind":"notebook-code","data":{"slideshow":{"slide_type":"-"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Downloads CIFAR10 en creates train/val/test loaders\n\ntest_transform = transforms.Compose([transforms.ToTensor(),\n                                     transforms.Normalize([0.49139968, 0.48215841, 0.44653091], [0.24703223, 0.24348513, 0.26158784])\n                                     ])\n# For training, we add some augmentation. Networks are too powerful and would overfit.\ntrain_transform = transforms.Compose([transforms.RandomHorizontalFlip(),\n                                      transforms.RandomResizedCrop((32,32),scale=(0.8,1.0),ratio=(0.9,1.1)),\n                                      transforms.ToTensor(),\n                                      transforms.Normalize([0.49139968, 0.48215841, 0.44653091], [0.24703223, 0.24348513, 0.26158784])\n                                     ])\n# Loading the training dataset. We need to split it into a training and validation part\n# We need to do a little trick because the validation set should not use the augmentation.\ntrain_dataset = CIFAR10(root=DATASET_PATH, train=True, transform=train_transform, download=True)\nval_dataset = CIFAR10(root=DATASET_PATH, train=True, transform=test_transform, download=True)\ntrain_set, _ = torch.utils.data.random_split(train_dataset, [45000, 5000])\n_, val_set = torch.utils.data.random_split(val_dataset, [45000, 5000])\n\n# Loading the test set\ntest_set = CIFAR10(root=DATASET_PATH, train=False, transform=test_transform, download=True)\n\n# We define a set of data loaders that we can use for various purposes later.\ntrain_loader = data.DataLoader(train_set, batch_size=128, shuffle=True, drop_last=True, pin_memory=True, num_workers=4)\nval_loader = data.DataLoader(val_set, batch_size=128, shuffle=False, drop_last=False, num_workers=4)\ntest_loader = data.DataLoader(test_set, batch_size=128, shuffle=False, drop_last=False, num_workers=4)\n\n# Visualize some examples\nNUM_IMAGES = 4\nCIFAR_images = torch.stack([val_set[idx][0] for idx in range(NUM_IMAGES)], dim=0)\nimg_grid = torchvision.utils.make_grid(CIFAR_images, nrow=4, normalize=True, pad_value=0.9)\nimg_grid = img_grid.permute(1, 2, 0)\n\nplt.figure(figsize=(8,8))\nplt.title(\"Image examples of the CIFAR10 dataset\")\nplt.imshow(img_grid)\nplt.axis('off')\nplt.show()\nplt.close()","key":"b4AZG1Qbh2"},{"type":"outputs","id":"67nipBzt6V1rswP4a4NGL","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"application/pdf":{"content":"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NzAgL0YgNzMgL0kgODIgL1IgOTcgL2EgMTAwIC9kIC9lIC9mCi9nIC9oIDEwOCAvbCAvbSAxMTEgL28gL3AgMTE1IC9zIC90IDEyMCAveCBdCj4+Ci9XaWR0aHMgMTQgMCBSID4+CmVuZG9iagoxNSAwIG9iago8PCAvVHlwZSAvRm9udERlc2NyaXB0b3IgL0ZvbnROYW1lIC9CTVFRRFYrRGVqYVZ1U2FucyAvRmxhZ3MgMzIKL0ZvbnRCQm94IFsgLTEwMjEgLTQ2MyAxNzk0IDEyMzMgXSAvQXNjZW50IDkyOSAvRGVzY2VudCAtMjM2IC9DYXBIZWlnaHQgMAovWEhlaWdodCAwIC9JdGFsaWNBbmdsZSAwIC9TdGVtViAwIC9NYXhXaWR0aCAxMzQyID4+CmVuZG9iagoxNCAwIG9iagpbIDYwMCA2MDAgNjAwIDYwMCA2MDAgNjAwIDYwMCA2MDAgNjAwIDYwMCA2MDAgNjAwIDYwMCA2MDAgNjAwIDYwMCA2MDAgNjAwCjYwMCA2MDAgNjAwIDYwMCA2MDAgNjAwIDYwMCA2MDAgNjAwIDYwMCA2MDAgNjAwIDYwMCA2MDAgMzE4IDQwMSA0NjAgODM4IDYzNgo5NTAgNzgwIDI3NSAzOTAgMzkwIDUwMCA4MzggMzE4IDM2MSAzMTggMzM3IDYzNiA2MzYgNjM2IDYzNiA2MzYgNjM2IDYzNiA2MzYKNjM2IDYzNiAzMzcgMzM3IDgzOCA4MzggODM4IDUzMSAxMDAwIDY4NCA2ODYgNjk4IDc3MCA2MzIgNTc1IDc3NSA3NTIgMjk1CjI5NSA2NTYgNTU3IDg2MyA3NDggNzg3IDYwMyA3ODcgNjk1IDYzNSA2MTEgNzMyIDY4NCA5ODkgNjg1IDYxMSA2ODUgMzkwIDMzNwozOTAgODM4IDUwMCA1MDAgNjEzIDYzNSA1NTAgNjM1IDYxNSAzNTIgNjM1IDYzNCAyNzggMjc4IDU3OSAyNzggOTc0IDYzNCA2MTIKNjM1IDYzNSA0MTEgNTIxIDM5MiA2MzQgNTkyIDgxOCA1OTIgNTkyIDUyNSA2MzYgMzM3IDYzNiA4MzggNjAwIDYzNiA2MDAgMzE4CjM1MiA1MTggMTAwMCA1MDAgNTAwIDUwMCAxMzQyIDYzNSA0MDAgMTA3MCA2MDAgNjg1IDYwMCA2MDAgMzE4IDMxOCA1MTggNTE4CjU5MCA1MDAgMTAwMCA1MDAgMTAwMCA1MjEgNDAwIDEwMjMgNjAwIDUyNSA2MTEgMzE4IDQwMSA2MzYgNjM2IDYzNiA2MzYgMzM3CjUwMCA1MDAgMTAwMCA0NzEgNjEyIDgzOCAzNjEgMTAwMCA1MDAgNTAwIDgzOCA0MDEgNDAxIDUwMCA2MzYgNjM2IDMxOCA1MDAKNDAxIDQ3MSA2MTIgOTY5IDk2OSA5NjkgNTMxIDY4NCA2ODQgNjg0IDY4NCA2ODQgNjg0IDk3NCA2OTggNjMyIDYzMiA2MzIgNjMyCjI5NSAyOTUgMjk1IDI5NSA3NzUgNzQ4IDc4NyA3ODcgNzg3IDc4NyA3ODcgODM4IDc4NyA3MzIgNzMyIDczMiA3MzIgNjExIDYwNQo2MzAgNjEzIDYxMyA2MTMgNjEzIDYxMyA2MTMgOTgyIDU1MCA2MTUgNjE1IDYxNSA2MTUgMjc4IDI3OCAyNzggMjc4IDYxMiA2MzQKNjEyIDYxMiA2MTIgNjEyIDYxMiA4MzggNjEyIDYzNCA2MzQgNjM0IDYzNCA1OTIgNjM1IDU5MiBdCmVuZG9iagoxNyAwIG9iago8PCAvQSAxOCAwIFIgL0MgMTkgMCBSIC9GIDIwIDAgUiAvSSAyMSAwIFIgL1IgMjIgMCBSIC9hIDIzIDAgUiAvZCAyNCAwIFIKL2UgMjUgMCBSIC9mIDI2IDAgUiAvZyAyNyAwIFIgL2ggMjggMCBSIC9sIDI5IDAgUiAvbSAzMCAwIFIgL28gMzEgMCBSCi9vbmUgMzIgMCBSIC9wIDMzIDAgUiAvcyAzNCAwIFIgL3NwYWNlIDM1IDAgUiAvdCAzNiAwIFIgL3ggMzcgMCBSCi96ZXJvIDM4IDAgUiA+PgplbmRvYmoKMyAwIG9iago8PCAvRjEgMTYgMCBSID4+CmVuZG9iago0IDAgb2JqCjw8IC9BMSA8PCAvVHlwZSAvRXh0R1N0YXRlIC9DQSAxIC9jYSAxID4+ID4+CmVuZG9iago1IDAgb2JqCjw8ID4+CmVuZG9iago2IDAgb2JqCjw8ID4+CmVuZG9iago3IDAgb2JqCjw8IC9JMSAxMyAwIFIgPj4KZW5kb2JqCjEzIDAgb2JqCjw8IC9UeXBlIC9YT2Jq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0zibJvXj8dLn96OZmD31lpLy5AckxqHP7kEoCVaVxSSGCiFNjAZkBn/lXhlZbQw1ZKlsdmdS6TRZHeOjyt1kxlhIld5kvKI0lSiPN23rtBpN4TE3VqYyU+IrPmCKSBl90wQ3vfJxvoG/+3Xcb/P63a/jwG/z+j9rQv5tCmVuZHN0cmVhbQplbmRvYmoKMzkgMCBvYmoKODAzNgplbmRvYmoKMiAwIG9iago8PCAvVHlwZSAvUGFnZXMgL0tpZHMgWyAxMSAwIFIgXSAvQ291bnQgMSA+PgplbmRvYmoKNDAgMCBvYmoKPDwgL0NyZWF0b3IgKE1hdHBsb3RsaWIgdjMuMTAuMCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZykKL1Byb2R1Y2VyIChNYXRwbG90bGliIHBkZiBiYWNrZW5kIHYzLjEwLjApCi9DcmVhdGlvbkRhdGUgKEQ6MjAyNTAzMjYwODQ1MjcrMDInMDAnKSA+PgplbmRvYmoKeHJlZgowIDQxCjAwMDAwMDAwMDAgNjU1MzUgZiAKMDAwMDAwMDAxNiAwMDAwMCBuIAowMDAwMDE2MzYyIDAwMDAwIG4gCjAwMDAwMDc5MTEgMDAwMDAgbiAKMDAwMDAwNzk0MyAwMDAwMCBuIAowMDAwMDA4MDAzIDAwMDAwIG4gCjAwMDAwMDgwMjQgMDAwMDAgbiAKMDAwMDAwODA0NSAwMDAwMCBuIAowMDAwMDAwMDY1IDAwMDAwIG4gCjAwMDAwMDAzNDIgMDAwMDAgbiAKMDAwMDAwMDY5NCAwMDAwMCBuIAowMDAwMDAwMjA4IDAwMDAwIG4gCjAwMDAwMDA2NzQgMDAwMDAgbiAKMDAwMDAwODA3NyAwMDAwMCBuIAowMDAwMDA2NjE3IDAwMDAwIG4gCjAwMDAwMDY0MTAgMDAwMDAgbiAKMDAwMDAwNTk4NyAwMDAwMCBuIAowMDAwMDA3NjcwIDAwMDAwIG4gCjAwMDAwMDA3MTQgMDAwMDAgbiAKMDAwMDAwMDg3NyAwMDAwMCBuIAowMDAwMDAxMTg1IDAwMDAwIG4gCjAwMDAwMDEzMzMgMDAwMDAgbiAKMDAwMDAwMTQ1NiAwMDAwMCBuIAowMDAwMDAxNzYxIDAwMDAwIG4gCjAwMDAwMDIxNDEgMDAwMDAgbiAKMDAwMDAwMjQ0NSAwMDAwMCBuIAowMDAwMDAyNzY3IDAwMDAwIG4gCjAwMDAwMDI5NzYgMDAwMDAgbiAKMDAwMDAwMzM5MCAwMDAwMCBuIAowMDAwMDAzNjI3IDAwMDAwIG4gCjAwMDAwMDM3NDYgMDAwMDAgbiAKMDAwMDAwNDA3NyAwMDAwMCBuIAowMDAwMDA0MzY4IDAwMDAwIG4gCjAwMDAwMDQ1MjMgMDAwMDAgbiAKMDAwMDAwNDgzNSAwMDAwMCBuIAowMDAwMDA1MjQyIDAwMDAwIG4gCjAwMDAwMDUzMzIgMDAwMDAgbiAKMDAwMDAwNTUzOCAwMDAwMCBuIAowMDAwMDA1Njk5IDAwMDAwIG4gCjAwMDAwMTYzNDEgMDAwMDAgbiAKMDAwMDAxNjQyMiAwMDAwMCBuIAp0cmFpbGVyCjw8IC9TaXplIDQxIC9Sb290IDEgMCBSIC9JbmZvIDQwIDAgUiA+PgpzdGFydHhyZWYKMTY1ODEKJSVFT0YK","content_type":"application/pdf"},"image/png":{"content_type":"image/png","hash":"4cd9e18e3c3aa6d65d88f154c4018e80","path":"/4cd9e18e3c3aa6d65d88f154c4018e80.png"},"text/plain":{"content":"<Figure size 2400x2400 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"o1oZE7kAq1"}],"key":"zBDqvVzkqg"}],"key":"Uv5FJL5SvJ"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Patchify","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cdLYSYki4K"}],"identifier":"patchify","label":"Patchify","html_id":"patchify","implicit":true,"key":"eVzmJiq9k9"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Split ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"SRuL2lmAkf"},{"type":"inlineMath","value":"N\\times N","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>×</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N\\times N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"gMi64uLKtx"},{"type":"text","value":" image into ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"cWLVtJVtYL"},{"type":"inlineMath","value":"(N/M)^2","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>N</mi><mi mathvariant=\"normal\">/</mi><mi>M</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">(N/M)^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord\">/</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"AmPAxyCKI0"},{"type":"text","value":" patches of size ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"sXtrtoAkus"},{"type":"inlineMath","value":"M\\times M","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>M</mi><mo>×</mo><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">M\\times M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span>","key":"rcYndRVMl9"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"kNVLEfLD2C"}],"key":"EfXv3VPZOt"}],"key":"W8n55QFiy9"}],"key":"O7jdVfu39o"},{"type":"code","lang":"python","value":"    B, C, H, W = x.shape  # Batch size, Channels, Height, Width\n    x = x.reshape(B, C, H//patch_size, patch_size, W//patch_size, patch_size)","position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"key":"KTb2eNQbzF"}],"key":"UWS9i8tFrA"},{"type":"block","kind":"notebook-code","data":{"slideshow":{"slide_type":"-"}},"children":[{"type":"code","lang":"python","executable":true,"value":"def img_to_patch(x, patch_size, flatten_channels=True):\n    \"\"\"\n    Inputs:\n        x - torch.Tensor representing the image of shape [B, C, H, W]\n        patch_size - Number of pixels per dimension of the patches (integer)\n        flatten_channels - If True, the patches will be returned in a flattened format\n                           as a feature vector instead of a image grid.\n    \"\"\"\n    B, C, H, W = x.shape\n    x = x.reshape(B, C, H//patch_size, patch_size, W//patch_size, patch_size)\n    x = x.permute(0, 2, 4, 1, 3, 5) # [B, H', W', C, p_H, p_W]\n    x = x.flatten(1,2)              # [B, H'*W', C, p_H, p_W]\n    if flatten_channels:\n        x = x.flatten(2,4)          # [B, H'*W', C*p_H*p_W]\n    return x\n\nimg_patches = img_to_patch(CIFAR_images, patch_size=4, flatten_channels=False)\n\nfig, ax = plt.subplots(CIFAR_images.shape[0], 1, figsize=(14, 2))\nfor i in range(CIFAR_images.shape[0]):\n    img_grid = torchvision.utils.make_grid(img_patches[i], nrow=32, normalize=True, pad_value=1)\n    img_grid = img_grid.permute(1, 2, 0)\n    ax[i].imshow(img_grid)\n    ax[i].axis('off')\n\nplt.subplots_adjust(hspace=0)  # Reduce vertical spacing between rows\nplt.show()\nplt.close()","key":"TvKvck8vnF"},{"type":"outputs","id":"lSZM_47E5jFYYBxGmrtz9","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"application/pdf":{"content":"JVBERi0xLjQKJazcIKu6CjEgMCBvYmoKPDwgL1R5cGUgL0NhdGFsb2cgL1BhZ2VzIDIgMCBSID4+CmVuZG9iago4IDAgb2JqCjw8IC9Gb250IDMgMCBSIC9YT2JqZWN0IDcgMCBSIC9FeHRHU3RhdGUgNCAwIFIgL1BhdHRlcm4gNSAwIFIKL1NoYWRpbmcgNiAwIFIgL1Byb2NTZXQgWyAvUERGIC9UZXh0IC9JbWFnZUIgL0ltYWdlQyAvSW1hZ2VJIF0gPj4KZW5kb2JqCjExIDAgb2JqCjw8IC9UeXBlIC9QYWdlIC9QYXJlbnQgMiAwIFIgL1Jlc291cmNlcyA4IDAgUgovTWVkaWFCb3ggWyAwIDAgMzk4LjUyIDEyNS4yOCBdIC9Db250ZW50cyA5IDAgUiAvQW5ub3RzIDEwIDAgUiA+PgplbmRvYmoKOSAwIG9iago8PCAvTGVuZ3RoIDEyIDAgUiAvRmlsdGVyIC9GbGF0ZURlY29kZSA+PgpzdHJlYW0KeJytjj0OgkAQhfs5xbuAy+4sv6VKQizRwgMQRIlokESu7yAQpKKQ4iVvdrLfN06cv29Zfkx22J/ImaasIYNSUkCjlLQwSCQFaZkqslGoPJZ6H6thT3Eos57qlehCNQLFiLSyPmzoKsPgQAWMV44zHnC2gm2EXUpaQSaYX1LLe2c1P6CsGlndZtMD9QCWpXMwiJ9IKUXv91n57hr+HrTs57nfuiriNfw9aNlv5/7v1//tXZbd7uCmD+bIhcoKZW5kc3RyZWFtCmVuZG9iagoxMiAwIG9iagoxODgKZW5kb2JqCjEwIDAgb2JqClsgXQplbmRvYmoKMyAwIG9iago8PCA+PgplbmRvYmoKNCAwIG9iago8PCAvQTEgPDwgL1R5cGUgL0V4dEdTdGF0ZSAvQ0EgMSAvY2EgMSA+PiA+PgplbmRvYmoKNSAwIG9iago8PCA+PgplbmRvYmoKNiAwIG9iago8PCA+PgplbmRvYmoKNyAwIG9iago8PCAvSTEgMTMgMCBSIC9JMiAxNCAwIFIgL0kzIDE1IDAgUiAvSTQgMTYgMCBSID4+CmVuZG9iagoxMyAwIG9iago8PCAvVHlwZSAvWE9iamVjdCAvU3VidHlwZSAvSW1hZ2UgL1dpZHRoIDE5NCAvSGVpZ2h0IDE0Ci9Db2xvclNwYWNlIC9EZXZpY2VSR0IgL0JpdHNQZXJDb21wb25lbnQgOCAvRmlsdGVyIC9GbGF0ZURlY29kZQovRGVjb2RlUGFybXMgPDwgL1ByZWRpY3RvciAxMCAvQ29sb3JzIDMgL0NvbHVtbnMgMTk0ID4+IC9MZW5ndGggMTcgMCBSID4+CnN0cmVhbQp4nO1YaYxdR5U+td7trbe7n1+792532nbaS9xpmzAm4JEzYSLGKAkTwSSDRBIiRQQ8AxIMEyQE0sxoBAECWJAJSyAZEwcSQhgYD4ltRLzEjmNsSLBjB9vtpd3rc7/93aWqUL13b3v4HX72aalb/alu1T3nfLfq+woppWApluLtBX6bzy/FUgAAbf351s6nXzwwnc6kPK+488v/BAAPffGH3DYREqsG8vffsQUApkrltG1KqQgGk3IAmJwv7N5/AikyOtI1vmoIAAqVsmkYgR/OFArDPd0A8N2dv3jp5z+beONEJpX45f49APC+zVvyhjxZAbDaDvz6OQDYuPn2fHfXg/ds3fLOZaZ7EwAs7xwWCnf19XCWeGX/8wBw210PMdMybcewrB9+9TMA8NF/ebS/s/0jH/qbuUpx7eAKAPj0l54UQChWlJJ/2/5BAHj467swJgyTtEm237sNAB7ZsWvP//7syOFDoZALhQkA6OsfzaWTM4WyxPTixHGNDN7Q3z/0wH23b/vb4aS7EQBCeRwABTUBYcPKvBMA/OIBzAxQUK010h2bAeDUyd1nLxR2Pfvyrp3PNypXAODWW+8cvH6sJgjn7PEvfRIAPvbZr3NG7YTJw+rn//XjAPCpBz8tFLLdTHXu0qP/tUMj994BQkozP1tjTz35DQB417vff9PYyEMPvTefd7i9CQC8ymEhBKYECTBSGmlUjyIhlJJAsJloIuVXkATEmBK+kdRV/eULO14/NbFyZHDrljV26q/0POWDCBMMHgChjkbCyhFQ8ObpS4TxlWvfBwBXp/eZFmGMASLU1NXwqodDqRAAQthKbLxGo3OnTp088urw6Gh3/0gL4QZDGKUtvu46zQYAcDgJ/AAAJIpoxA3Wl0vn825PfllrDCM08APfCyA+KzEhGGOKiYGjtTjGiIQIY8pIC/FKM5R02UkLRQBgSpNuZ3tXr2lmW0hbZw8zHcOwmBHNk3WzN6wZzmbTQbxW1/L2q+WAU0RINFHCcaRSWcdOW9G+yyjhhLRnXSDRU21ppydBLl2qLtTDFnLh/LlENks4R/Fmfe6tybnphfHx66r1wGoiM3PVyekr56fKfzxf/uwnNY2++b1jC7WwUKI9y9taT1UlEdRMWjwUooWEQcgILRfLJKi2ELeri5tUCD9h9Ud5da4O66ViAKaKlncsXrw4E9Q8BXYLIZhIqUAq3cxWKCGlwAiBvKZSJEFEwZW5Rn9S/3votekd3/qJCrwfP/OFrbdo0ijCr5brXt0jEroH9Zipherrb5z/1f+dkhJ/7WuaRt974pVkirvtzubNq/OdzX4JwRhBoV7gz3Yjij3XaZx+/VB7e1QCiZUB4drhwRX9+RaCWj8ILxbXIPSGNcOWxSFOmDImwlAoL4RFGmHMDYNxi7LoKUYNHpgmt9PRWsxgjFLOCYrbv2Xbtqs1y7INSqM6mW4HY9zkjOAI6VmeWzs6hDBqd9MtZOVQ16uvX0RYf8xxIYPejszY2pGFUnGxuIQQm9GEzSOqGdzkyO1IQzlqtpvOcULo4koAz/341zuffukTn7jzjZOXv/KVdwPAFx7dXRem52FARmvMTEkghNetHLrnds0qABjbeFPZV0RIHIsHTClhnGHLSDpR9w2nVCmqMORWNA9K5pmTa8OqLc5i0zvGSa2OMCYopghGhDIlw0VpixFSWLMoLryeSWECCA4c/F3/gD5P/EC4be65s1M7nz2+9RY94oldv19YCJDCnIT/vF1Dj39738UrV31JMI/e5/d/LBfnCvPzU8eOXvz3/7wZAL7//d/kc6nxDcPd3e1/RqN7PvjXSImf/s8hgqOEucn6OhIb1g0bi+nh1msCav7W7eeMA9OvHdcbIUC6+Iv117uRaZhWIs2tqHCOkUyainvMq9WiQYJQSoHoNVrA8Kp1Zy5UpV9tiEo0DyYIkBTCYhEdV1/X62acwA8Zj7JoT1sEKwTYNqJ5Vg8t3zA6nGtLnTnfiDjECCaYgDRikpgEUQSmYfTnog9m/fhGX/gMAMW7yLETp//w1vSO7+wR0mwhZy407CQ3qCK4HuUuA9tgY+tGlvV3RYhhGxQ4p/pEaEamvY0ywgh3rGh1yq0Tx16bODuRTqfgYY0cPvRqJpVxEpaViNby/ZBRfmGyurwvG6WqQCmFEFUQRCWUUp9OSrV6pGemSFA0ebnwk2f33X33dgA4e/rcuvUbVo+lPZJpjTl4bAYRknMzWHot5LcHXrOsVN/q0UBG3XHTymRpO8HffGuuhezZ+2ZnLtPb3dHdHZ0VaMmpLcXbjyWnthR/gYj2yLB+NPQFUggRzJM3Nr3AUVD6FFGEGAmNNOonQDHAqRDshOkCQDmsYcWUAgVhkmvpWQk8vbuHolSuduf0wfnc3sPlhYJXKRPK7vuH27Vke+YXzHS4YSDM77plDABe2HcCaDDaD51t2LI36PepHg2Fr7AT8N4U1zvn5OwZGQbl0qTt5Pq612pndPZlgxrVymStNrfxxvsB4MjxpxqNAlI4aefXr/sAABz/7dPEcpd1bqrWGwNNH/DMnsOnXjlUujIxNz/1xI9+BADbP3K3m+WeF/qh+vJjTwHA5x68wxnYdNvf3byql3FH5x5WjwZheODIbM+K9SMDPboaIlCS+N6CH1Y6Mr0AcGnmpGO3E8RKC5e7u67XHqc4TSlXWlGqlK2zKFan/QAaPvL8cEX3cgD4790Hj/zqxdrk5VQy+cjjjwDAh+96YL5auXL5isnh4JF9APDAP364Y8XKO9+/eXSQ8ZT2XGFw/MW9Jx7+3A/Gt2577D+0s/78Yy/c+o6RDaPDAMpsSsyGCAHpI16I0GZamZRrZW7YLRFiYj3GkyIIw2qttlCujPTovJ58fu/+l15cmLzckWz75g++quvzgXuTaGr/xWLVx68eexkAxsfes2ps48c++t4bVqda9YlopPUOkvrIRTGiQzYrEAk9JAOABgSlpsbWNo/4EwpnEE0iFclVfWaDJFT7swiQ0rTTRiKDYtXltOURJoTglBWdp72d0k1AWwZd2x0RaO+qQgp+C8i6fVJCKtur8Wbkcqss05mdNZPppscAGOi/eWHhcqNeoChSFQ2vYnFHN3JR8gNKmrS922xLRfpgqDeb4mT2arEeRDMnHFOBElhbijgvX4XBypHedHuuBRSuXhCibtA0IZF25NgJdbJ2W26ghRh2GmOqEFoUDsx0gYRBWFMqyktgyU2S7+lIWtE7g1+qVq62dyQtHvsgAzHKtOONdQ+E4Y1r+zZtXFv3Ik0z0Ol2daaqlYKE0ExrkVevF7UIBCykZ7MOTev5sxm3hzBLq9smjZRomVNEY8uHCcKUYIPTRRNgWnMVHijDaspgPZqAY2KECMQ9jUkjhdLqDMtYVIIUSEkZ+lp/RkigO6uA0GgMCuYVKgEkQCWA9TWbVFLYJoij5o2ArkmoEMXMMFg8TT6F7KTIOMKNZeZIt8RIKKRZvEhrDFQpocIp4M3bhGCCqAQmtsCRXGVWSihIZwbxor1PLnMSy4SUleJU3IC02zGsSRR3Uv/BqFqrtrdFNEpmMjIMkxluoeidrdz1VUjoDjRr3XxMf09uhlMjIs387MlaccpJ54Tnta3/e22VLx3Fhl20OxJmxlqmb9Gq1QJnFmUm1pcdeipde9x0VLGZoIAopYw5vLlhNO9TVMpSbsaRIqI1hYbBm24Px3xUkE4Y991/294j8y1gfM1gwqCV2nylcqWjSaOp6d8hxDhxEBLZhKZRuTLtiTrBBsG0r3uN/hhmzmLuAE4uFh4jrJQSgBWJquEBrtg92R7VmDvXQjJO0jLNRaf1/2ikBMZIX9RF9NTbQcuua/fVDIJIZKbi/YBQU9dG1gGqAE0ahZcUzSCSsLnQ9AIY6bcp8h1T2PHHtmHI5xYnBEFcJta87EAKVHyXoxfFhi62it4HRAGpAgSc8CRQfdlIVFEpGzNDxjtNoBRRCAFxMpHn6h96l2VnvUbQ/C5bdVJud26yOrtQj8pUo8uVyblr2Sy6lVk2sD4gNsUsFCIuECaUAZFCVoDovLxGiTLH94pSn+M66vVZIkylZLFwMt+k0ZnTuw2eSiXzCMOKAX0LUCpcxMxG+FoPmjseWqj6Po0y9QORtFjWUo04dYtIRLG+9r22PWIJWITe6FCUaV+XiyRSEMog8rYUMcxMgpDvRZ7LcdxABH5QJjGJG8E8Ej4zjUWPDIgQRKUvvXj5AFFiGkFlplSLPGkmYzNGMQYcX0ksObWl+AvEklNbCnj78SfEF9jVCmVuZHN0cmVhbQplbmRvYmoKMTcgMCBvYmoKMzIwNQplbmRvYmoKMTQgMCBvYmoKPDwgL1R5cGUgL1hPYmplY3QgL1N1YnR5cGUgL0ltYWdlIC9XaWR0aCAxOTQgL0hlaWdodCAxNAovQ29sb3JTcGFjZSAvRGV2aWNlUkdCIC9CaXRzUGVyQ29tcG9uZW50IDggL0ZpbHRlciAvRmxhdGVEZWNvZGUKL0RlY29kZVBhcm1zIDw8IC9QcmVkaWN0b3IgMTAgL0NvbG9ycyAzIC9Db2x1bW5zIDE5NCA+PiAvTGVuZ3RoIDE4IDAgUiA+PgpzdHJlYW0KeJztWH2MXFd1P/fjfc2befNmdnZ3dtezrHdjO15/b93YTRUnID4SVVEIlgyNwDF/lECMm0TgkDoiMqoa0jQoCQGDQZSEtAGVUAItpIWgpjQqIUBMnIigxI4/dte7652Zne957913763uvjtrV/wZ/twjS5Z+e+99557zu+f8ziApJazaqr09w29z/6qtGgDQ5L8LL/9HeWGhWVviLNqz/24A+J8nHqCOm856fjZb2v1+AHjzv7/TaDRNSuNOZ8feg2rN8fvqiwtn3jo9d7F2/7//GgAOvXuqFUSArfl6+9lXfg8A28cHbrz1ndlhEkXRkYNPA8AXjn8YAEvOpZSHDz4FAI987VaTACUojsTtH/sWALzx06fL5YVKZaFWr37k3i8BwPEjtxoU1o6uyabcqVuOAMBL3/hcM+y8OT39+kz90Sd/BADvu3rHi7/4bTqd2rSp9JMX1dev2TE6dIW/bvOQYfKjf/McADz81ZtA0E6bIUSOfPr7APDgw3udlB1FTAhx+A7l4bGv7yeWgQg2DfPAvi8DwEOP7ROCYQKGge+47XsAcP/DN8QSL56fIzX5yOMnAOCv9+55c/rcht2Da9YNfvrQvwHA0c9fz6JYSmQa5tF7lYf/8OiHEEaEAIC86/bvqJO/tC/l2ISSTrt51+3q63/74HswoQalGS/9iY9+GwC++s1b6q1OEDIp5dHDPwaA3e8aHir2WTat15vPfu8UANz04U3IlCSK0pHzxL+8CgB/+d5d5xfn1mxx/SHn+N+/DAC3fWZXvRbOzlZZIF58bgYAdl47Ig1SabYER+d/XQGAiV0lKQiPUWWx2pqpA4DRbxPDpMQglNbPLABA7ooRSimAYCyonV68RCMRtolkCBiof8qwARQLA4SIggRhQZcKgUEAFgnieA4Bv17NXrhwMUEMEBmLIoJS6VyCrB3KN2cW/dTAYD6fIBmaQhRxyVdKoZd1sCQEqDR1hzVSlptNSxQ7lpEgE2Nj1MT5XJ/v9ydIdmiMdptThcKGrfqga3duisqLjUojE+mTrXr8ys/PIuRefc2EvleMbdsu+MOUqmQCQMp1eBynHIf0ECdlxyCDIOIxT5DKueqp0+exYfQPDmhkDjkps+iNpCz9rfHS4PTchYsz7eKwnSB+Kl+Nap2gHfZiuFCZq1Rb2WzWsvS2xWrV81OmSSTTd7eIZ1mGYZqI63sZOFXIZ1rtoF5TeQUA27HMlM1FbLlmghT6fSbjNDXcSJ+czWasehVJbDt6DSGiUPCyGf/cGZ0v07RGxkb8Rv3cmbkEQUKwUHAGaddPkHy2KAEYY1gifQ7HCBNAZhxqJmgaLc3PhSzkLGC8RxreoTEWjDGkr8c6bYQQBdJgek0zaFFgjmv05bIJksu6UsQCgGOdkj4TtaYvLkTc3expJ0IbCaAWYihOEC4JCAIcrxCLuJQyS7YIMXVKTCuNDYwMF8yMTnZ+MKwSHkDB0bsmR/v5zitr5RoB/fXJNUO4HPzyv95kneCOQwqJAgNjGfE66JgAYzEXUoQRBPqmrXYQC9bpdk1TJwA1aFzF56bnXmVz8JhC/vO7v7Etsrbg7pnalKwZG8idHeg7+dbc6VMv3HOPQk786vTk1olCcaDLWjo+A77fX+ARbzSavauibthF2MC9XGCKsUEECOip1lAlQQDiWC+BqZ1XEAJCxN2greNcsCRK1+fKUaCpH0eh77lrRwsj4/oB+77TqHcB0NBwOkE2bhxyHKNUHB4r6KhOjvthELNIRlw/4NERl8UMwHRdN0G2b10jEG62Op2WTpj2q3JhthN1Ax6EsX7I9caS6Zs8CrqRjrdgjBDcabNytZwgZ6fPoXaT1ZqFvKbI+OhIu9XsBi3D1ukf9tPlWqv6Vnlhtvvxwwr55fO/sz2zUMpn+rVb83M1mzqISc51LaTYkAJJ3uM/AEYYqQppqGqa+CMjLmPTdiEKE8SznPHhgUUK7VATFCyUS6MJ4Z95bT4BXnphdtueCZlqrlCtzYWIhUmxQfU75gJjhDKuxSL92q6/9obN6+feeONUZamaILs3jYOMRou5seHBBBnI+2tHBtpR961yJ0H+94U3pqebO/9sKzH0PToVo7gm08W1MNAn57NOzEWz1uZRj8StFsIZjNAK1ZaWlrycL4Rw3ZSO6mCeGphz1mz2EqlIZtYr5aCj0y9ZyLptFmbadX2OjIRNKcR8qKRr6rqJEREzkLKQ1W9xassYY9yyLWTok6//i/FOqx0EYbGod9144/p2ENbqLdljOlqd1Fbt7dvqpLZqfwTTHeKpVxrLxVxKkPt3KG31rRM1QBxAIkAf2d4HAN9+rRZzDqqQ0f3blRh6/ERTLUBISjiwQzXXJ37blBKrTQAHplQFfuJEd/kLUmJ0YJuqnI+f1NJKrdmqet/jJwNJECC166OTSo588OjTadfO+x4C8eBfXQcAn/3G81Nr8xPDPqUwecXockudLs/PsjC42CE3vfcapVd+dVYYThhxIqMbd40BwD//6CU77ZneAEXshu2q+xx/8plOHJauuo5K8v7NBQD4wS9OxUCsTKYT833La/719TrGFC2rp5s2qFu87+AXKTEJMTA2nvnCfgC4+VNPASLIwFyyHzxwCwDs++xTHiEeEqNo/s777lIz16E7lyJZKL3DoObhez4JAI8+dGxh9uzM2bO1ytIPf/5TNSd+5t4N6ydef+33jTC6/9gjatfnHsyOrksXR7HjHLhuUvlzYjqMudK5UXjrn28AgCcfOtAJ2hFXbf3Oo2oG/MoDN9tm1qaWicjeQ8cA4JljB9thd6nbrDeq9z7wMxXDT+4hLNWudjOWed8/qa9/8+4PmayNOM8Xi9cf+UcAePbzt1VrQb0VzV6s/d13nwWA/e/cPV+rlTaNrds6fs/d6uQ77r455RhR0Imi4LGHn7tEIyZUa7u8vylAYlDNT/f1SI0SRAixIk6FlFxKihWNEuPqj0hekjQKUaaopivfZYKnt0Yi4P8P3LZ1fd73crl0TwjBzp2biy5BKKJUS0jGeIQNq5DPxlrTOJm0QNiyqOBa9xRGhoUkIcKh0FoEe9mRnC9QKpT6bJkqIARtISXVqiJGlABBPYeVh0YWUzXzAu4pRRMLYWJkYFOfQw1wzXAkY9BO8nIAee5ocRvxSs1AS+x2erAcnr3hAx8oz2utttRoUzu98U93nTlzOkH6vFQ2Yzspw8xo7ZgyqWPagLHgWsE89+pJIQRZtgR5+fQctusGEAjZ3mXkJ785GYJoywgJveZUwzAMj2QGQ6wTNhuZV+YdEnbqDa3nLpYbzS6vVJoY6V0WTdWbS1YFcks6Pq2WS+1chBnDWknrEMSxAIyW318vTCrZy3HU8YeYJYM+EahHLJVQpImSpFaq9ZfTkQmEMAJ5SYPFf0AjhcgVciqbGF9DkKREzZ8JQpAsh8Qhdo5qpMkJ9QZi02YdLaiJY2Zsi2Dc7iUy5WUsgpsxdGIdgpGxNUiYbWZFRE9hAbIlhpizSzeVivToso5PTZtiTNVPPr2x3CARIExR2tYx7HPkVMndWvJ+9vw5TaP8BjK4NsZ2xtKXcwn2cm5hbHjDlesSZMvG8YVyefTq95T6hhPEyQ0UBge5aa7EOVYZRRhjhLXPL55s+JlcX99gOq3H8ibb5KRdbuAo1ndv0S2mZdOYI67HHW5s8Qr2cH9GNvWauTJqXJj3zNhJ6dnt1MzS0lLLtB0nX0wQu3Tl+pFJf7RU7o0yPDtR3HgVj20QvZFIO6pe2SUOJQgAAXE5ojKhilQPEb3tK8YU8dWYs4IIjJNjV2jE/oBGTCICqPdClndJxeNYcUsvbnEkBW8y0eRyxzIyzywuJeIk7P2+shTRLmBKSJdp0lQCZBIsMAlVT1DWkT4AiYTgECfXZ8pDKRFdmTtijpd/fLjkkEUxVR0M0V41ci08ZCMvjV1Lv9qrJ0fXFy2Tt7w+PbuNjE8YWT8SJGP06qVtj2/YFlv9oaE9dAdLF2Zm+k3LKgzplHiFQBq2ne72fI6BEEyWH7a2vrFrvEzBcX1MdMXi1pY2wpRS7upqLf1txLTcKHa7uhaWHC9s1VqybYte4iJ5fr4zN3vOMq1PLQOLbZTJDZXLNWtET9/r/+Qqkc5HltvoajUyedW7rFQWYccg2qXVSW3V/gi2OqmtGrx9+z9CtVwECmVuZHN0cmVhbQplbmRvYmoKMTggMCBvYmoKMzEyOQplbmRvYmoKMTUgMCBvYmoKPDwgL1R5cGUgL1hPYmplY3QgL1N1YnR5cGUgL0ltYWdlIC9XaWR0aCAxOTQgL0hlaWdodCAxNAovQ29sb3JTcGFjZSAvRGV2aWNlUkdCIC9CaXRzUGVyQ29tcG9uZW50IDggL0ZpbHRlciAvRmxhdGVEZWNvZGUKL0RlY29kZVBhcm1zIDw8IC9QcmVkaWN0b3IgMTAgL0NvbG9ycyAzIC9Db2x1bW5zIDE5NCA+PiAvTGVuZ3RoIDE5IDAgUiA+PgpzdHJlYW0KeJztWN9vXUcRnpk999puqjqFkNiQBkiiRk2w0kohDgmKERJSGhXxQIOrFoQED/wBvPGGkPgnEEUgtUooUhGNKL8r8VA1UAmpIU5TOaFqrbqQhtrOvY59z9kZ9O2e3Xts10lp/Hjn5e7ZO7s7M/vt7DfLZkYDGcjdidzl+IEMhIiK+HPuctfMmJjIpg/eS0S/utxpiQJoLF99ED0vvNFhIkGnnd4/SkS/m10QZvV6c9WfmdhBRD+5MN9durm4eKNa7f3oqSki+sHP/1zeKvd8evdn937msQOY5/yVDhFVTJ706w/eh7WuLBoZqanx9MHtRHT2ckfNE+yhJw9C5+zMEj6CTIeeczNL4cuCzRh1bmZRghILP34gzPxGh4y890b2RK2zQCRmxLxmHiPStNazM0tmZoo8/c2JYM+lRSJy4ojozEPw4jlYiPiY2ROHRrMOM2+wkD5CD9ZXezKs/uzFhahgxE9NjKbV6/hsNs/ZS4vRmC2xZ5Memz442odRIRxiwtGy+EcLgSVGhCERVQBS2k9T/ufrs9f+9eb8fztnJr5NRL945tcLN94jX3556ljUGRvbWTCPj+8q6qXIuYhOKtN9WjB6PGny+sOLuTA2z1Mbl+Zx5INPasG9MMILCSmxqzOxCynZB2ezMDM7btz4rGSIEdejIoY+wCDq53i/4d/YAwP6+hIAvG6G0JUDjd2J3U0GcodgRdBvZufWSDKn3lvHYhIinv5wjkJywsluDhSqinY7tt/vrvzy/F9mXn9TtaIfAkb/uPD3HTu2n/rKyZNfPBp1Hjl8yHzlVdXXUW0XcM8zMc5TMKIQJCL4TLcJk6QtbHxqAEMdKSfEARSaJmJSgB2JNkOWHDsunGkaFRw1kry4sMTo59NMIhQdSLtiyT5OOrHhSeBJrSMGA5D56p7gQhNefgMYYk8MfooEI1tvkHUBuU3n3UuTQ+d2CmGGkagqieTY4tSt8SRYKKxs1dDQPfH7nes3rs79+6bS9uGR2HPs6OEvTR098sjEPUO1M1beMrVCmAAeSCs00GG1ThvZAfvjNz85zNJPg8maaFI+3C4h0SXNwomwoxaVVb13QrbcXRaRkZHaZmGO+SEvzsDROkzf8fBnUU4DmTQcRMMSQWIGRKyzzoZskYf/X5Khn9PPluehfDhzI0szbw9kIB9RBpXaQLZA6kvt6ddWTGvm/92HcWf99LUOkwcDYP7OBPj50xfBz9uiLaHph1BBPD+7OFzwcKsYEjk+PkxEr767EqoXFF2Tn9pGRC/PdSoD7WCikw9g5r/OrTjH4ChkR8b6owwFFR/fDZ1nZpYLtuEWt0Ue3QudF691zag0Lj09fiDoXOqaUkuq4RZ/LVR8f7y23G6B/RQFTY5B52//WY7mmNmxcVRYr8yjTowSey6828UtFijFkU8Ee66vxEtBvR0bhxfnZ7tDQoWYqJ/ai9rkpavvQ0GlMn70AKLxwpUlVxQjhbXFTjwQ1ppbKsgcmXdyZPy+zezBLCLMPDm2rWmPN53cCS9eme8wsVdvJid2Y9Rvr3aDB7hJTu9Dz4uzHRDBIKf2Y60/XO3ilqeV4Xu3ndgJv77/s98/95s/Hf785MT+PT/+Bsjr8xev79xxP2vlyMf9enW+W/n6Ojwe1np5DhHzjIBM7cbML729ABe8lkan9n28DyMExPqVQS2BcedbLzaqcN1HqTx5kcqkSMShCmRVVXyiz6WnqlZP9QsqHtCRfJtWgZQqucw9UaB7lNxlKsSWSzAMb5YNMGYV82qJ9lCplfOuaPUtrBmP3ZHYwLasA84FwhwIcrRQqV0wqHLYGQxwTj1XsMeS76BTLaO6ooUXIoLzsT7rfwgigUoxjZJAqRy7FFSSSNMbxDtjqDEF9Jhdr1wlAozee+etz+0b+963To+O1Oz2k7vut7InpHlq9qWwNGvJIngs0meuBZEJ49FkHcVm58R7DO/bgEK5WYEz6gVSIZ9qgZJci9gZsFIHLhBpBQmrV+gFqNVMNoabUQVygG6ahwXBV03xrTxqt4wPIupWqNBhQNLxAFJ4A0oh8KTGws7lmLJaZPa5dmCvxm4NYTZQYZc3DUHBYeCQn2t7jCqVpg5qQhZy6tNWVqh0rWq8iGhEVKDZazeYm0gKWLsdtDJ9zsun38Ykoa1r/ML7hBPWqowde/fsevjQvo8VvfDkEpDkKyYT7Kr254E9/XnqeiXUM7kHz1rpxaQPI19V2Azt/1F5nK6mM1XcVWZztfVlr1qurCrZY8YhJNDVnohT9WVV56BVtGIwk85KzyFy0XS8Hdy61UP5XwNrKAe7WRiXnsqwrS45k9Jkv7LRcBN503iAglJsGWKV1XCIc1WOQ+YEnf1BmBHxyLWOV15VZXG53qzIKUACuNcWmlhlTpXbbg2MGmvdVtbg6INKH4uVX3xWcKQuvlQEcVQpHHHh2SZYaFpowexaCdYnj39hqOA2draORjxQHk92tc0l0sIa5HuuDwb3CzQ8qwFwKRqDSm0gWyCDSm0gdPfyP0ZOwDEKZW5kc3RyZWFtCmVuZG9iagoxOSAwIG9iagoxODkyCmVuZG9iagoxNiAwIG9iago8PCAvVHlwZSAvWE9iamVjdCAvU3VidHlwZSAvSW1hZ2UgL1dpZHRoIDE5NCAvSGVpZ2h0IDE0Ci9Db2xvclNwYWNlIC9EZXZpY2VSR0IgL0JpdHNQZXJDb21wb25lbnQgOCAvRmlsdGVyIC9GbGF0ZURlY29kZQovRGVjb2RlUGFybXMgPDwgL1ByZWRpY3RvciAxMCAvQ29sb3JzIDMgL0NvbHVtbnMgMTk0ID4+IC9MZW5ndGggMjAgMCBSID4+CnN0cmVhbQp4nO1Ye3Bc1Xn/zrmPfb+0u9KuXpYtJGzZFrY85WUMGOOQmDYhmYTOAGloSAZoO9NASdqZpE1oKDAxNC1NKG2hdRsnGNNJmtYJwbLjIIdiMLVw7JGtt63HalfSrvZ17969955zOufes7Iz+ZP8qW93Zkc/nfud833f736PgxhjsCZr8uEEf8jn12RNAEB2f+a1CkZs5dL4/MSFvR9/AAAOvfycVi7/6MjRmfmFX41eBoDbd/ZnlszsohH2s7kMR26+YbtmGJGILxHz//DHvwSAO+/YUdXNxZwmy/LY+BgA7Nlzm19l13TEKjX95e8NAsDgyWMbOjr10nJ33w6/4gGAGiGE2IZh1GpGR0sLAFy346a77/n4Z//ggWgsmg6HAOCdUyeXKqZuoBODx/7phacBoLf/egXkj921O92W/LMvfQkAvvjoo3PZhWi0KRaNvPjtbwPAX33zaa1azmYuLy5nB984AQC/+4l97e1x5A0jqf7it14GgGf+7quxREwzTEKUrzz8ZQD41j/vJ5ZObVyv07/+ytcBAOEkQqCqUjDgX16eAoCu7n6Pz0uxR6/j+dG3AMAb3bDvo7c/9c2vhcPe9pZWADhz7n2M0OzC/Ptn33zyie8CwNf2/0m95q1ZyJdI7//Txznyj9/xYMmuF+oV7dmvcrv+4sknZBVsi5g1+2+f+QcA+PJfPkrNWrFQ0nTt0PeP8vOgptUQMlbg+UCKq6pCCLVtxuiSsyYeDPl27hrYuq1//988BQBHjv580/p0VSut5Cu379kLAMePD54ZPnn63RN+j3rg4HEAeOihfRYFRGjdrB86xD123/13BH0qoxSQ/i+v8Cg/+MBAuVIvlOrEwiffHrtCI58i2TazgEzOjnL1AFVNOz8yncmV4vGgWKMqxZViLOLp7gq4SDSEQn6vV4KkR3KRrZ0hOeC9vKDn8lUXQZJkMxyNJkDi1gJAeXluxYvb23sVRRGeQCDLOBgMBHxC85b+637vU/eoijz87lB6790AMDky8s7wryixpycuivPQclu6o17ND7551qXRmeGzWq0WiZRikai7Zmpquq2trefazbEo5yIA9HRvjETwxNSYHBB7Var1VIvqC4csQlwk4vdZRDJqrGZUGsGiXp8SCoeicc5yAGjp7KRYUQMRk/hcJJhsj8YS8aZosbTsIrZtS1jNZnJ1U2j2+xWJIcsienHBRQy9Ekq06JoBkvChEvCpqqpQsGjNRdRAyhcD2VuCJaH5N4UxRpzzI4QaXkXJZKJrQ3dnZ5cL9G3s8auSrCoe1esipWohs5iLxJpWPd8UT9Ysmx9+peQimkEQppFwSJYFE2Q1Eg2ZxCpWDfPXspEHy4xqZy68fWpk6BEHmZyePndhyhfw+L2i8JXKBJjUmgrHY2LLa1JNCiKqhCUcFsTyNyHJ3Nge7lsXd5GdAxsuTuYJwzYV5hWWc5t6+2RvyLJsRVEdFlGEgH9ksWb3nR9Z17luavTi4cM/3OfQaObSRMgDHhT8oLAinCvJqVRsYWFufi7jIpmFZYSxptFy0XCR6cnLhULBsGyznBfOtSERXzc2cgH7he033nz7hs62umFomqB+KtGSzS8qQRVhYbvHozS3NPmjiaa29S6y6brtXd3XNLc0abpQvOP6W8KxMJagXhe712q1pcW5cklPxEQgEfXW9RIzSa0g9qrMXmqNJxAljNZdBMteJGOPqoQkv9g9EPF6wGZYqog1rjKXPw3OIEooY4CwoCMCCEdC8WTzwPYBF/H5ZKOm63Ujt5TZCNsA4L0zp0t1IxBJ+iJJsSaalMyaTXFEElFW/RGTZ0bbg3jpAAACHoapPxTD3l+nEUJoLjMx9M5PKobIGYpPkWUpHY9hoGKpz7u5L5xIBHvXi3e9e11LsVgPx7ymJfIKk4KI1mWZhkOC76m4fyFbKlX0ZKrdRZqTrcFw0rSMABJuQoCx8w6ttvs33HK9aVQsLZ9uaXaRRCy047qeNwaH8oVGhsDsrbeHsznNJuKxykpVkrGiGMTUXOTS5WkyRRAl6ztSLpLLjS8uTdmmns+J+EdD4bZU96WpkZ7uPhfp69vWXtVN09J0Eezm5lhzKr1r794bb73VRe6+a1e6vau1tWV2dkm8x7HgSrm0nC9omqBRLrc0OjFpWdTrFQGQWXOlVJidnVlNGXq+sDg7IXkUqy7OgwhRPRLCNBQQb7+iMMvSJQkCfv+VphYhhJjUILrqUVRZJpTaIvGBJOFILLJl8+Z164TnazWtXtcLxeK50TO7b9sHAMVqXvX4LKzIEeFnNZKmeoXVDQ8VdEwm04zVGLVkLKLsCfjrmo0srDaqEFqb1Nbkw8vapLYmvwURRW3Xp5N8HJEYwuwXr/I+bs8DCUlCCPNsdfQAR+56MIEx4h9AR17J8qnnCy0MgdPXw1EH+cjn04hJvKlHcPTAHADc+0i/YdlVs4oZOnaQz3e772sFSjAApXDicA4Abv10AgFSELIA3np9EQBuu9fpZBFX9NYhjtxxfzPGDEuAJfSzVzjysS8kkS31t+/e2jNw/+f4hPX6q89XNapg3NTk23fPHwHAT3/09ydPjY3PZnA4c/ildwHgkw8PpBK9lWp+OT/+s4OXnPOkGGWUMYboyUPc0l33pmQGjmkwdJjbdee9KRsYQgwjdPwQP/Oe+1KUQmfy2m1bfuexh58DgIP/8ez5D2bHx8dSzdHvvvI6ABx4aX8sHDZrNcOyP/vIEwBw+N9eVCSCZQKMfuJ+Pqm9euDpYDwZCav/c+L1/d84wm3//RTCwChigIdem+fn+UyrJClBf3xDR98LTx4EgMVS7l9/8Pzg0Pd9qvfIv08CwOOPf0YmsWJp2azVDrz2Bp+5PvfJWCSmabVowH7mBX6eJz7/0cnpcvu6SCIe+/rzPwCA7zzzDRXjqcvDNiXPvfTfAPDUnz9cNgzJG+7t3fCHDz0GAP/1n4e2bNve3Nbq8wUVpyGrU8IbeefjIiIbYSwhxHi1bdRsxhiljBJEGq0xYQgYL4KEiW7JZmBTIITRRj0mNrIJpYRaJu/2AWCptFgxKoxjAmGUUor4g41yygMI1GSENjQzXm6dnm21heRRBCeQYg3mLbk9VXj//Ql+jwAAp0aOnZsemsycnV+acZGLc2cz+jlv3NRJ2UUkSaLE0q2q1dgLNRyBGpYiznBGgLLGGlVGEncVW+0BGKOSBDOF8R//gseDX2QM/aRSXNx580DXhg4X8fs9ulY2qV0nQg9Biurzc8Y2eprenhsHtuwsVaqjM3xydgyjfG9iyw3b08lUS1NTpZwdPs9ncucq4Z1fvvdTRoleE91bjaxs2nytz+uJx8Re67vS7V3rI7GwaVguUtVZftnIzJcYiOky1Z6Ot7bFEy0zmUVx9ZMrd67vSDQHTEu085V65fz4cKmUt4loqBFvZXlkKG30zeLoDrMcFjV4xNsmJKIpHAfYMd4ighCEMt7osiutMXczFd+rEJPTYlXzbzZjDlmYQ55VqhGeClcB53nneyWQfL5DNasymT3nIuO5YUBUAe/IvOeL8CwADJ39eR2YjAOqpIpBPRQt69mKvrw60Th2O+obB8OcPtwsCYlg8yGIc4sfoLE7IpRKEqGScGWB5Lb09Hn9OLskgnQ5U+to8wRVhTbmslBAMs2CLGHFzy+W+ASaLZybHj4/MkhsMRZICDOJDx3QILGEZczvROTVF+/NE6+VSlmPKvOc5chSdWFhZUb1SvFIwkX6+7cadmByfCbgFa26PxTuXi+HI2qzcznnTLvE4w+n093tWXGV0NHReu2mTVNTY4Ymhq33zh9bKM4NvXukv/+mBz/1xwBwYfKDztZunzfo8uEqGlGpESLxD5cqeHVOcxDb+cthz5U1V9PIyUyEc6gBEUKdNHKFj06InIeuQgRNGrtzDZiXlatYJGi+Ki7LOQWvKALEkAEmJeJNMpkBoNatquoRVxIhf6hqaDax3NlQ0Ah4qW4kI8dwAIkhvoMjdUItzKSrtnc5jTBIsvBhHRdHs+cS6sa29q0uEktEQAKTmiCL2U2rFiemL8ueULxN6Hnjf7+XL2Z8KlEkoWfVnwREkl8uLmPKbNsEJyUCwMjF05LMG47VQK7o+dOjx7d2DAxcf6cgRGf3qdNnqtVytiguO6o1snn7NelE1BcUt2icnpYeCgVvumGni3T3tMUS0XVW5+j4WRcZu/R/mlVayk+dnz7t0ujZFx7r673hlpvu6uvZ2hLiNwVrk9qa/BZkbVJbE/jw8v/0dN03CmVuZHN0cmVhbQplbmRvYmoKMjAgMCBvYmoKMzE5NgplbmRvYmoKMiAwIG9iago8PCAvVHlwZSAvUGFnZXMgL0tpZHMgWyAxMSAwIFIgXSAvQ291bnQgMSA+PgplbmRvYmoKMjEgMCBvYmoKPDwgL0NyZWF0b3IgKE1hdHBsb3RsaWIgdjMuMTAuMCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZykKL1Byb2R1Y2VyIChNYXRwbG90bGliIHBkZiBiYWNrZW5kIHYzLjEwLjApCi9DcmVhdGlvbkRhdGUgKEQ6MjAyNTAzMjYwODQ1MzQrMDInMDAnKSA+PgplbmRvYmoKeHJlZgowIDIyCjAwMDAwMDAwMDAgNjU1MzUgZiAKMDAwMDAwMDAxNiAwMDAwMCBuIAowMDAwMDEzMjQ1IDAwMDAwIG4gCjAwMDAwMDA2MzkgMDAwMDAgbiAKMDAwMDAwMDY2MCAwMDAwMCBuIAowMDAwMDAwNzIwIDAwMDAwIG4gCjAwMDAwMDA3NDEgMDAwMDAgbiAKMDAwMDAwMDc2MiAwMDAwMCBuIAowMDAwMDAwMDY1IDAwMDAwIG4gCjAwMDAwMDAzMzYgMDAwMDAgbiAKMDAwMDAwMDYxOSAwMDAwMCBuIAowMDAwMDAwMjA4IDAwMDAwIG4gCjAwMDAwMDA1OTkgMDAwMDAgbiAKMDAwMDAwMDgyNyAwMDAwMCBuIAowMDAwMDA0MjgxIDAwMDAwIG4gCjAwMDAwMDc2NTkgMDAwMDAgbiAKMDAwMDAwOTgwMCAwMDAwMCBuIAowMDAwMDA0MjYwIDAwMDAwIG4gCjAwMDAwMDc2MzggMDAwMDAgbiAKMDAwMDAwOTc3OSAwMDAwMCBuIAowMDAwMDEzMjI0IDAwMDAwIG4gCjAwMDAwMTMzMDUgMDAwMDAgbiAKdHJhaWxlcgo8PCAvU2l6ZSAyMiAvUm9vdCAxIDAgUiAvSW5mbyAyMSAwIFIgPj4Kc3RhcnR4cmVmCjEzNDY0CiUlRU9GCg==","content_type":"application/pdf"},"image/png":{"content_type":"image/png","hash":"ec4c34614e80613511d25a45bc611d6b","path":"/ec4c34614e80613511d25a45bc611d6b.png"},"text/plain":{"content":"<Figure size 4200x600 with 4 Axes>","content_type":"text/plain"}}},"children":[],"key":"NBUWCMHIf5"}],"key":"WW8Rw1tOFj"}],"key":"YMzK3UPoVs"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Self-attention","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"etxO2jyuZf"}],"identifier":"self-attention","label":"Self-attention","html_id":"self-attention","implicit":true,"key":"BE7onwTgtX"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"First, we need to implement a (scaled) dot-product","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"S7Ru4k1j34"}],"key":"jFAaQ4GotW"},{"type":"image","style":{"width":"20%","marginLeft":"auto","marginRight":"auto"},"url":"/991cc4d30703b14ac848a6de92fc24b9.svg","alt":"ml","key":"iVee3qE03r","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/scaled_dot_product_attn.svg"}],"key":"X0JxE90WOa"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Self-attention","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HsleBQczUG"}],"identifier":"self-attention","label":"Self-attention","html_id":"self-attention-1","implicit":true,"key":"iW8KsrznnJ"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"First, we need to implement a (scaled) dot-product","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"fyfB8l0wyr"}],"key":"sd0MDg5hrB"},{"type":"code","lang":"python","value":"def scaled_dot_product(q, k, v):\n    attn_logits = torch.matmul(q, k.transpose(-2, -1)) # dot prod\n    attn_logits = attn_logits / math.sqrt(q.size()[-1])# scaling\n    attention = F.softmax(attn_logits, dim=-1)         # softmax\n    values = torch.matmul(attention, v)                # dot prod\n    return values, attention","position":{"start":{"line":3,"column":1},"end":{"line":10,"column":1}},"key":"ip0RUDmMlf"}],"key":"bWyNn2iE7W"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def scaled_dot_product(q, k, v, mask=None):\n    d_k = q.size()[-1]\n    attn_logits = torch.matmul(q, k.transpose(-2, -1))\n    attn_logits = attn_logits / math.sqrt(d_k)\n    if mask is not None:\n        attn_logits = attn_logits.masked_fill(mask == 0, -9e15)\n    attention = F.softmax(attn_logits, dim=-1)\n    values = torch.matmul(attention, v)\n    return values, attention","key":"sbKMohVImZ"},{"type":"outputs","id":"eDS3O02S_yJtlXfQmPV60","children":[],"key":"NwhKJrIIbX"}],"key":"JAjDL04C1c"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Multi-head attention (simplified)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZCxVhdAj0e"}],"identifier":"multi-head-attention-simplified","label":"Multi-head attention (simplified)","html_id":"multi-head-attention-simplified","implicit":true,"key":"o8uY0sSO1y"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Project input to lower-dimensional embeddings","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Td0rilAxB1"}],"key":"qMkK6ci4jx"}],"key":"XG7U96ZvvP"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Stack them so we can feed them through self-attention at once","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"puSEAKajRV"}],"key":"G0WiLpzTCw"}],"key":"nqoTlvwYZ3"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Unstack and project back to original dimensions","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"uvdU401rBO"}],"key":"kg4CAA95Lh"}],"key":"a2c1kub08T"}],"key":"JoKCA4OHcF"},{"type":"code","lang":"python","value":"    qkv = nn.Linear(input_dim, 3*embed_dim)(x) # project to embed_dim\n    qkv = qkv.reshape(batch_size, seq_length, num_heads, 3*head_dim)\n    q, k, v = qkv.chunk(3, dim=-1) \n\n    values, attention = scaled_dot_product(q, k, v, mask=mask) # self-att\n    values = values.reshape(batch_size, seq_length, embed_dim)\n    out = nn.Linear(embed_dim, input_dim) # project back","position":{"start":{"line":6,"column":1},"end":{"line":14,"column":1}},"key":"jWZyMAypEr"}],"key":"lHmvuNUsUG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def expand_mask(mask):\n    assert mask.ndim >= 2, \"Mask must be at least 2-dimensional with seq_length x seq_length\"\n    if mask.ndim == 3:\n        mask = mask.unsqueeze(1)\n    while mask.ndim < 4:\n        mask = mask.unsqueeze(0)\n    return mask\n\nclass MultiheadAttention(nn.Module):\n    \n    def __init__(self, input_dim, embed_dim, num_heads):\n        super().__init__()\n        assert embed_dim % num_heads == 0, \"Embedding dimension must be 0 modulo number of heads.\"\n        \n        self.embed_dim = embed_dim\n        self.num_heads = num_heads\n        self.head_dim = embed_dim // num_heads\n        \n        # Stack all weight matrices 1...h together for efficiency\n        # Note that in many implementations you see \"bias=False\" which is optional\n        self.qkv_proj = nn.Linear(input_dim, 3*embed_dim)\n        self.o_proj = nn.Linear(embed_dim, input_dim)\n        \n        self._reset_parameters()\n\n    def _reset_parameters(self):\n        # Original Transformer initialization, see PyTorch documentation\n        nn.init.xavier_uniform_(self.qkv_proj.weight)\n        self.qkv_proj.bias.data.fill_(0)\n        nn.init.xavier_uniform_(self.o_proj.weight)\n        self.o_proj.bias.data.fill_(0)\n\n    def forward(self, x, mask=None, return_attention=False):\n        batch_size, seq_length, _ = x.size()\n        if mask is not None:\n            mask = expand_mask(mask)\n        qkv = self.qkv_proj(x)\n        \n        # Separate Q, K, V from linear output\n        qkv = qkv.reshape(batch_size, seq_length, self.num_heads, 3*self.head_dim)\n        qkv = qkv.permute(0, 2, 1, 3) # [Batch, Head, SeqLen, Dims]\n        q, k, v = qkv.chunk(3, dim=-1)\n        \n        # Determine value outputs\n        values, attention = scaled_dot_product(q, k, v, mask=mask)\n        values = values.permute(0, 2, 1, 3) # [Batch, SeqLen, Head, Dims]\n        values = values.reshape(batch_size, seq_length, self.embed_dim)\n        o = self.o_proj(values)\n        \n        if return_attention:\n            return o, attention\n        else:\n            return o","key":"sTflRGliIi"},{"type":"outputs","id":"Fu13H7JO6A8J5GNSP381Q","children":[],"key":"tc15cMmN34"}],"key":"g1LUAMpCfE"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Attention block","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WG5OGw1NhO"}],"identifier":"attention-block","label":"Attention block","html_id":"attention-block","implicit":true,"key":"HaUkDk9Ggn"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"The attention block is quite straightforward","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"WP5eMnNvMp"}],"key":"j7Swdx4MN5"},{"type":"image","style":{"width":"35%","marginLeft":"auto","marginRight":"auto"},"url":"/bb289b160b5cc35d3c10adc58468bc09.png","alt":"ml","key":"m7gcblYJ9w","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/10_attention_layer.png","urlOptimized":"/bb289b160b5cc35d3c10adc58468bc09.webp"}],"key":"ci6ZwrWoMS"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Attention block","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mBdGfcGsMB"}],"identifier":"attention-block","label":"Attention block","html_id":"attention-block-1","implicit":true,"key":"qqPcLd75NY"},{"type":"code","lang":"python","value":"def __init__(self, embed_dim, hidden_dim, num_heads, dropout=0.0):\n    self.layer_norm_1 = nn.LayerNorm(embed_dim)\n    self.attn = nn.MultiheadAttention(embed_dim, num_heads)\n    self.layer_norm_2 = nn.LayerNorm(embed_dim)\n    self.linear = nn.Sequential( # Feed-forward layer\n        nn.Linear(embed_dim, hidden_dim),\n        nn.GELU(), nn.Dropout(dropout),\n        nn.Linear(hidden_dim, embed_dim),\n        nn.Dropout(dropout)\n    )","position":{"start":{"line":2,"column":1},"end":{"line":13,"column":1}},"key":"NRk78SPExg"},{"type":"code","lang":"python","value":"def forward(self, x):\n    inp_x = self.layer_norm_1(x)\n    x = x + self.attn(inp_x, inp_x, inp_x)[0] # self-att + res\n    x = x + self.linear(self.layer_norm_2(x)) # feed-fw + res\n    return x","position":{"start":{"line":14,"column":1},"end":{"line":20,"column":1}},"key":"P6Sx42clnw"}],"key":"p2BJVgV0Av"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"class AttentionBlock(nn.Module):\n    \n    def __init__(self, embed_dim, hidden_dim, num_heads, dropout=0.0):\n        \"\"\"\n        Inputs:\n            embed_dim - Dimensionality of input and attention feature vectors\n            hidden_dim - Dimensionality of hidden layer in feed-forward network \n                         (usually 2-4x larger than embed_dim)\n            num_heads - Number of heads to use in the Multi-Head Attention block\n            dropout - Amount of dropout to apply in the feed-forward network\n        \"\"\"\n        super().__init__()\n        \n        self.layer_norm_1 = nn.LayerNorm(embed_dim)\n        self.attn = nn.MultiheadAttention(embed_dim, num_heads, \n                                          dropout=dropout)\n        self.layer_norm_2 = nn.LayerNorm(embed_dim)\n        self.linear = nn.Sequential(\n            nn.Linear(embed_dim, hidden_dim),\n            nn.GELU(),\n            nn.Dropout(dropout),\n            nn.Linear(hidden_dim, embed_dim),\n            nn.Dropout(dropout)\n        )\n        \n        \n    def forward(self, x):\n        inp_x = self.layer_norm_1(x)\n        x = x + self.attn(inp_x, inp_x, inp_x)[0]\n        x = x + self.linear(self.layer_norm_2(x))\n        return x","key":"NAA9EBA0fG"},{"type":"outputs","id":"v18rZlyI2781FM95Fmusd","children":[],"key":"Brmpr7gQyZ"}],"key":"zHyDwHUTal"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Vision transformer","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Pd0cfoyAHG"}],"identifier":"vision-transformer","label":"Vision transformer","html_id":"vision-transformer","implicit":true,"key":"ppt6bVo2nE"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Final steps:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ZcpHL7oig6"}],"key":"sfDsOGphYh"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Linear projection (embedding) to map patches to vector","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JGom13sNJl"}],"key":"gwyQ7WZsrl"}],"key":"N8SM5EvvOo"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Add classification token to input","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"DL86gZkIXr"}],"key":"YRZvbAXIBl"}],"key":"DDVBXyDTRa"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"2D positional encoding","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"p3deD8b9X1"}],"key":"twe9CXLHzF"}],"key":"ivRFxMunJ4"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Small MLP head to map CLS token to prediction","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"nDYEDnfUP3"}],"key":"wirsnRncWa"}],"key":"plno1qU4X5"}],"key":"d37ILwfq7M"},{"type":"image","style":{"width":"50%","marginLeft":"auto","marginRight":"auto"},"url":"/ea4dd7b2eecd6e399b57b56e6aff46e1.png","alt":"ml","key":"oPCLCArZ0t","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/10_vit.png","urlOptimized":"/ea4dd7b2eecd6e399b57b56e6aff46e1.webp"}],"key":"OBJtW7DWQR"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Positional encoding","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vlHpTLv5OF"}],"identifier":"positional-encoding","label":"Positional encoding","html_id":"positional-encoding-1","implicit":true,"key":"TkSsp5ruYW"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We implement this pattern and run in across a 2D grid:\n","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"JhHVaFzbOH"}],"key":"HqbjzsNm1O"},{"type":"math","value":"PE_{(pos,i)} = \\begin{cases}\n  \\sin\\left(\\frac{pos}{10000^{i/d_{\\text{model}}}}\\right) & \\text{if}\\hspace{3mm} i \\text{ mod } 2=0\\\\\n  \\cos\\left(\\frac{pos}{10000^{(i-1)/d_{\\text{model}}}}\\right) & \\text{otherwise}\\\\\n\\end{cases}","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>P</mi><msub><mi>E</mi><mrow><mo stretchy=\"false\">(</mo><mi>p</mi><mi>o</mi><mi>s</mi><mo separator=\"true\">,</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></msub><mo>=</mo><mrow><mo fence=\"true\">{</mo><mtable rowspacing=\"0.36em\" columnalign=\"left left\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>sin</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mfrac><mrow><mi>p</mi><mi>o</mi><mi>s</mi></mrow><mrow><mn>1000</mn><msup><mn>0</mn><mrow><mi>i</mi><mi mathvariant=\"normal\">/</mi><msub><mi>d</mi><mtext>model</mtext></msub></mrow></msup></mrow></mfrac><mo fence=\"true\">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mtext>if</mtext><mspace width=\"0.8536em\"/><mi>i</mi><mtext> mod </mtext><mn>2</mn><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>cos</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mfrac><mrow><mi>p</mi><mi>o</mi><mi>s</mi></mrow><mrow><mn>1000</mn><msup><mn>0</mn><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">/</mi><msub><mi>d</mi><mtext>model</mtext></msub></mrow></msup></mrow></mfrac><mo fence=\"true\">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mtext>otherwise</mtext></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">PE_{(pos,i)} = \\begin{cases}\n  \\sin\\left(\\frac{pos}{10000^{i/d_{\\text{model}}}}\\right) &amp; \\text{if}\\hspace{3mm} i \\text{ mod } 2=0\\\\\n  \\cos\\left(\\frac{pos}{10000^{(i-1)/d_{\\text{model}}}}\\right) &amp; \\text{otherwise}\\\\\n\\end{cases}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0385em;vertical-align:-0.3552em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.5198em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">p</span><span class=\"mord mathnormal mtight\">os</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3552em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.6em;vertical-align:-1.55em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-2.5em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎩</span></span></span><span style=\"top:-2.492em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span style=\"height:0.016em;width:0.8889em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.8889em' height='0.016em' style='width:0.8889em' viewBox='0 0 888.89 16' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V16 H384z M384 0 H504 V16 H384z'/></svg></span></span><span style=\"top:-3.15em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎨</span></span></span><span style=\"top:-4.292em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span style=\"height:0.016em;width:0.8889em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.8889em' height='0.016em' style='width:0.8889em' viewBox='0 0 888.89 16' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V16 H384z M384 0 H504 V16 H384z'/></svg></span></span><span style=\"top:-4.3em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎧</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.05em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"mord\"><span class=\"mop\">sin</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7475em;\"><span style=\"top:-2.5648em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1000</span><span class=\"mord mtight\"><span class=\"mord mtight\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8932em;\"><span style=\"top:-2.8932em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5357em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mtight\">/</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3448em;margin-left:0em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.6944em;\"></span><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">model</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3496em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.4461em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span><span class=\"mord mathnormal mtight\">os</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4352em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">)</span></span></span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"mord\"><span class=\"mop\">cos</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7475em;\"><span style=\"top:-2.5648em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1000</span><span class=\"mord mtight\"><span class=\"mord mtight\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8932em;\"><span style=\"top:-2.8932em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5357em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">)</span><span class=\"mord mtight\">/</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3448em;margin-left:0em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.6944em;\"></span><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">model</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3496em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.4461em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span><span class=\"mord mathnormal mtight\">os</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4352em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">)</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:1em;\"></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.05em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">if</span></span><span class=\"mspace\" style=\"margin-right:0.8536em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mord text\"><span class=\"mord\"> mod </span></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">0</span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">otherwise</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.55em;\"><span></span></span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"4","key":"nZXfYKtWG1"}],"key":"EdFyoOqkdA"}],"key":"xlvqNwvLiM"}],"key":"ljH9X4RMlB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import math\nclass PositionalEncoding(nn.Module):\n\n    def __init__(self, d_model, max_len=5000):\n        \"\"\"\n        Inputs\n            d_model - Hidden dimensionality of the input.\n            max_len - Maximum length of a sequence to expect.\n        \"\"\"\n        super().__init__()\n\n        # Create matrix of [SeqLen, HiddenDim] representing the positional encoding for max_len inputs\n        pe = torch.zeros(max_len, d_model)\n        position = torch.arange(0, max_len, dtype=torch.float).unsqueeze(1)\n        div_term = torch.exp(torch.arange(0, d_model, 2).float() * (-math.log(10000.0) / d_model))\n        pe[:, 0::2] = torch.sin(position * div_term)\n        pe[:, 1::2] = torch.cos(position * div_term)\n        pe = pe.unsqueeze(0)\n        \n        # register_buffer => Tensor which is not a parameter, but should be part of the modules state.\n        # Used for tensors that need to be on the same device as the module.\n        # persistent=False tells PyTorch to not add the buffer to the state dict (e.g. when we save the model) \n        self.register_buffer('pe', pe, persistent=False)\n\n    def forward(self, x):\n        x = x + self.pe[:, :x.size(1)]\n        return x\n    \nencod_block = PositionalEncoding(d_model=48, max_len=96)\npe = encod_block.pe.squeeze().T.cpu().numpy()\n\nfig, ax = plt.subplots(nrows=1, ncols=1, figsize=(8,3))\npos = ax.imshow(pe, cmap=\"RdGy\", extent=(1,pe.shape[1]+1,pe.shape[0]+1,1))\nfig.colorbar(pos, ax=ax)\nax.set_xlabel(\"Position in sequence\")\nax.set_ylabel(\"Hidden dimension\")\nax.set_title(\"Positional encoding over hidden dimensions\")\nax.set_xticks([1]+[i*10 for i in range(1,1+pe.shape[1]//10)])\nax.set_yticks([1]+[i*10 for i in range(1,1+pe.shape[0]//10)])\nplt.show()","key":"LsfVG8l8Xq"},{"type":"outputs","id":"UQyCtvj9zXvjJyHamKAJa","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"application/pdf":{"content_type":"application/pdf","hash":"36d21ac660e03b6bab7541ed8f4b0c69","path":"/36d21ac660e03b6bab7541ed8f4b0c69.json"},"image/png":{"content_type":"image/png","hash":"7e82a0ad98118fe56d8c42496fa98c81","path":"/7e82a0ad98118fe56d8c42496fa98c81.png"},"text/plain":{"content":"<Figure size 2400x900 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"ZaY9b0aN0Z"}],"key":"QycS0JtZ2c"}],"key":"roEc39zIRG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"class VisionTransformer(nn.Module):\n    \n    def __init__(self, embed_dim, hidden_dim, num_channels, num_heads, num_layers, num_classes, patch_size, num_patches, dropout=0.0):\n        \"\"\"\n        Inputs:\n            embed_dim - Dimensionality of the input feature vectors to the Transformer\n            hidden_dim - Dimensionality of the hidden layer in the feed-forward networks\n                         within the Transformer\n            num_channels - Number of channels of the input (3 for RGB)\n            num_heads - Number of heads to use in the Multi-Head Attention block\n            num_layers - Number of layers to use in the Transformer\n            num_classes - Number of classes to predict\n            patch_size - Number of pixels that the patches have per dimension\n            num_patches - Maximum number of patches an image can have\n            dropout - Amount of dropout to apply in the feed-forward network and \n                      on the input encoding\n        \"\"\"\n        super().__init__()\n        \n        self.patch_size = patch_size\n        \n        # Layers/Networks\n        self.input_layer = nn.Linear(num_channels*(patch_size**2), embed_dim)\n        self.transformer = nn.Sequential(*[AttentionBlock(embed_dim, hidden_dim, num_heads, dropout=dropout) for _ in range(num_layers)])\n        self.mlp_head = nn.Sequential(\n            nn.LayerNorm(embed_dim),\n            nn.Linear(embed_dim, num_classes)\n        )\n        self.dropout = nn.Dropout(dropout)\n        \n        # Parameters/Embeddings\n        self.cls_token = nn.Parameter(torch.randn(1,1,embed_dim))\n        self.pos_embedding = nn.Parameter(torch.randn(1,1+num_patches,embed_dim))\n    \n    \n    def forward(self, x):\n        # Preprocess input\n        x = img_to_patch(x, self.patch_size)\n        B, T, _ = x.shape\n        x = self.input_layer(x)\n        \n        # Add CLS token and positional encoding\n        cls_token = self.cls_token.repeat(B, 1, 1)\n        x = torch.cat([cls_token, x], dim=1)\n        x = x + self.pos_embedding[:,:T+1]\n        \n        # Apply Transforrmer\n        x = self.dropout(x)\n        x = x.transpose(0, 1)\n        x = self.transformer(x)\n        \n        # Perform classification prediction\n        cls = x[0]\n        out = self.mlp_head(cls)\n        return out","key":"UydE94YdkE"},{"type":"outputs","id":"tApO4tBM1_poRydamCfpN","children":[],"key":"lpkFpXHJYd"}],"key":"wgc97BjMb2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"class ViT(pl.LightningModule):\n    \n    def __init__(self, model_kwargs, lr):\n        super().__init__()\n        self.save_hyperparameters()\n        self.model = VisionTransformer(**model_kwargs)\n        self.example_input_array = next(iter(train_loader))[0]\n        \n    def forward(self, x):\n        return self.model(x)\n    \n    def configure_optimizers(self):\n        optimizer = optim.AdamW(self.parameters(), lr=self.hparams.lr)\n        lr_scheduler = optim.lr_scheduler.MultiStepLR(optimizer, milestones=[100,150], gamma=0.1)\n        return [optimizer], [lr_scheduler]   \n    \n    def _calculate_loss(self, batch, mode=\"train\"):\n        imgs, labels = batch\n        preds = self.model(imgs)\n        loss = F.cross_entropy(preds, labels)\n        acc = (preds.argmax(dim=-1) == labels).float().mean()\n        \n        self.log(f'{mode}_loss', loss)\n        self.log(f'{mode}_acc', acc)\n        return loss\n\n    def training_step(self, batch, batch_idx):\n        loss = self._calculate_loss(batch, mode=\"train\")\n        return loss\n\n    def validation_step(self, batch, batch_idx):\n        self._calculate_loss(batch, mode=\"val\")\n\n    def test_step(self, batch, batch_idx):\n        self._calculate_loss(batch, mode=\"test\")","key":"zDHFzBZx45"},{"type":"outputs","id":"yWUsE6kXribeEgGu4_dov","children":[],"key":"S7g9vNoltK"}],"key":"CfBa1gkpQz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def train_model(**kwargs):\n    trainer = pl.Trainer(default_root_dir=os.path.join(CHECKPOINT_PATH, \"ViT\"), \n                         accelerator=\"gpu\" if str(device).startswith(\"cuda\") else \"cpu\",\n                         devices=1,\n                         max_epochs=180,\n                         callbacks=[ModelCheckpoint(save_weights_only=True, mode=\"max\", monitor=\"val_acc\"),\n                                    LearningRateMonitor(\"epoch\")])\n    trainer.logger._log_graph = True         # If True, we plot the computation graph in tensorboard\n    trainer.logger._default_hp_metric = None # Optional logging argument that we don't need\n\n    # Check whether pretrained model exists. If yes, load it and skip training\n    pretrained_filename = os.path.join(CHECKPOINT_PATH, \"ViT.ckpt\")\n    if os.path.isfile(pretrained_filename):\n        print(f\"Found pretrained model at {pretrained_filename}, loading...\")\n        model = ViT.load_from_checkpoint(pretrained_filename) # Automatically loads the model with the saved hyperparameters\n    else:\n        pl.seed_everything(42) # To be reproducable\n        model = ViT(**kwargs)\n        trainer.fit(model, train_loader, val_loader)\n        model = ViT.load_from_checkpoint(trainer.checkpoint_callback.best_model_path) # Load best checkpoint after training\n\n    # Test best model on validation and test set\n    val_result = trainer.test(model, val_loader, verbose=False)\n    test_result = trainer.test(model, test_loader, verbose=False)\n    result = {\"test\": test_result[0][\"test_acc\"], \"val\": val_result[0][\"test_acc\"]}\n\n    return model, result","key":"Paopm8fJPv"},{"type":"outputs","id":"c12EFzR4wcCB3nj1EtfSs","children":[],"key":"WdVGTiGsuz"}],"key":"FHbgd99k3c"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Results","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NGs0b1Mt7h"}],"identifier":"results","label":"Results","html_id":"results","implicit":true,"key":"UcnsMt719C"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"ResNet outperforms ViT","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ScVUr8PTnR"}],"key":"NgcJzgpZHU"}],"key":"dpOE4zjwuM"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Inductive biases of CNNs win out if you have limited data/compute","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SnSznq1aCl"}],"key":"fJkMmch1ny"}],"key":"bAcsjiJJFs"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Transformers have very little inductive bias","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"PIzcny1Mkd"}],"key":"lHzY3JQA90"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"More flexible, but also more data hungry","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"IC6MyloMnF"}],"key":"TUxzjPe9i3"}],"key":"G8erZhAs2m"}],"key":"lKnFmTMrIb"}],"key":"m88elrgn2j"}],"key":"A5nyu9pnzH"},{"type":"image","style":{"width":"50%","marginLeft":"auto","marginRight":"auto"},"url":"/54134dd39fd3086268426829c393aa24.png","alt":"ml","key":"T5oVbCRREx","urlSource":"https://raw.githubusercontent.com/ML-course/master/master/notebooks/images/10_resnetvit.png","urlOptimized":"/54134dd39fd3086268426829c393aa24.webp"}],"key":"rVIUcknmcq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model, results = train_model(model_kwargs={\n                                'embed_dim': 256,\n                                'hidden_dim': 512,\n                                'num_heads': 8,\n                                'num_layers': 6,\n                                'patch_size': 4,\n                                'num_channels': 3,\n                                'num_patches': 64,\n                                'num_classes': 10,\n                                'dropout': 0.2\n                            },\n                            lr=3e-4)\nprint(\"ViT results\", results)","key":"ZyGDFjjAll"},{"type":"outputs","id":"W1L9JUU3bB2FGdbOSigEB","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"GPU available: True (mps), used: False\nTPU available: False, using: 0 TPU cores\nHPU available: False, using: 0 HPUs\nLightning automatically upgraded your loaded checkpoint from v1.6.4 to v2.5.0.post0. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../data/checkpoints/ViT.ckpt`\n"},"children":[],"key":"dWBR5HbBzZ"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Found pretrained model at ../data/checkpoints/ViT.ckpt, loading...\n"},"children":[],"key":"LpZrhKpgUQ"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"application/vnd.jupyter.widget-view+json":{"content":"{\"model_id\":\"525f660f843c4005a63ec48b546becef\",\"version_major\":2,\"version_minor\":0}","content_type":"application/vnd.jupyter.widget-view+json"},"text/plain":{"content":"Testing: |                                                                                                    …","content_type":"text/plain"}}},"children":[],"key":"FlVmJdZyUW"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"application/vnd.jupyter.widget-view+json":{"content":"{\"model_id\":\"df0a34abddd446e58d3c461f0463e395\",\"version_major\":2,\"version_minor\":0}","content_type":"application/vnd.jupyter.widget-view+json"},"text/plain":{"content":"Testing: |                                                                                                    …","content_type":"text/plain"}}},"children":[],"key":"ghH7WqrgvT"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"ViT results {'test': 0.7713000178337097, 'val': 0.7781999707221985}\n"},"children":[],"key":"UnctXUt2EA"}],"key":"r1SD3Lmjw0"}],"key":"gW5wR24i3V"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"n5choqTDQ6"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"key":"pxhqKJ7T7a"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Tokenization","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"uxdbjiMnBk"}],"key":"f7XbXts6tC"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Find a good way to split data into tokens","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"iF88wYYiSY"}],"key":"axbjHA2gje"}],"key":"WBTYBxW5fw"}],"key":"gyFMXTQNkM"}],"key":"qvhrWosdvi"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Word/Image embeddings (for initial embeddings)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ZHRxHT4a59"}],"key":"EksaAxZJdu"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"For text: Word2Vec, FastText, GloVe","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"YVDOmZjTUv"}],"key":"wpI9goPZ9a"}],"key":"hn1PWmPNO4"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"For images: MLP, CNN,...","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ajPFQR6LIH"}],"key":"BWeJIZnUcR"}],"key":"bNUtbaAhcJ"}],"key":"hCOj2lsGpx"}],"key":"Kifn8wr1ob"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Sequence-to-sequence models","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Qp7wPwR1CM"}],"key":"oIhQ4DQfAN"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"1D convolutional nets (fast, limited memory)","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"m9JObFnQh9"}],"key":"XcAC1yDIyV"}],"key":"DQP3tIr5YZ"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"RNNs (slow, also quite limited memory)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"aKUJLkNoR4"}],"key":"xv24UOtTPT"}],"key":"yugiiJWFFV"}],"key":"IxMvgUMUSE"}],"key":"KuB93vBxNR"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Transformers","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"nkpKT0QgBN"}],"key":"C1Aj1V8p5v"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Self-attention (allows very large memory)","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"TUUo0DE1bs"}],"key":"wUmIWU9vpM"}],"key":"SV966j6IW3"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Positional encoding","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"FmaT0o1ecA"}],"key":"SlVjO2AJJd"}],"key":"O9l82JVBiR"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Autoregressive models","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"KbBQaICmrZ"}],"key":"jeMNscEbWA"}],"key":"yhMYcG2FnJ"}],"key":"fkTBFR5QqI"}],"key":"v0NzU6RijW"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Vision transformers","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"jGlpcQpUny"}],"key":"OEbYWZnmTc"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Useful if you have lots of data (and compute)","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"q3hdhD8ugd"}],"key":"lx0KX5n279"}],"key":"C4NNdgG3KA"}],"key":"z9xX41cXYe"}],"key":"KW9CAZk9Sj"}],"key":"yk5oSgpJdH"}],"key":"Sig8GGvmdR"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Acknowledgement","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QKhQGT8PrL"}],"key":"c5oCXdvD4J"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Several figures came from the excellent ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"whQTkWoVwn"},{"type":"link","url":"https://dlvu.github.io/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"VU Deep Learning course","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LuRulvtSMu"}],"urlSource":"https://dlvu.github.io/","key":"oTrEdlYaOA"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fbIoikRBpd"}],"key":"loDVGOrpCa"}],"key":"FhGcFwZkOF"}],"key":"jPozHo7LmT"},"references":{"cite":{"order":[],"data":{}}}}